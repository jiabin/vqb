(function(d){var j=d.JCSDL={};j.version="2.3.2";j.Loader={compnts:[],loaded:[],isLoaded:!1,addComponent:function(a){"function"===typeof a&&j.Loader.compnts.push(a)},addLoaded:function(a){"function"===typeof a&&j.Loader.loaded.push(a)},load:function(){var a=d.jQuery;a.each(j.Loader.compnts,function(){this.apply(j,[a])});a.each(j.Loader.loaded,function(){this.apply(j,[])});j.Loader.isLoaded=!0},timeout:function(a){setTimeout(function(){d.jQuery?(a&&d.jQuery.noConflict(),j.Loader.load()):j.Loader.timeout()},
100)}};j.onLoad=function(a){if("function"!==typeof a)return!1;j.Loader.isLoaded?a.apply(j,[]):j.Loader.addLoaded(a)}})(window);("undefined"==typeof Crypto||!Crypto.util)&&function(){var d=window.Crypto={},j=d.util={rotl:function(b,a){return b<<a|b>>>32-a},rotr:function(b,a){return b<<32-a|b>>>a},endian:function(b){if(b.constructor==Number)return j.rotl(b,8)&16711935|j.rotl(b,24)&4278255360;for(var a=0;a<b.length;a++)b[a]=j.endian(b[a]);return b},randomBytes:function(b){for(var a=[];0<b;b--)a.push(Math.floor(256*Math.random()));return a},bytesToWords:function(b){for(var a=[],f=0,e=0;f<b.length;f++,e+=8)a[e>>>5]|=(b[f]&255)<<
24-e%32;return a},wordsToBytes:function(b){for(var a=[],f=0;f<32*b.length;f+=8)a.push(b[f>>>5]>>>24-f%32&255);return a},bytesToHex:function(b){for(var a=[],f=0;f<b.length;f++)a.push((b[f]>>>4).toString(16)),a.push((b[f]&15).toString(16));return a.join("")},hexToBytes:function(a){for(var c=[],f=0;f<a.length;f+=2)c.push(parseInt(a.substr(f,2),16));return c},bytesToBase64:function(b){if("function"==typeof btoa)return btoa(a.bytesToString(b));for(var c=[],f=0;f<b.length;f+=3)for(var e=b[f]<<16|b[f+1]<<
8|b[f+2],g=0;4>g;g++)8*f+6*g<=8*b.length?c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-g)&63)):c.push("=");return c.join("")},base64ToBytes:function(b){if("function"==typeof atob)return a.stringToBytes(atob(b));b=b.replace(/[^A-Z0-9+\/]/ig,"");for(var c=[],f=0,e=0;f<b.length;e=++f%4)0!=e&&c.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b.charAt(f-1))&Math.pow(2,-2*e+8)-1)<<2*e|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(b.charAt(f))>>>
6-2*e);return c}},d=d.charenc={};d.UTF8={stringToBytes:function(b){return a.stringToBytes(unescape(encodeURIComponent(b)))},bytesToString:function(b){return decodeURIComponent(escape(a.bytesToString(b)))}};var a=d.Binary={stringToBytes:function(a){for(var c=[],f=0;f<a.length;f++)c.push(a.charCodeAt(f)&255);return c},bytesToString:function(a){for(var c=[],f=0;f<a.length;f++)c.push(String.fromCharCode(a[f]));return c.join("")}}}();
(function(){var d=Crypto,j=d.util,a=d.charenc,b=a.UTF8,c=a.Binary,f=d.MD5=function(a,b){var d=j.wordsToBytes(f._md5(a));return b&&b.asBytes?d:b&&b.asString?c.bytesToString(d):j.bytesToHex(d)};f._md5=function(a){a.constructor==String&&(a=b.stringToBytes(a));var g=j.bytesToWords(a),c=8*a.length;a=1732584193;for(var d=-271733879,k=-1732584194,p=271733878,n=0;n<g.length;n++)g[n]=(g[n]<<8|g[n]>>>24)&16711935|(g[n]<<24|g[n]>>>8)&4278255360;g[c>>>5]|=128<<c%32;g[(c+64>>>9<<4)+14]=c;for(var c=f._ff,q=f._gg,
l=f._hh,u=f._ii,n=0;n<g.length;n+=16){var t=a,v=d,r=k,w=p;a=c(a,d,k,p,g[n+0],7,-680876936);p=c(p,a,d,k,g[n+1],12,-389564586);k=c(k,p,a,d,g[n+2],17,606105819);d=c(d,k,p,a,g[n+3],22,-1044525330);a=c(a,d,k,p,g[n+4],7,-176418897);p=c(p,a,d,k,g[n+5],12,1200080426);k=c(k,p,a,d,g[n+6],17,-1473231341);d=c(d,k,p,a,g[n+7],22,-45705983);a=c(a,d,k,p,g[n+8],7,1770035416);p=c(p,a,d,k,g[n+9],12,-1958414417);k=c(k,p,a,d,g[n+10],17,-42063);d=c(d,k,p,a,g[n+11],22,-1990404162);a=c(a,d,k,p,g[n+12],7,1804603682);p=c(p,
a,d,k,g[n+13],12,-40341101);k=c(k,p,a,d,g[n+14],17,-1502002290);d=c(d,k,p,a,g[n+15],22,1236535329);a=q(a,d,k,p,g[n+1],5,-165796510);p=q(p,a,d,k,g[n+6],9,-1069501632);k=q(k,p,a,d,g[n+11],14,643717713);d=q(d,k,p,a,g[n+0],20,-373897302);a=q(a,d,k,p,g[n+5],5,-701558691);p=q(p,a,d,k,g[n+10],9,38016083);k=q(k,p,a,d,g[n+15],14,-660478335);d=q(d,k,p,a,g[n+4],20,-405537848);a=q(a,d,k,p,g[n+9],5,568446438);p=q(p,a,d,k,g[n+14],9,-1019803690);k=q(k,p,a,d,g[n+3],14,-187363961);d=q(d,k,p,a,g[n+8],20,1163531501);
a=q(a,d,k,p,g[n+13],5,-1444681467);p=q(p,a,d,k,g[n+2],9,-51403784);k=q(k,p,a,d,g[n+7],14,1735328473);d=q(d,k,p,a,g[n+12],20,-1926607734);a=l(a,d,k,p,g[n+5],4,-378558);p=l(p,a,d,k,g[n+8],11,-2022574463);k=l(k,p,a,d,g[n+11],16,1839030562);d=l(d,k,p,a,g[n+14],23,-35309556);a=l(a,d,k,p,g[n+1],4,-1530992060);p=l(p,a,d,k,g[n+4],11,1272893353);k=l(k,p,a,d,g[n+7],16,-155497632);d=l(d,k,p,a,g[n+10],23,-1094730640);a=l(a,d,k,p,g[n+13],4,681279174);p=l(p,a,d,k,g[n+0],11,-358537222);k=l(k,p,a,d,g[n+3],16,-722521979);
d=l(d,k,p,a,g[n+6],23,76029189);a=l(a,d,k,p,g[n+9],4,-640364487);p=l(p,a,d,k,g[n+12],11,-421815835);k=l(k,p,a,d,g[n+15],16,530742520);d=l(d,k,p,a,g[n+2],23,-995338651);a=u(a,d,k,p,g[n+0],6,-198630844);p=u(p,a,d,k,g[n+7],10,1126891415);k=u(k,p,a,d,g[n+14],15,-1416354905);d=u(d,k,p,a,g[n+5],21,-57434055);a=u(a,d,k,p,g[n+12],6,1700485571);p=u(p,a,d,k,g[n+3],10,-1894986606);k=u(k,p,a,d,g[n+10],15,-1051523);d=u(d,k,p,a,g[n+1],21,-2054922799);a=u(a,d,k,p,g[n+8],6,1873313359);p=u(p,a,d,k,g[n+15],10,-30611744);
k=u(k,p,a,d,g[n+6],15,-1560198380);d=u(d,k,p,a,g[n+13],21,1309151649);a=u(a,d,k,p,g[n+4],6,-145523070);p=u(p,a,d,k,g[n+11],10,-1120210379);k=u(k,p,a,d,g[n+2],15,718787259);d=u(d,k,p,a,g[n+9],21,-343485551);a=a+t>>>0;d=d+v>>>0;k=k+r>>>0;p=p+w>>>0}return j.endian([a,d,k,p])};f._ff=function(a,b,c,f,d,p,n){a=a+(b&c|~b&f)+(d>>>0)+n;return(a<<p|a>>>32-p)+b};f._gg=function(a,b,c,f,d,p,n){a=a+(b&f|c&~f)+(d>>>0)+n;return(a<<p|a>>>32-p)+b};f._hh=function(a,b,c,f,d,p,n){a=a+(b^c^f)+(d>>>0)+n;return(a<<p|a>>>
32-p)+b};f._ii=function(a,b,c,f,d,p,n){a=a+(c^(b|~f))+(d>>>0)+n;return(a<<p|a>>>32-p)+b};f._blocksize=16;f._digestsize=16})();JCSDL.Loader.addComponent(function(){var d=jQuery,j=window,a=document,b=Math,c=d("body");d("html").add(c);d(j);d.extend(d,{string:{parseVariables:function(a,b){b=b||{};return a.replace(/\{(\$?[\w\d]+)\}/gi,function(a,c){var f="$"===c.substr(0,1);f&&(c=c.substr(1));return null===b[c]?"":void 0!==b[c]?b[c]:!f?"{"+c+"}":""})},random:function(a,c,g){a=a||16;var d="",m="1234567890abcdefghijkmnopqrstuvwxyz";c&&(m+="ABCDEFGHIJKLMNOPQRSTUVWXYZ");g&&(m+="?!.,;:^#@&");for(c=1;c<=a;c++)d+=m.charAt(b.floor(b.random()*
(m.length-1)));return d},trim:function(a,b){var c,d=0,m=0;c=b?(b+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \n\r\t\f\x0B\u00a0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000";d=a.length;for(m=0;m<d;m++)if(-1===c.indexOf(a.charAt(m))){a=a.substring(m);break}d=a.length;for(m=d-1;0<=m;m--)if(-1===c.indexOf(a.charAt(m))){a=a.substring(0,m+1);break}return-1===c.indexOf(a.charAt(0))?a:""},truncate:function(a,b,c){b=b||72;c=c||"...";if(a.length<=b)return a;
a=a.substr(0,b);return a.substr(0,a.lastIndexOf(" "))+c},escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},unescapeHtml:function(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}}});d.fn.extend({quickEach:function(a){for(var b=d([0]),c=-1,h=this.length,m;++c<h&&(m=b[0]=this[c])&&!1!==a.call(b,c,m););return this},display:function(a){return this.css("display",a||"inline-block")},outerHtml:function(){var a=
d(this);if("outerHTML"in a[0])return a[0].outerHTML;var b=a.wrap("<div></div>").parent().html();a.unwrap();return b},isAfter:function(a){return 0<this.prevAll(a).length},isBefore:function(a){return 0<this.nextAll(a).length},scrollIntoView:function(b,c){var g=a.body,h=b&&d(b).get(0)||g,m=h===a.documentElement||h===a.body,k=m?d(j):d(h),p=d(this).get(0),n=d(p).getOffsetsTo(h);g!==h&&(n[0]-=k.css("borderLeftWidth").replace("px",""),n[1]-=k.css("borderTopWidth").replace("px",""));var q=k.scrollTop(),l=
k.scrollLeft(),g=n[0]+(m?0:l),m=n[1]+(m?0:q),n=m+p.offsetHeight,h=g+p.offsetWidth,u=k.height(),t=k.width(),q=parseInt(q,10),l=parseInt(l,10),v=q+u,r=l+t;p.offsetHeight>u||m<q?k.scrollTop(m):n>v&&k.scrollTop(n-u);!1!==c&&(p.offsetWidth>t||g<l?k.scrollLeft(g):h>r&&k.scrollLeft(h-t));return this},getOffsetsTo:function(b){b=d(b).get(0);var c=d(this).offset();b=a.documentElement===b||a.body===b?{top:0,left:0}:d(b).offset();return[c.left-b.left,c.top-b.top]}})});RegExp.escape=function(d){return d.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")};
JCSDL.Loader.addComponent(function(d){d.csv={defaults:{separator:",",delimiter:'"',headers:!0},hooks:{castToScalar:function(d){if(isNaN(d))return d;if(/\./.test(d))return parseFloat(d);d=parseInt(d);return isNaN(d)?null:d}},parsers:{parse:function(d,a){function b(){m=0;k="";if(a.start&&a.state.rowNum<a.start)h=[];else{if(void 0===a.onParseEntry)g.push(h);else{var b=a.onParseEntry(h,a.state);!1!==b&&g.push(b)}h=[];a.end&&a.state.rowNum>=a.end&&(p=!0)}a.state.rowNum++;a.state.colNum=1}function c(){if(void 0===
a.onParseValue)h.push(k);else{var b=a.onParseValue(k,a.state);!1!==b&&h.push(b)}k="";m=0;a.state.colNum++}var f=a.separator,e=a.delimiter;a.state.rowNum||(a.state.rowNum=1);a.state.colNum||(a.state.colNum=1);var g=[],h=[],m=0,k="",p=!1,n=RegExp.escape(f),q=RegExp.escape(e),l=/(D|S|\n|\r|[^DS\r\n]+)/,l=l.source,l=l.replace(/S/g,n),l=l.replace(/D/g,q),l=RegExp(l,"gm");d.replace(l,function(g){if(!p)switch(m){case 0:if(g===f){k+="";c();break}if(g===e){m=1;break}if("\n"===g){c();b();break}if(/^\r$/.test(g))break;
k+=g;m=3;break;case 1:if(g===e){m=2;break}k+=g;m=1;break;case 2:if(g===e){k+=g;m=1;break}if(g===f){c();break}if("\n"===g){c();b();break}if(/^\r$/.test(g))break;throw Error("CSVDataError: Illegal State [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");case 3:if(g===f){c();break}if("\n"===g){c();b();break}if(/^\r$/.test(g))break;if(g===e)throw Error("CSVDataError: Illegal Quote [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");throw Error("CSVDataError: Illegal Data [Row:"+a.state.rowNum+"][Col:"+
a.state.colNum+"]");default:throw Error("CSVDataError: Unknown State [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");}});0!==h.length&&(c(),b());return g},splitLines:function(d,a){function b(){g=0;if(a.start&&a.state.rowNum<a.start)h="";else{if(void 0===a.onParseEntry)e.push(h);else{var b=a.onParseEntry(h,a.state);!1!==b&&e.push(b)}h="";a.end&&a.state.rowNum>=a.end&&(m=!0)}a.state.rowNum++}var c=a.separator,f=a.delimiter;a.state.rowNum||(a.state.rowNum=1);var e=[],g=0,h="",m=!1,k=RegExp.escape(c),
p=RegExp.escape(f),n=/(D|S|\n|\r|[^DS\r\n]+)/,n=n.source,n=n.replace(/S/g,k),n=n.replace(/D/g,p),n=RegExp(n,"gm");d.replace(n,function(e){if(!m)switch(g){case 0:if(e===c){h+=e;g=0;break}if(e===f){h+=e;g=1;break}if("\n"===e){b();break}if(/^\r$/.test(e))break;h+=e;g=3;break;case 1:if(e===f){h+=e;g=2;break}h+=e;g=1;break;case 2:var d=h.substr(h.length-1);if(e===f&&d===f){h+=e;g=1;break}if(e===c){h+=e;g=0;break}if("\n"===e){b();break}if("\r"===e)break;throw Error("CSVDataError: Illegal state [Row:"+a.state.rowNum+
"]");case 3:if(e===c){h+=e;g=0;break}if("\n"===e){b();break}if("\r"===e)break;if(e===f)throw Error("CSVDataError: Illegal quote [Row:"+a.state.rowNum+"]");throw Error("CSVDataError: Illegal state [Row:"+a.state.rowNum+"]");default:throw Error("CSVDataError: Unknown state [Row:"+a.state.rowNum+"]");}});""!==h&&b();return e},parseEntry:function(d,a){function b(){if(void 0===a.onParseValue)e.push(h);else{var b=a.onParseValue(h,a.state);!1!==b&&e.push(b)}h="";g=0;a.state.colNum++}var c=a.separator,f=
a.delimiter;a.state.rowNum||(a.state.rowNum=1);a.state.colNum||(a.state.colNum=1);var e=[],g=0,h="";if(!a.match){var m=RegExp.escape(c),k=RegExp.escape(f),p=/(D|S|\n|\r|[^DS\r\n]+)/.source,p=p.replace(/S/g,m),p=p.replace(/D/g,k);a.match=RegExp(p,"gm")}d.replace(a.match,function(e){switch(g){case 0:if(e===c){h+="";b();break}if(e===f){g=1;break}if("\n"===e||"\r"===e)break;h+=e;g=3;break;case 1:if(e===f){g=2;break}h+=e;g=1;break;case 2:if(e===f){h+=e;g=1;break}if(e===c){b();break}if("\n"===e||"\r"===
e)break;throw Error("CSVDataError: Illegal State [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");case 3:if(e===c){b();break}if("\n"===e||"\r"===e)break;if(e===f)throw Error("CSVDataError: Illegal Quote [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");throw Error("CSVDataError: Illegal Data [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");default:throw Error("CSVDataError: Unknown State [Row:"+a.state.rowNum+"][Col:"+a.state.colNum+"]");}});b();return e}},toArray:function(j,a,b){a=void 0!==
a?a:{};var c={};c.callback=void 0!==b&&"function"===typeof b?b:!1;c.separator="separator"in a?a.separator:d.csv.defaults.separator;c.delimiter="delimiter"in a?a.delimiter:d.csv.defaults.delimiter;a={delimiter:c.delimiter,separator:c.separator,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,state:void 0!==a.state?a.state:{}};j=d.csv.parsers.parseEntry(j,a);if(c.callback)c.callback("",j);else return j},toArrays:function(j,a,b){a=void 0!==a?a:{};var c={};c.callback=void 0!==b&&"function"===typeof b?
b:!1;c.separator="separator"in a?a.separator:d.csv.defaults.separator;c.delimiter="delimiter"in a?a.delimiter:d.csv.defaults.delimiter;b=[];a={delimiter:c.delimiter,separator:c.separator,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,start:a.start,end:a.end,state:{rowNum:1,colNum:1}};b=d.csv.parsers.parse(j,a);if(c.callback)c.callback("",b);else return b},toObjects:function(j,a,b){a=void 0!==a?a:{};var c={};c.callback=void 0!==b&&"function"===typeof b?b:!1;c.separator="separator"in a?a.separator:
d.csv.defaults.separator;c.delimiter="delimiter"in a?a.delimiter:d.csv.defaults.delimiter;c.headers="headers"in a?a.headers:d.csv.defaults.headers;a.start="start"in a?a.start:1;c.headers&&a.start++;a.end&&c.headers&&a.end++;var f=[];b=[];a={delimiter:c.delimiter,separator:c.separator,onParseEntry:a.onParseEntry,onParseValue:a.onParseValue,start:a.start,end:a.end,state:{rowNum:1,colNum:1},match:!1};var f=d.csv.parsers.splitLines(j,{delimiter:c.delimiter,separator:c.separator,start:1,end:1,state:{rowNum:1,
colNum:1}}),e=d.csv.toArray(f[0],a),f=d.csv.parsers.splitLines(j,a);a.state.colNum=1;a.state.rowNum=e?2:1;j=0;for(var g=f.length;j<g;j++){var h=d.csv.toArray(f[j],a),m={},k;for(k in e)m[e[k]]=h[k];b.push(m);a.state.rowNum++}if(c.callback)c.callback("",b);else return b},fromArrays:function(j,a,b){a=void 0!==a?a:{};var c={};c.callback=void 0!==b&&"function"===typeof b?b:!1;c.separator="separator"in a?a.separator:d.csv.defaults.separator;c.delimiter="delimiter"in a?a.delimiter:d.csv.defaults.delimiter;
c.escaper="escaper"in a?a.escaper:d.csv.defaults.escaper;c.experimental="experimental"in a?a.experimental:!1;if(!c.experimental)throw Error("not implemented");a=[];for(i in j)a.push(j[i]);if(c.callback)c.callback("",a);else return a},fromObjects2CSV:function(j,a,b){a=void 0!==a?a:{};var c={};c.callback=void 0!==b&&"function"===typeof b?b:!1;c.separator="separator"in a?a.separator:d.csv.defaults.separator;c.delimiter="delimiter"in a?a.delimiter:d.csv.defaults.delimiter;c.experimental="experimental"in
a?a.experimental:!1;if(!c.experimental)throw Error("not implemented");a=[];for(i in j)a.push(arrays[i]);if(c.callback)c.callback("",a);else return a}};d.csvEntry2Array=d.csv.toArray;d.csv2Array=d.csv.toArrays;d.csv2Dictionary=d.csv.toObjects});JCSDL.Loader.addComponent(function(){var d=jQuery,j=function(b,c){var e,g,f,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,g=e.name,b.href&&g&&"map"===e.nodeName.toLowerCase()?(f=d("img[usemap=#"+g+"]")[0],!!f&&a(f)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&a(b)},a=function(a){return d.expr.filters.visible(a)&&!d(a).parents().addBack().filter(function(){return"hidden"===d.css(this,"visibility")}).length},b=0,c=/^ui-id-\d+$/;d.ui=d.ui||{};d.extend(d.ui,
{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});d.fn.extend({focus:function(a){return function(b,c){return"number"==typeof b?this.each(function(){var a=this;setTimeout(function(){d(a).focus();c&&c.call(a)},b)}):a.apply(this,arguments)}}(d.fn.focus),scrollParent:function(){var a;
return a=d.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(d.css(this,"position"))&&/(auto|scroll)/.test(d.css(this,"overflow")+d.css(this,"overflow-y")+d.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(d.css(this,"overflow")+d.css(this,"overflow-y")+d.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!a.length?d(document):
a},zIndex:function(a){if(void 0!==a)return this.css("zIndex",a);if(this.length){var b,c;for(a=d(this[0]);a.length&&a[0]!==document;){if(b=a.css("position"),("absolute"===b||"relative"===b||"fixed"===b)&&(c=parseInt(a.css("zIndex"),10),!isNaN(c)&&0!==c))return c;a=a.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++b)})},removeUniqueId:function(){return this.each(function(){c.test(this.id)&&d(this).removeAttr("id")})}});d.extend(d.expr[":"],{data:d.expr.createPseudo?
d.expr.createPseudo(function(a){return function(b){return!!d.data(b,a)}}):function(a,b,c){return!!d.data(a,c[3])},focusable:function(a){return j(a,!isNaN(d.attr(a,"tabindex")))},tabbable:function(a){var b=d.attr(a,"tabindex"),c=isNaN(b);return(c||0<=b)&&j(a,!c)}});d("<a>").outerWidth(1).jquery||d.each(["Width","Height"],function(a,b){function c(a,b,g,f){return d.each(e,function(){b-=parseFloat(d.css(a,"padding"+this))||0;g&&(b-=parseFloat(d.css(a,"border"+this+"Width"))||0);f&&(b-=parseFloat(d.css(a,
"margin"+this))||0)}),b}var e="Width"===b?["Left","Right"]:["Top","Bottom"],g=b.toLowerCase(),f={innerWidth:d.fn.innerWidth,innerHeight:d.fn.innerHeight,outerWidth:d.fn.outerWidth,outerHeight:d.fn.outerHeight};d.fn["inner"+b]=function(a){return void 0===a?f["inner"+b].call(this):this.each(function(){d(this).css(g,c(this,a)+"px")})};d.fn["outer"+b]=function(a,e){return"number"!=typeof a?f["outer"+b].call(this,a):this.each(function(){d(this).css(g,c(this,a,!0,e)+"px")})}});d.fn.addBack||(d.fn.addBack=
function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))});if(d("<a>").data("a-b","a").removeData("a-b").data("a-b")){var f=d.fn.removeData;d.fn.removeData=function(a){return arguments.length?f.call(this,d.camelCase(a)):f.call(this)}}d.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());d.support.selectstart="onselectstart"in document.createElement("div");d.fn.extend({disableSelection:function(){return this.bind((d.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",
function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});d.extend(d.ui,{plugin:{add:function(a,b,c){var e;a=d.ui[a].prototype;for(e in c)a.plugins[e]=a.plugins[e]||[],a.plugins[e].push([b,c[e]])},call:function(a,b,c){var e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(b=0;e.length>b;b++)a.options[e[b][0]]&&e[b][1].apply(a.element,c)}},hasScroll:function(a,b){if("hidden"===d(a).css("overflow"))return!1;var c=
b&&"left"===b?"scrollLeft":"scrollTop";return 0<a[c]?!0:(a[c]=1,a[c]=0,!1)}});var e=jQuery,g=void 0,h=0,m=Array.prototype.slice,k=e.cleanData;e.cleanData=function(a){for(var b,c=0;null!=(b=a[c]);c++)try{e(b).triggerHandler("remove")}catch(g){}k(a)};e.widget=function(a,b,c){var d,f,h,n,k={},m=a.split(".")[0];a=a.split(".")[1];d=m+"-"+a;c||(c=b,b=e.Widget);e.expr[":"][d.toLowerCase()]=function(a){return!!e.data(a,d)};e[m]=e[m]||{};f=e[m][a];h=e[m][a]=function(a,b){return this._createWidget?(arguments.length&&
this._createWidget(a,b),g):new h(a,b)};e.extend(h,f,{version:c.version,_proto:e.extend({},c),_childConstructors:[]});n=new b;n.options=e.widget.extend({},n.options);e.each(c,function(a,c){var d;if(e.isFunction(c)){var f=function(){return b.prototype[a].apply(this,arguments)},v=function(c){return b.prototype[a].apply(this,c)};d=(k[a]=function(){var a,b=this._super,e=this._superApply;return this._super=f,this._superApply=v,a=c.apply(this,arguments),this._super=b,this._superApply=e,a},g)}else d=(k[a]=
c,g);return d});h.prototype=e.widget.extend(n,{widgetEventPrefix:f?n.widgetEventPrefix:a},k,{constructor:h,namespace:m,widgetName:a,widgetFullName:d});f?(e.each(f._childConstructors,function(a,b){var c=b.prototype;e.widget(c.namespace+"."+c.widgetName,h,b._proto)}),delete f._childConstructors):b._childConstructors.push(h);e.widget.bridge(a,h)};e.widget.extend=function(a){for(var b,c,d=m.call(arguments,1),f=0,h=d.length;h>f;f++)for(b in d[f])c=d[f][b],d[f].hasOwnProperty(b)&&c!==g&&(a[b]=e.isPlainObject(c)?
e.isPlainObject(a[b])?e.widget.extend({},a[b],c):e.widget.extend({},c):c);return a};e.widget.bridge=function(a,b){var c=b.prototype.widgetFullName||a;e.fn[a]=function(d){var f="string"==typeof d,h=m.call(arguments,1),n=this;return d=!f&&h.length?e.widget.extend.apply(null,[d].concat(h)):d,f?this.each(function(){var b,f=e.data(this,c);return f?e.isFunction(f[d])&&"_"!==d.charAt(0)?(b=f[d].apply(f,h),b!==f&&b!==g?(n=b&&b.jquery?n.pushStack(b.get()):b,!1):g):e.error("no such method '"+d+"' for "+a+" widget instance"):
e.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+d+"'")}):this.each(function(){var a=e.data(this,c);a?a.option(d||{})._init():e.data(this,c,new b(d,this))}),n}};e.Widget=function(){};e.Widget._childConstructors=[];e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,b){b=e(b||this.defaultElement||this)[0];this.element=e(b);this.uuid=h++;this.eventNamespace="."+this.widgetName+
this.uuid;this.options=e.widget.extend({},this.options,this._getCreateOptions(),a);this.bindings=e();this.hoverable=e();this.focusable=e();b!==this&&(e.data(b,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===b&&this.destroy()}}),this.document=e(b.style?b.ownerDocument:b.document||b),this.window=e(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:e.noop,
_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},
_destroy:e.noop,widget:function(){return this.element},option:function(a,b){var c,d,f,h=a;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof a)if(h={},c=a.split("."),a=c.shift(),c.length){d=h[a]=e.widget.extend({},this.options[a]);for(f=0;c.length-1>f;f++)d[c[f]]=d[c[f]]||{},d=d[c[f]];if(a=c.pop(),b===g)return d[a]===g?null:d[a];d[a]=b}else{if(b===g)return this.options[a]===g?null:this.options[a];h[a]=b}return this._setOptions(h),this},_setOptions:function(a){for(var b in a)this._setOption(b,
a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(a,b,c){var d,f=this;"boolean"!=typeof a&&(c=b,b=a,a=!1);c?(b=d=e(b),this.bindings=this.bindings.add(b)):
(c=b,b=this.element,d=this.widget());e.each(c,function(c,h){function w(){return a||!0!==f.options.disabled&&!e(this).hasClass("ui-state-disabled")?("string"==typeof h?f[h]:h).apply(f,arguments):g}"string"!=typeof h&&(w.guid=h.guid=h.guid||w.guid||e.guid++);var n=c.match(/^(\w+)\s*(.*)$/),k=n[1]+f.eventNamespace;(n=n[2])?d.delegate(n,k,w):b.bind(k,w)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},_delay:function(a,b){var c=this;
return setTimeout(function(){return("string"==typeof a?c[a]:a).apply(c,arguments)},b||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){e(a.currentTarget).addClass("ui-state-hover")},mouseleave:function(a){e(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){e(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){e(a.currentTarget).removeClass("ui-state-focus")}})},
_trigger:function(a,b,c){var g,d=this.options[a];if(c=c||{},b=e.Event(b),b.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),b.target=this.element[0],a=b.originalEvent)for(g in a)g in b||(b[g]=a[g]);return this.element.trigger(b,c),!(e.isFunction(d)&&!1===d.apply(this.element[0],[b].concat(c))||b.isDefaultPrevented())}};e.each({show:"fadeIn",hide:"fadeOut"},function(a,b){e.Widget.prototype["_"+a]=function(c,g,d){"string"==typeof g&&(g={effect:g});var f,h=g?!0===g||"number"==
typeof g?b:g.effect||b:a;g=g||{};"number"==typeof g&&(g={duration:g});f=!e.isEmptyObject(g);g.complete=d;g.delay&&c.delay(g.delay);f&&e.effects&&e.effects.effect[h]?c[a](g):h!==a&&c[h]?c[h](g.duration,g.easing,d):c.queue(function(b){e(this)[a]();d&&d.call(c[0]);b()})}});var p=jQuery,n=!1;p(document).mouseup(function(){n=!1});p.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+
this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+this.widgetName,function(b){return!0===p.data(b.target,a.widgetName+".preventClickEvent")?(p.removeData(b.target,a.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1):void 0});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&p(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(!n){this._mouseStarted&&
this._mouseUp(a);this._mouseDownEvent=a;var b=this,c=1===a.which,g="string"==typeof this.options.cancel&&a.target.nodeName?p(a.target).closest(this.options.cancel).length:!1;return c&&!g&&this._mouseCapture(a)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(a),!this._mouseStarted)?(a.preventDefault(),!0):(!0===
p.data(a.target,this.widgetName+".preventClickEvent")&&p.removeData(a.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return b._mouseMove(a)},this._mouseUpDelegate=function(a){return b._mouseUp(a)},p(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),a.preventDefault(),n=!0,!0)):!0}},_mouseMove:function(a){return p.ui.ie&&(!document.documentMode||9>document.documentMode)&&!a.button?this._mouseUp(a):
this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,a),this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted)},_mouseUp:function(a){return p(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,a.target===this._mouseDownEvent.target&&p.data(a.target,
this.widgetName+".preventClickEvent",!0),this._mouseStop(a)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});var q=jQuery;q.widget("ui.draggable",q.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,
appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative");this.options.addClasses&&
this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(a){var b=this.options;return this.helper||b.disabled||0<q(a.target).closest(".ui-resizable-handle").length?!1:(this.handle=this._getHandle(a),this.handle?(q(!0===b.iframeFix?"iframe":b.iframeFix).each(function(){q("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+
"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(q(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(a){var b=this.options;return this.helper=this._createHelper(a),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),q.ui.ddmanager&&(q.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=
this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,q.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(a),this.originalPageX=a.pageX,this.originalPageY=a.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),
this._setContainment(),!1===this._trigger("start",a)?(this._clear(),!1):(this._cacheHelperProportions(),q.ui.ddmanager&&!b.dropBehaviour&&q.ui.ddmanager.prepareOffsets(this,a),this._mouseDrag(a,!0),q.ui.ddmanager&&q.ui.ddmanager.dragStart(this,a),!0)},_mouseDrag:function(a,b){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(a),this.positionAbs=this._convertPositionTo("absolute"),!b){var c=this._uiHash();if(!1===this._trigger("drag",
a,c))return this._mouseUp({}),!1;this.position=c.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),q.ui.ddmanager&&q.ui.ddmanager.drag(this,a),!1},_mouseStop:function(a){var b=this,c=!1;return q.ui.ddmanager&&!this.options.dropBehaviour&&(c=q.ui.ddmanager.drop(this,a)),this.dropped&&(c=this.dropped,this.dropped=!1),"original"!==this.options.helper||
q.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!c||"valid"===this.options.revert&&c||!0===this.options.revert||q.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)?q(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==b._trigger("stop",a)&&b._clear()}):!1!==this._trigger("stop",a)&&this._clear(),!1):!1},_mouseUp:function(a){return q("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),
q.ui.ddmanager&&q.ui.ddmanager.dragStop(this,a),q.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(a){return this.options.handle?!!q(a.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(a){var b=this.options;a=q.isFunction(b.helper)?q(b.helper.apply(this.element[0],[a])):"clone"===b.helper?this.element.clone().removeAttr("id"):this.element;return a.parents("body").length||
a.appendTo("parent"===b.appendTo?this.element[0].parentNode:b.appendTo),a[0]===this.element[0]||/(fixed|absolute)/.test(a.css("position"))||a.css("position","absolute"),a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));q.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);
"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){var a=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&q.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&q.ui.ie)&&(a={top:0,
left:0}),{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),
10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a,b,c,g=this.options;return g.containment?"window"===g.containment?(this.containment=[q(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,q(window).scrollTop()-
this.offset.relative.top-this.offset.parent.top,q(window).scrollLeft()+q(window).width()-this.helperProportions.width-this.margins.left,q(window).scrollTop()+(q(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===g.containment?(this.containment=[0,0,q(document).width()-this.helperProportions.width-this.margins.left,(q(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],
void 0):g.containment.constructor===Array?(this.containment=g.containment,void 0):("parent"===g.containment&&(g.containment=this.helper[0].parentNode),b=q(g.containment),c=b[0],c&&(a="hidden"!==b.css("overflow"),this.containment=[(parseInt(b.css("borderLeftWidth"),10)||0)+(parseInt(b.css("paddingLeft"),10)||0),(parseInt(b.css("borderTopWidth"),10)||0)+(parseInt(b.css("paddingTop"),10)||0),(a?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(b.css("borderRightWidth"),10)||0)-(parseInt(b.css("paddingRight"),
10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(a?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(b.css("borderBottomWidth"),10)||0)-(parseInt(b.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=b),void 0):(this.containment=null,void 0)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,g="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&q.contains(this.scrollParent[0],
this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:g.scrollTop(),left:g.scrollLeft()}),{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*c}},_generatePosition:function(a){var b,c,g,e,d=this.options,
f="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&q.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=a.pageX,n=a.pageY;return this.offset.scroll||(this.offset.scroll={top:f.scrollTop(),left:f.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(c=this.relative_container.offset(),b=[this.containment[0]+c.left,this.containment[1]+c.top,this.containment[2]+c.left,this.containment[3]+c.top]):b=this.containment,a.pageX-
this.offset.click.left<b[0]&&(h=b[0]+this.offset.click.left),a.pageY-this.offset.click.top<b[1]&&(n=b[1]+this.offset.click.top),a.pageX-this.offset.click.left>b[2]&&(h=b[2]+this.offset.click.left),a.pageY-this.offset.click.top>b[3]&&(n=b[3]+this.offset.click.top)),d.grid&&(g=d.grid[1]?this.originalPageY+Math.round((n-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,n=b?g-this.offset.click.top>=b[1]||g-this.offset.click.top>b[3]?g:g-this.offset.click.top>=b[1]?g-d.grid[1]:g+d.grid[1]:g,
e=d.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,h=b?e-this.offset.click.left>=b[0]||e-this.offset.click.left>b[2]?e:e-this.offset.click.left>=b[0]?e-d.grid[0]:e+d.grid[0]:e)),{top:n-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():
this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(a,b,c){return c=c||this._uiHash(),q.ui.plugin.call(this,a,[b,c]),"drag"===a&&(this.positionAbs=this._convertPositionTo("absolute")),q.Widget.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,
offset:this.positionAbs}}});q.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=q(this).data("ui-draggable"),g=c.options,e=q.extend({},b,{item:c.element});c.sortables=[];q(g.connectToSortable).each(function(){var b=q.data(this,"ui-sortable");b&&!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),b.refreshPositions(),b._trigger("activate",a,e))})},stop:function(a,b){var c=q(this).data("ui-draggable"),g=q.extend({},b,{item:c.element});q.each(c.sortables,
function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,"original"===c.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,g))})},drag:function(a,b){var c=q(this).data("ui-draggable"),g=this;
q.each(c.sortables,function(){var e=!1,d=this;this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&(e=!0,q.each(c.sortables,function(){return this.instance.positionAbs=c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this!==d&&this.instance._intersectsWith(this.instance.containerCache)&&q.contains(d.instance.element[0],
this.instance.element[0])&&(e=!1),e}));e?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=q(g).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return b.helper[0]},a.target=this.instance.currentItem[0],this.instance._mouseCapture(a,!0),this.instance._mouseStart(a,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=
c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",a),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(a)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",
a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",a),c.dropped=!1)})}});q.ui.plugin.add("draggable","cursor",{start:function(){var a=q("body"),b=q(this).data("ui-draggable").options;a.css("cursor")&&(b._cursor=a.css("cursor"));a.css("cursor",b.cursor)},stop:function(){var a=q(this).data("ui-draggable").options;
a._cursor&&q("body").css("cursor",a._cursor)}});q.ui.plugin.add("draggable","opacity",{start:function(a,b){var c=q(b.helper),g=q(this).data("ui-draggable").options;c.css("opacity")&&(g._opacity=c.css("opacity"));c.css("opacity",g.opacity)},stop:function(a,b){var c=q(this).data("ui-draggable").options;c._opacity&&q(b.helper).css("opacity",c._opacity)}});q.ui.plugin.add("draggable","scroll",{start:function(){var a=q(this).data("ui-draggable");a.scrollParent[0]!==document&&"HTML"!==a.scrollParent[0].tagName&&
(a.overflowOffset=a.scrollParent.offset())},drag:function(a){var b=q(this).data("ui-draggable"),c=b.options,g=!1;b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName?(c.axis&&"x"===c.axis||(b.overflowOffset.top+b.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity?b.scrollParent[0].scrollTop=g=b.scrollParent[0].scrollTop+c.scrollSpeed:a.pageY-b.overflowOffset.top<c.scrollSensitivity&&(b.scrollParent[0].scrollTop=g=b.scrollParent[0].scrollTop-c.scrollSpeed)),c.axis&&"y"===c.axis||
(b.overflowOffset.left+b.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity?b.scrollParent[0].scrollLeft=g=b.scrollParent[0].scrollLeft+c.scrollSpeed:a.pageX-b.overflowOffset.left<c.scrollSensitivity&&(b.scrollParent[0].scrollLeft=g=b.scrollParent[0].scrollLeft-c.scrollSpeed))):(c.axis&&"x"===c.axis||(a.pageY-q(document).scrollTop()<c.scrollSensitivity?g=q(document).scrollTop(q(document).scrollTop()-c.scrollSpeed):q(window).height()-(a.pageY-q(document).scrollTop())<c.scrollSensitivity&&(g=q(document).scrollTop(q(document).scrollTop()+
c.scrollSpeed))),c.axis&&"y"===c.axis||(a.pageX-q(document).scrollLeft()<c.scrollSensitivity?g=q(document).scrollLeft(q(document).scrollLeft()-c.scrollSpeed):q(window).width()-(a.pageX-q(document).scrollLeft())<c.scrollSensitivity&&(g=q(document).scrollLeft(q(document).scrollLeft()+c.scrollSpeed))));!1!==g&&q.ui.ddmanager&&!c.dropBehaviour&&q.ui.ddmanager.prepareOffsets(b,a)}});q.ui.plugin.add("draggable","snap",{start:function(){var a=q(this).data("ui-draggable"),b=a.options;a.snapElements=[];q(b.snap.constructor!==
String?b.snap.items||":data(ui-draggable)":b.snap).each(function(){var b=q(this),c=b.offset();this!==a.element[0]&&a.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(a,b){var c,g,e,d,f,h,n,k,m,p,l=q(this).data("ui-draggable"),j=l.options,u=j.snapTolerance,t=b.offset.left,y=t+l.helperProportions.width,x=b.offset.top,z=x+l.helperProportions.height;for(m=l.snapElements.length-1;0<=m;m--)f=l.snapElements[m].left,h=f+l.snapElements[m].width,
n=l.snapElements[m].top,k=n+l.snapElements[m].height,f-u>y||t>h+u||n-u>z||x>k+u||!q.contains(l.snapElements[m].item.ownerDocument,l.snapElements[m].item)?(l.snapElements[m].snapping&&l.options.snap.release&&l.options.snap.release.call(l.element,a,q.extend(l._uiHash(),{snapItem:l.snapElements[m].item})),l.snapElements[m].snapping=!1):("inner"!==j.snapMode&&(c=u>=Math.abs(n-z),g=u>=Math.abs(k-x),e=u>=Math.abs(f-y),d=u>=Math.abs(h-t),c&&(b.position.top=l._convertPositionTo("relative",{top:n-l.helperProportions.height,
left:0}).top-l.margins.top),g&&(b.position.top=l._convertPositionTo("relative",{top:k,left:0}).top-l.margins.top),e&&(b.position.left=l._convertPositionTo("relative",{top:0,left:f-l.helperProportions.width}).left-l.margins.left),d&&(b.position.left=l._convertPositionTo("relative",{top:0,left:h}).left-l.margins.left)),p=c||g||e||d,"outer"!==j.snapMode&&(c=u>=Math.abs(n-x),g=u>=Math.abs(k-z),e=u>=Math.abs(f-t),d=u>=Math.abs(h-y),c&&(b.position.top=l._convertPositionTo("relative",{top:n,left:0}).top-
l.margins.top),g&&(b.position.top=l._convertPositionTo("relative",{top:k-l.helperProportions.height,left:0}).top-l.margins.top),e&&(b.position.left=l._convertPositionTo("relative",{top:0,left:f}).left-l.margins.left),d&&(b.position.left=l._convertPositionTo("relative",{top:0,left:h-l.helperProportions.width}).left-l.margins.left)),!l.snapElements[m].snapping&&(c||g||e||d||p)&&l.options.snap.snap&&l.options.snap.snap.call(l.element,a,q.extend(l._uiHash(),{snapItem:l.snapElements[m].item})),l.snapElements[m].snapping=
c||g||e||d||p)}});q.ui.plugin.add("draggable","stack",{start:function(){var a,b=this.data("ui-draggable").options,b=q.makeArray(q(b.stack)).sort(function(a,b){return(parseInt(q(a).css("zIndex"),10)||0)-(parseInt(q(b).css("zIndex"),10)||0)});b.length&&(a=parseInt(q(b[0]).css("zIndex"),10)||0,q(b).each(function(b){q(this).css("zIndex",a+b)}),this.css("zIndex",a+b.length))}});q.ui.plugin.add("draggable","zIndex",{start:function(a,b){var c=q(b.helper),g=q(this).data("ui-draggable").options;c.css("zIndex")&&
(g._zIndex=c.css("zIndex"));c.css("zIndex",g.zIndex)},stop:function(a,b){var c=q(this).data("ui-draggable").options;c._zIndex&&q(b.helper).css("zIndex",c._zIndex)}});var l=jQuery,u=function(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))};l.widget("ui.sortable",l.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,
grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?"x"===a.axis||u(this.items[0].item):
!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(a,b){"disabled"===a?(this.options[a]=b,this.widget().toggleClass("ui-sortable-disabled",!!b)):l.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,b){var c=null,g=!1,e=this;return this.reverting?
!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(a),l(a.target).parents().each(function(){return l.data(this,e.widgetName+"-item")===e?(c=l(this),!1):void 0}),l.data(a.target,e.widgetName+"-item")===e&&(c=l(a.target)),c?!this.options.handle||b||(l(this.options.handle,c).find("*").addBack().each(function(){this===a.target&&(g=!0)}),g)?(this.currentItem=c,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(a,b,c){var g;b=this.options;if(this.currentContainer=
this,this.refreshPositions(),this.helper=this._createHelper(a),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},l.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=
this.helper.css("position"),this.originalPosition=this._generatePosition(a),this.originalPageX=a.pageX,this.originalPageY=a.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),b.containment&&this._setContainment(),b.cursor&&"auto"!==b.cursor&&(g=this.document.find("body"),this.storedCursor=g.css("cursor"),g.css("cursor",
b.cursor),this.storedStylesheet=l("<style>*{ cursor: "+b.cursor+" !important; }</style>").appendTo(g)),b.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",b.opacity)),b.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",b.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",a,this._uiHash()),
this._preserveHelperProportions||this._cacheHelperProportions(),!c)for(c=this.containers.length-1;0<=c;c--)this.containers[c]._trigger("activate",a,this._uiHash(this));return l.ui.ddmanager&&(l.ui.ddmanager.current=this),l.ui.ddmanager&&!b.dropBehaviour&&l.ui.ddmanager.prepareOffsets(this,a),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(a),!0},_mouseDrag:function(a){var b,c,g,e;b=this.options;var d=!1;this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");
this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<b.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+b.scrollSpeed:a.pageY-this.overflowOffset.top<b.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-b.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-
a.pageX<b.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+b.scrollSpeed:a.pageX-this.overflowOffset.left<b.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-b.scrollSpeed)):(a.pageY-l(document).scrollTop()<b.scrollSensitivity?d=l(document).scrollTop(l(document).scrollTop()-b.scrollSpeed):l(window).height()-(a.pageY-l(document).scrollTop())<b.scrollSensitivity&&(d=l(document).scrollTop(l(document).scrollTop()+b.scrollSpeed)),a.pageX-
l(document).scrollLeft()<b.scrollSensitivity?d=l(document).scrollLeft(l(document).scrollLeft()-b.scrollSpeed):l(window).width()-(a.pageX-l(document).scrollLeft())<b.scrollSensitivity&&(d=l(document).scrollLeft(l(document).scrollLeft()+b.scrollSpeed))),!1!==d&&l.ui.ddmanager&&!b.dropBehaviour&&l.ui.ddmanager.prepareOffsets(this,a));this.positionAbs=this._convertPositionTo("absolute");this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px");this.options.axis&&
"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(b=this.items.length-1;0<=b;b--)if(c=this.items[b],g=c.item[0],e=this._intersectsWithPointer(c),e&&c.instance===this.currentContainer&&g!==this.currentItem[0]&&this.placeholder[1===e?"next":"prev"]()[0]!==g&&!l.contains(this.placeholder[0],g)&&("semi-dynamic"===this.options.type?!l.contains(this.element[0],g):!0)){if(this.direction=1===e?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(c))break;
this._rearrange(a,c);this._trigger("change",a,this._uiHash());break}return this._contactContainers(a),l.ui.ddmanager&&l.ui.ddmanager.drag(this,a),this._trigger("sort",a,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(a,b){if(a){if(l.ui.ddmanager&&!this.options.dropBehaviour&&l.ui.ddmanager.drop(this,a),this.options.revert){var c=this,g=this.placeholder.offset(),e=this.options.axis,d={};e&&"x"!==e||(d.left=g.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===
document.body?0:this.offsetParent[0].scrollLeft));e&&"y"!==e||(d.top=g.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop));this.reverting=!0;l(this.helper).animate(d,parseInt(this.options.revert,10)||500,function(){c._clear(a)})}else this._clear(a,b);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();
for(var a=this.containers.length-1;0<=a;a--)this.containers[a]._trigger("deactivate",null,this._uiHash(this)),this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",null,this._uiHash(this)),this.containers[a].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),l.extend(this,{helper:null,dragging:!1,
reverting:!1,_noFinalSort:null}),this.domPosition.prev?l(this.domPosition.prev).after(this.currentItem):l(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(a){var b=this._getItemsAsjQuery(a&&a.connected),c=[];return a=a||{},l(b).each(function(){var b=(l(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[\-=_](.+)/);b&&c.push((a.key||b[1]+"[]")+"="+(a.key&&a.expression?b[1]:b[2]))}),!c.length&&a.key&&c.push(a.key+"="),c.join("&")},toArray:function(a){var b=
this._getItemsAsjQuery(a&&a.connected),c=[];return a=a||{},b.each(function(){c.push(l(a.item||this).attr(a.attribute||"id")||"")}),c},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,g=this.positionAbs.top,e=g+this.helperProportions.height,d=a.left,f=d+a.width,h=a.top,n=h+a.height,k=this.offset.click.top,m=this.offset.click.left,m="y"===this.options.axis||b+m>d&&f>b+m,k=("x"===this.options.axis||g+k>h&&n>g+k)&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||
"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?k:b+this.helperProportions.width/2>d&&f>c-this.helperProportions.width/2&&g+this.helperProportions.height/2>h&&n>e-this.helperProportions.height/2},_intersectsWithPointer:function(a){var b="y"===this.options.axis||this.positionAbs.left+this.offset.click.left>a.left&&a.left+a.width>this.positionAbs.left+this.offset.click.left;a=("x"===this.options.axis||this.positionAbs.top+
this.offset.click.top>a.top&&a.top+a.height>this.positionAbs.top+this.offset.click.top)&&b;var b=this._getDragVerticalDirection(),c=this._getDragHorizontalDirection();return a?this.floating?c&&"right"===c||"down"===b?2:1:b&&("down"===b?2:1):!1},_intersectsWithSides:function(a){var b=this.positionAbs.top+this.offset.click.top>a.top+a.height/2&&a.top+a.height/2+a.height>this.positionAbs.top+this.offset.click.top;a=this.positionAbs.left+this.offset.click.left>a.left+a.width/2&&a.left+a.width/2+a.width>
this.positionAbs.left+this.offset.click.left;var c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?"right"===g&&a||"left"===g&&!a:c&&("down"===c&&b||"up"===c&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(0<a?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(0<a?"right":"left")},refresh:function(a){return this._refreshItems(a),
this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(a){var b,c,g,e=[],d=[],f=this._connectWith();if(f&&a)for(a=f.length-1;0<=a;a--){c=l(f[a]);for(b=c.length-1;0<=b;b--)(g=l.data(c[b],this.widgetFullName))&&g!==this&&!g.options.disabled&&d.push([l.isFunction(g.options.items)?g.options.items.call(g.element):l(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),
g])}d.push([l.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):l(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(a=d.length-1;0<=a;a--)d[a][0].each(function(){e.push(this)});return l(e)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=l.grep(this.items,function(b){for(var c=0;a.length>c;c++)if(a[c]===b.item[0])return!1;
return!0})},_refreshItems:function(a){this.items=[];this.containers=[this];var b,c,g,e,d,f=this.items,h=[[l.isFunction(this.options.items)?this.options.items.call(this.element[0],a,{item:this.currentItem}):l(this.options.items,this.element),this]];if((d=this._connectWith())&&this.ready)for(b=d.length-1;0<=b;b--){g=l(d[b]);for(c=g.length-1;0<=c;c--)(e=l.data(g[c],this.widgetFullName))&&e!==this&&!e.options.disabled&&(h.push([l.isFunction(e.options.items)?e.options.items.call(e.element[0],a,{item:this.currentItem}):
l(e.options.items,e.element),e]),this.containers.push(e))}for(b=h.length-1;0<=b;b--){a=h[b][1];g=h[b][0];c=0;for(d=g.length;d>c;c++)e=l(g[c]),e.data(this.widgetName+"-item",a),f.push({item:e,instance:a,width:0,height:0,left:0,top:0})}},refreshPositions:function(a){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var b,c,g,e;for(b=this.items.length-1;0<=b;b--)c=this.items[b],c.instance!==this.currentContainer&&this.currentContainer&&c.item[0]!==this.currentItem[0]||(g=this.options.toleranceElement?
l(this.options.toleranceElement,c.item):c.item,a||(c.width=g.outerWidth(),c.height=g.outerHeight()),e=g.offset(),c.left=e.left,c.top=e.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=this.containers.length-1;0<=b;b--)e=this.containers[b].element.offset(),this.containers[b].containerCache.left=e.left,this.containers[b].containerCache.top=e.top,this.containers[b].containerCache.width=this.containers[b].element.outerWidth(),
this.containers[b].containerCache.height=this.containers[b].element.outerHeight();return this},_createPlaceholder:function(a){a=a||this;var b,c=a.options;c.placeholder&&c.placeholder.constructor!==String||(b=c.placeholder,c.placeholder={element:function(){var c=a.currentItem[0].nodeName.toLowerCase(),g=l("<"+c+">",a.document[0]).addClass(b||a.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===c?a.currentItem.children().each(function(){l("<td>&#160;</td>",
a.document[0]).attr("colspan",l(this).attr("colspan")||1).appendTo(g)}):"img"===c&&g.attr("src",a.currentItem.attr("src")),b||g.css("visibility","hidden"),g},update:function(g,e){(!b||c.forcePlaceholderSize)&&(e.height()||e.height(a.currentItem.innerHeight()-parseInt(a.currentItem.css("paddingTop")||0,10)-parseInt(a.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(a.currentItem.innerWidth()-parseInt(a.currentItem.css("paddingLeft")||0,10)-parseInt(a.currentItem.css("paddingRight")||0,10)))}});
a.placeholder=l(c.placeholder.element.call(a.element,a.currentItem));a.currentItem.after(a.placeholder);c.placeholder.update(a,a.placeholder)},_contactContainers:function(a){var b,c,g,e,d,f,h,n,k,m=c=null;for(b=this.containers.length-1;0<=b;b--)if(!l.contains(this.currentItem[0],this.containers[b].element[0]))if(this._intersectsWith(this.containers[b].containerCache)){if(!c||!l.contains(this.containers[b].element[0],c.element[0]))c=this.containers[b],m=b}else this.containers[b].containerCache.over&&
(this.containers[b]._trigger("out",a,this._uiHash(this)),this.containers[b].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",a,this._uiHash(this)),this.containers[m].containerCache.over=1);else{b=1E4;g=null;e=(k=c.floating||u(this.currentItem))?"left":"top";d=k?"width":"height";f=this.positionAbs[e]+this.offset.click[e];for(c=this.items.length-1;0<=c;c--)l.contains(this.containers[m].element[0],this.items[c].item[0])&&
this.items[c].item[0]!==this.currentItem[0]&&(!k||this.positionAbs.top+this.offset.click.top>this.items[c].top&&this.items[c].top+this.items[c].height>this.positionAbs.top+this.offset.click.top)&&(h=this.items[c].item.offset()[e],n=!1,Math.abs(h-f)>Math.abs(h+this.items[c][d]-f)&&(n=!0,h+=this.items[c][d]),b>Math.abs(h-f)&&(b=Math.abs(h-f),g=this.items[c],this.direction=n?"up":"down"));if((g||this.options.dropOnEmpty)&&this.currentContainer!==this.containers[m])g?this._rearrange(a,g,null,!0):this._rearrange(a,
null,this.containers[m].element,!0),this._trigger("change",a,this._uiHash()),this.containers[m]._trigger("change",a,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",a,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(a){var b=this.options;a=l.isFunction(b.helper)?l(b.helper.apply(this.element[0],[a,this.currentItem])):"clone"===b.helper?this.currentItem.clone():
this.currentItem;return a.parents("body").length||l("parent"!==b.appendTo?b.appendTo:this.currentItem[0].parentNode)[0].appendChild(a[0]),a[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!a[0].style.width||b.forceHelperSize)&&a.width(this.currentItem.width()),(!a[0].style.height||b.forceHelperSize)&&a.height(this.currentItem.height()),
a},_adjustOffsetFromHelper:function(a){"string"==typeof a&&(a=a.split(" "));l.isArray(a)&&(a={left:+a[0],top:+a[1]||0});"left"in a&&(this.offset.click.left=a.left+this.margins.left);"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left);"top"in a&&(this.offset.click.top=a.top+this.margins.top);"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();
var a=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&l.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&l.ui.ie)&&(a={top:0,left:0}),{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a,b,c,g=this.options;"parent"===g.containment&&(g.containment=this.helper[0].parentNode);("document"===g.containment||"window"===g.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,l("document"===g.containment?document:window).width()-this.helperProportions.width-this.margins.left,(l("document"===g.containment?document:
window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]);/^(document|window|parent)$/.test(g.containment)||(a=l(g.containment)[0],b=l(g.containment).offset(),c="hidden"!==l(a).css("overflow"),this.containment=[b.left+(parseInt(l(a).css("borderLeftWidth"),10)||0)+(parseInt(l(a).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(l(a).css("borderTopWidth"),10)||0)+(parseInt(l(a).css("paddingTop"),10)||0)-this.margins.top,b.left+(c?Math.max(a.scrollWidth,
a.offsetWidth):a.offsetWidth)-(parseInt(l(a).css("borderLeftWidth"),10)||0)-(parseInt(l(a).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(c?Math.max(a.scrollHeight,a.offsetHeight):a.offsetHeight)-(parseInt(l(a).css("borderTopWidth"),10)||0)-(parseInt(l(a).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,g="absolute"!==this.cssPosition||this.scrollParent[0]!==
document&&l.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(g[0].tagName);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():e?0:g.scrollTop())*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():e?0:g.scrollLeft())*c}},_generatePosition:function(a){var b,c,g=this.options,e=a.pageX,d=a.pageY,
f="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&l.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(f[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(e=this.containment[0]+this.offset.click.left),a.pageY-
this.offset.click.top<this.containment[1]&&(d=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(e=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(d=this.containment[3]+this.offset.click.top)),g.grid&&(b=this.originalPageY+Math.round((d-this.originalPageY)/g.grid[1])*g.grid[1],d=this.containment?b-this.offset.click.top>=this.containment[1]&&b-this.offset.click.top<=this.containment[3]?b:b-this.offset.click.top>=
this.containment[1]?b-g.grid[1]:b+g.grid[1]:b,c=this.originalPageX+Math.round((e-this.originalPageX)/g.grid[0])*g.grid[0],e=this.containment?c-this.offset.click.left>=this.containment[0]&&c-this.offset.click.left<=this.containment[2]?c:c-this.offset.click.left>=this.containment[0]?c-g.grid[0]:c+g.grid[0]:c)),{top:d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:f.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-
this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:f.scrollLeft())}},_rearrange:function(a,b,c,g){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling);var e=this.counter=this.counter?++this.counter:1;this._delay(function(){e===this.counter&&this.refreshPositions(!g)})},_clear:function(a,b){this.reverting=!1;var c,g=[];if(!this._noFinalSort&&this.currentItem.parent().length&&
this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(c in this._storedCSS)("auto"===this._storedCSS[c]||"static"===this._storedCSS[c])&&(this._storedCSS[c]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!b&&g.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&
this.domPosition.parent===this.currentItem.parent()[0]||b||g.push(function(a){this._trigger("update",a,this._uiHash())});this!==this.currentContainer&&(b||(g.push(function(a){this._trigger("remove",a,this._uiHash())}),g.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),g.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer))));for(c=this.containers.length-1;0<=c;c--)b||g.push(function(a){return function(b){a._trigger("deactivate",
b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over&&(g.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?
"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){this._trigger("beforeStop",a,this._uiHash());for(c=0;g.length>c;c++)g[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(c=0;g.length>c;c++)g[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=
!1,!0},_trigger:function(){!1===l.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(a){var b=a||this;return{helper:b.helper,placeholder:b.placeholder||l([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:a?a.element:null}}});var t=jQuery;t.widget("ui.slider",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,
change:null,slide:null,start:null,stop:null},_create:function(){this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var a,
b;a=this.options;var c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),g=[];b=a.values&&a.values.length||1;c.length>b&&(c.slice(b).remove(),c=c.slice(0,b));for(a=c.length;b>a;a++)g.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=c.add(t(g.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(a){t(this).data("ui-slider-handle-index",a)})},_createRange:function(){var a=this.options,
b="";a.range?(!0===a.range&&(a.values?a.values.length&&2!==a.values.length?a.values=[a.values[0],a.values[0]]:t.isArray(a.values)&&(a.values=a.values.slice(0)):a.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),b="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(b+("min"===a.range||"max"===a.range?" ui-slider-range-"+
a.range:""))):this.range=t([])},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a);this._on(a,this._handleEvents);this._hoverable(a);this._focusable(a)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(a){var b,c,g,e,d,f,h,n,m=this,k=this.options;return k.disabled?!1:(this.elementSize={width:this.element.outerWidth(),
height:this.element.outerHeight()},this.elementOffset=this.element.offset(),b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b),g=this._valueMax()-this._valueMin()+1,this.handles.each(function(a){var b=Math.abs(c-m.values(a));(g>b||g===b&&(a===m._lastChangedValue||m.values(a)===k.min))&&(g=b,e=t(this),d=a)}),f=this._start(a,d),!1===f?!1:(this._mouseSliding=!0,this._handleIndex=d,e.addClass("ui-state-active").focus(),h=e.offset(),n=!t(a.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=
n?{left:0,top:0}:{left:a.pageX-h.left-e.width()/2,top:a.pageY-h.top-e.height()/2-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(a,d,c),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b=this._normValueFromMouse({x:a.pageX,y:a.pageY});return this._slide(a,this._handleIndex,b),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),
this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,g,e,d;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-
(this._clickOffset?this._clickOffset.top:0)),g=c/b,1<g&&(g=1),0>g&&(g=0),"vertical"===this.orientation&&(g=1-g),e=this._valueMax()-this._valueMin(),d=this._valueMin()+g*e,this._trimAlignValue(d)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var g,e,d;this.options.values&&this.options.values.length?(g=this.values(b?0:1),
2===this.options.values.length&&!0===this.options.range&&(0===b&&c>g||1===b&&g>c)&&(c=g),c!==this.values(b)&&(e=this.values(),e[b]=c,d=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),this.values(b?0:1),!1!==d&&this.values(b,c,!0))):c!==this.value()&&(d=this._trigger("slide",a,{handle:this.handles[b],value:c}),!1!==d&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=
this.values());this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._lastChangedValue=b;this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(a,b){var c,g,e;if(1<arguments.length)return this.options.values[a]=
this._trimAlignValue(b),this._refreshValue(),this._change(null,a),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(a):this.value();c=this.options.values;g=arguments[0];for(e=0;c.length>e;e+=1)c[e]=this._trimAlignValue(g[e]),this._change(null,e);this._refreshValue()},_setOption:function(a,b){var c,g=0;switch("range"===a&&!0===this.options.range&&("min"===b?(this.options.value=this._values(0),this.options.values=
null):"max"===b&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(g=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),a){case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;
case "values":this._animateOff=!0;this._refreshValue();for(c=0;g>c;c+=1)this._change(null,c);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0;this._refreshValue();this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(a){var b,c;if(arguments.length)return b=this.options.values[a],this._trimAlignValue(b);if(this.options.values&&this.options.values.length){b=
this.options.values.slice();for(c=0;b.length>c;c+=1)b[c]=this._trimAlignValue(b[c]);return b}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=0<this.options.step?this.options.step:1,c=(a-this._valueMin())%b;a-=c;return 2*Math.abs(c)>=b&&(a+=0<c?b:-b),parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var a,b,c,g,e,d=this.options.range,
f=this.options,h=this,n=this._animateOff?!1:f.animate,m={};this.options.values&&this.options.values.length?this.handles.each(function(c){b=100*((h.values(c)-h._valueMin())/(h._valueMax()-h._valueMin()));m["horizontal"===h.orientation?"left":"bottom"]=b+"%";t(this).stop(1,1)[n?"animate":"css"](m,f.animate);!0===h.options.range&&("horizontal"===h.orientation?(0===c&&h.range.stop(1,1)[n?"animate":"css"]({left:b+"%"},f.animate),1===c&&h.range[n?"animate":"css"]({width:b-a+"%"},{queue:!1,duration:f.animate})):
(0===c&&h.range.stop(1,1)[n?"animate":"css"]({bottom:b+"%"},f.animate),1===c&&h.range[n?"animate":"css"]({height:b-a+"%"},{queue:!1,duration:f.animate})));a=b}):(c=this.value(),g=this._valueMin(),e=this._valueMax(),b=e!==g?100*((c-g)/(e-g)):0,m["horizontal"===this.orientation?"left":"bottom"]=b+"%",this.handle.stop(1,1)[n?"animate":"css"](m,f.animate),"min"===d&&"horizontal"===this.orientation&&this.range.stop(1,1)[n?"animate":"css"]({width:b+"%"},f.animate),"max"===d&&"horizontal"===this.orientation&&
this.range[n?"animate":"css"]({width:100-b+"%"},{queue:!1,duration:f.animate}),"min"===d&&"vertical"===this.orientation&&this.range.stop(1,1)[n?"animate":"css"]({height:b+"%"},f.animate),"max"===d&&"vertical"===this.orientation&&this.range[n?"animate":"css"]({height:100-b+"%"},{queue:!1,duration:f.animate}))},_handleEvents:{keydown:function(a){var b,c,g,e=t(a.target).data("ui-slider-handle-index");switch(a.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(a.preventDefault(),
!this._keySliding&&(this._keySliding=!0,t(a.target).addClass("ui-state-active"),b=this._start(a,e),!1===b))return}switch(g=this.options.step,b=c=this.options.values&&this.options.values.length?this.values(e):this.value(),a.keyCode){case t.ui.keyCode.HOME:c=this._valueMin();break;case t.ui.keyCode.END:c=this._valueMax();break;case t.ui.keyCode.PAGE_UP:c=this._trimAlignValue(b+(this._valueMax()-this._valueMin())/5);break;case t.ui.keyCode.PAGE_DOWN:c=this._trimAlignValue(b-(this._valueMax()-this._valueMin())/
5);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(b===this._valueMax())return;c=this._trimAlignValue(b+g);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(b===this._valueMin())return;c=this._trimAlignValue(b-g)}this._slide(a,e,c)},click:function(a){a.preventDefault()},keyup:function(a){var b=t(a.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(a,b),this._change(a,b),t(a.target).removeClass("ui-state-active"))}}})});(function(d,j,a){j=a.createElement("div");"draggable"in j||"ondragstart"in j&&"ondrop"in j?d.Loader.addComponent(function(a){var c,d=a();a.fn.html5sortable=function(e){var g=String(e);e=a.extend({connectWith:!1},e);return this.each(function(){if(/^enable|disable|destroy$/.test(g)){var h=a(this).children(a(this).data("items")).attr("draggable","enable"==g);"destroy"==g&&h.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s")}else{var m,
k,h=a(this).children(e.items),p=a("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">');h.find(e.handle).mousedown(function(){m=!0}).mouseup(function(){m=!1});a(this).data("items",e.items);d=d.add(p);e.connectWith&&a(e.connectWith).add(this).data("connectWith",e.connectWith);h.attr("draggable","true").on("dragstart.h5s",function(g){if(e.handle&&!m)return!1;m=!1;g=g.originalEvent.dataTransfer;g.effectAllowed="move";g.setData("Text","dummy");k=(c=a(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",
function(){c&&(c.removeClass("sortable-dragging").show(),d.detach(),k!=c.index()&&c.parent().trigger("sortupdate",{item:c}),c=null)}).not("a[href], img").on("selectstart.h5s",function(){this.dragDrop&&this.dragDrop();return!1}).end().add([this,p]).on("dragover.h5s dragenter.h5s drop.h5s",function(g){if(!h.is(c)&&e.connectWith!==a(c).parent().data("connectWith"))return!0;if("drop"==g.type)return g.stopPropagation(),d.filter(":visible").after(c),c.trigger("dragend.h5s"),!1;g.preventDefault();g.originalEvent.dataTransfer.dropEffect=
"move";h.is(this)?(e.forcePlaceholderSize&&p.height(c.outerHeight()),c.hide(),a(this)[p.index()<a(this).index()?"after":"before"](p),d.not(p).detach()):!d.is(this)&&!a(this).children(e.items).length&&(d.detach(),a(this).append(p));return!1})}})}}):$.fn.html5sortable=function(a){return this.sortable(a)}})(JCSDL,window,document);JCSDL.Loader.addComponent(function(d){function j(a,b){if(!(1<a.originalEvent.touches.length)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);a.target.dispatchEvent(d)}}d.support.touch="ontouchend"in document;if(d.support.touch){var a=d.ui.mouse.prototype,b=a._mouseInit,c;a._touchStart=function(a){!c&&this._mouseCapture(a.originalEvent.changedTouches[0])&&
(c=!0,this._touchMoved=!1,j(a,"mouseover"),j(a,"mousemove"),j(a,"mousedown"))};a._touchMove=function(a){c&&(this._touchMoved=!0,j(a,"mousemove"))};a._touchEnd=function(a){c&&(j(a,"mouseup"),j(a,"mouseout"),this._touchMoved||j(a,"click"),c=!1)};a._mouseInit=function(){this.element.bind("touchstart",d.proxy(this,"_touchStart")).bind("touchmove",d.proxy(this,"_touchMove")).bind("touchend",d.proxy(this,"_touchEnd"));b.call(this)}}});JCSDL.Loader.addComponent(function(d){function j(a){if(a.attr("title")||"string"!=typeof a.attr("original-title"))a.attr("original-title",a.attr("title")||"").removeAttr("title")}function a(a,c){this.$element=d(a);this.options=c;this.enabled=!0;j(this.$element)}a.prototype={show:function(){var a=this.getTitle();if(a&&this.enabled){var c=this.tip();c.find(".tipsy-inner")[this.options.html?"html":"text"](a);c[0].className="tipsy";c.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);
var a=d.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),f=c[0].offsetWidth,e=c[0].offsetHeight,g="function"==typeof this.options.gravity?this.options.gravity.call(this.$element[0]):this.options.gravity,h;switch(g.charAt(0)){case "n":h={top:a.top+a.height+this.options.offset,left:a.left+a.width/2-f/2};break;case "s":h={top:a.top-e-this.options.offset,left:a.left+a.width/2-f/2};break;case "e":h={top:a.top+a.height/2-e/2,left:a.left-f-this.options.offset};
break;case "w":h={top:a.top+a.height/2-e/2,left:a.left+a.width+this.options.offset}}2==g.length&&(h.left="w"==g.charAt(1)?a.left+a.width/2-15:a.left+a.width/2-f+15);c.css(h).addClass("tipsy-"+g);this.options.fade?c.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):c.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){d(this).remove()}):this.tip().remove()},getTitle:function(){var a,
c=this.$element,d=this.options;j(c);d=this.options;"string"==typeof d.title?a=c.attr("title"==d.title?"original-title":d.title):"function"==typeof d.title&&(a=d.title.call(c[0]));return(a=(""+a).replace(/(^\s*|\s*$)/,""))||d.fallback},tip:function(){this.$tip||(this.$tip=d('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"/></div>'));return this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.options=this.$element=null)},enable:function(){this.enabled=
!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}};d.fn.tipsy=function(b){function c(c){var g=d.data(c,"tipsy");g||(g=new a(c,d.fn.tipsy.elementOptions(c,b)),d.data(c,"tipsy",g));return g}function f(){var a=c(this);a.hoverState="in";0==b.delayIn?a.show():setTimeout(function(){"in"==a.hoverState&&a.show()},b.delayIn)}function e(){var a=c(this);a.hoverState="out";0==b.delayOut?a.hide():setTimeout(function(){"out"==a.hoverState&&a.hide()},b.delayOut)}if(!0===
b)return this.data("tipsy");if("string"==typeof b)return this.data("tipsy")[b]();b=d.extend({},d.fn.tipsy.defaults,b);b.live||this.each(function(){c(this)});if("manual"!=b.trigger){var g=b.live?"live":"bind",h="hover"==b.trigger?"mouseleave":"blur";this[g]("hover"==b.trigger?"mouseenter":"focus",f)[g](h,e)}return this};d.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:0.8,title:"title",trigger:"hover"};d.fn.tipsy.elementOptions=function(a,c){return d.metadata?
d.extend({},c,d(a).metadata()):c};d.fn.tipsy.autoNS=function(){return d(this).offset().top>d(document).scrollTop()+d(window).height()/2?"s":"n"};d.fn.tipsy.autoWE=function(){return d(this).offset().left>d(document).scrollLeft()+d(window).width()/2?"e":"w"}});JCSDL.Loader.addComponent(function(d){d.fn.extend({simulate:function(j,a){return this.each(function(){var b=d.extend({},d.simulate.defaults,a||{});new d.simulate(this,j,b)})}});d.simulate=function(d,a,b){this.target=d;this.options=b;/^drag$/.test(a)?this[a].apply(this,[this.target,b]):this.simulateEvent(d,a,b)};d.extend(d.simulate.prototype,{simulateEvent:function(d,a,b){var c=this.createEvent(a,b);this.dispatchEvent(d,a,c,b);return c},createEvent:function(d,a){if(/^mouse(over|out|down|up|move)|(dbl)?click$/.test(d))return this.mouseEvent(d,
a);if(/^key(up|down|press)$/.test(d))return this.keyboardEvent(d,a)},mouseEvent:function(j,a){var b,c=d.extend({bubbles:!0,cancelable:"mousemove"!=j,view:window,detail:0,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a);d(c.relatedTarget);d.isFunction(document.createEvent)?(b=document.createEvent("MouseEvents"),b.initMouseEvent(j,c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,
c.metaKey,c.button,c.relatedTarget||document.body.parentNode)):document.createEventObject&&(b=document.createEventObject(),d.extend(b,c),b.button={"0":1,1:4,2:2}[b.button]||b.button);return b},keyboardEvent:function(j,a){var b,c=d.extend({bubbles:!0,cancelable:!0,view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},a);if(d.isFunction(document.createEvent))try{b=document.createEvent("KeyEvents"),b.initKeyEvent(j,c.bubbles,c.cancelable,c.view,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,
c.keyCode,c.charCode)}catch(f){b=document.createEvent("Events"),b.initEvent(j,c.bubbles,c.cancelable),d.extend(b,{view:c.view,ctrlKey:c.ctrlKey,altKey:c.altKey,shiftKey:c.shiftKey,metaKey:c.metaKey,keyCode:c.keyCode,charCode:c.charCode})}else document.createEventObject&&(b=document.createEventObject(),d.extend(b,c));d("html").is(".msie")&&(b.keyCode=0<c.charCode?c.charCode:c.keyCode,b.charCode=void 0);return b},dispatchEvent:function(d,a,b){d.dispatchEvent?d.dispatchEvent(b):d.fireEvent&&d.fireEvent("on"+
a,b);return b},drag:function(){var d=this.findCenter(this.target),a=this.options,b=Math.floor(d.x),d=Math.floor(d.y),c=a.dx||0,a=a.dy||0,f=this.target,e={clientX:b,clientY:d};this.simulateEvent(f,"mousedown",e);e={clientX:b+1,clientY:d+1};this.simulateEvent(document,"mousemove",e);e={clientX:b+c,clientY:d+a};this.simulateEvent(document,"mousemove",e);this.simulateEvent(document,"mousemove",e);this.simulateEvent(f,"mouseup",e)},findCenter:function(j){j=d(this.target);var a=j.offset();return{x:a.left+
j.outerWidth()/2,y:a.top+j.outerHeight()/2}}});d.extend(d.simulate,{defaults:{speed:"sync"},VK_TAB:9,VK_ENTER:13,VK_ESC:27,VK_PGUP:33,VK_PGDN:34,VK_END:35,VK_HOME:36,VK_LEFT:37,VK_UP:38,VK_RIGHT:39,VK_DOWN:40})});(function(){var d=function(a,b){var c=a.style[b];a.currentStyle?c=a.currentStyle[b]:window.getComputedStyle&&(c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b));if("auto"==c&&"cursor"==b)for(var g=["a"],e=0;e<g.length;e++)if(a.tagName.toLowerCase()==g[e])return"pointer";return c},j=function(a){if(h.prototype._singleton){a||(a=window.event);var b;this!==window?b=this:a.target?b=a.target:a.srcElement&&(b=a.srcElement);h.prototype._singleton.setCurrent(b)}},a=function(a,b){if(a.addClass)return a.addClass(b),
a;if(b&&"string"===typeof b){var c=(b||"").split(/\s+/);if(1===a.nodeType)if(a.className){for(var g=" "+a.className+" ",e=a.className,d=0,f=c.length;d<f;d++)0>g.indexOf(" "+c[d]+" ")&&(e+=" "+c[d]);a.className=e.replace(/^\s+|\s+$/g,"")}else a.className=b}return a},b=function(a,b){if(a.removeClass)return a.removeClass(b),a;if(b&&"string"===typeof b||void 0===b){var c=(b||"").split(/\s+/);if(1===a.nodeType&&a.className)if(b){for(var g=(" "+a.className+" ").replace(/[\n\t]/g," "),e=0,d=c.length;e<d;e++)g=
g.replace(" "+c[e]+" "," ");a.className=g.replace(/^\s+|\s+$/g,"")}else a.className=""}return a},c=function(a){return(0<=a.indexOf("?")?"&":"?")+"nocache="+(new Date).getTime()},f=function(a){var b=[];a.trustedDomains&&("string"===typeof a.trustedDomains?b.push("trustedDomain="+a.trustedDomains):b.push("trustedDomain="+a.trustedDomains.join(",")));return b.join("&")},e=function(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,g=b.length;c<g;c++)if(b[c]===a)return c;return-1},g=function(a){if("string"===
typeof a)throw new TypeError("ZeroClipboard doesn't accept query strings.");return!a.length?[a]:a},h=function(a,b){a&&(h.prototype._singleton||this).glue(a);if(h.prototype._singleton)return h.prototype._singleton;h.prototype._singleton=this;this.options={};for(var g in p)this.options[g]=p[g];for(var e in b)this.options[e]=b[e];this.handlers={};if(h.detectFlashSupport()){g=h.prototype._singleton;e=document.getElementById("global-zeroclipboard-html-bridge");if(!e){var d='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+
g.options.moviePath+c(g.options.moviePath)+'"/>         <param name="allowScriptAccess" value="'+g.options.allowScriptAccess+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+f(g.options)+'"/>         <embed src="'+g.options.moviePath+
c(g.options.moviePath)+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="always"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+f(g.options)+'"           scale="exactfit">         </embed>       </object>';
e=document.createElement("div");e.id="global-zeroclipboard-html-bridge";e.setAttribute("class","global-zeroclipboard-container");e.setAttribute("data-clipboard-ready",!1);e.style.position="absolute";e.style.left="-9999px";e.style.top="-9999px";e.style.width="15px";e.style.height="15px";e.style.zIndex="9999";e.innerHTML=d;document.body.appendChild(e)}g.htmlBridge=e;g.flashBridge=document["global-zeroclipboard-flash-bridge"]||e.children[0].lastElementChild}},m,k=[];h.prototype.setCurrent=function(a){m=
a;this.reposition();a.getAttribute("title")&&this.setTitle(a.getAttribute("title"));this.setHandCursor("pointer"==d(a,"cursor"))};h.prototype.setText=function(a){a&&""!==a&&(this.options.text=a,this.ready()&&this.flashBridge.setText(a))};h.prototype.setTitle=function(a){a&&""!==a&&this.htmlBridge.setAttribute("title",a)};h.prototype.setSize=function(a,b){this.ready()&&this.flashBridge.setSize(a,b)};h.prototype.setHandCursor=function(a){this.ready()&&this.flashBridge.setHandCursor(a)};h.version="1.1.7";
var p={moviePath:"ZeroClipboard.swf",trustedDomains:null,text:null,hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",allowScriptAccess:"sameDomain"};h.setDefaults=function(a){for(var b in a)p[b]=a[b]};h.destroy=function(){h.prototype._singleton.unglue(k);var a=h.prototype._singleton.htmlBridge;a.parentNode.removeChild(a);delete h.prototype._singleton};h.detectFlashSupport=function(){var a=!1;try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(a=!0)}catch(b){navigator.mimeTypes["application/x-shockwave-flash"]&&
(a=!0)}return a};h.prototype.resetBridge=function(){this.htmlBridge.style.left="-9999px";this.htmlBridge.style.top="-9999px";this.htmlBridge.removeAttribute("title");this.htmlBridge.removeAttribute("data-clipboard-text");b(m,this.options.activeClass);m=null;this.options.text=null};h.prototype.ready=function(){var a=this.htmlBridge.getAttribute("data-clipboard-ready");return"true"===a||!0===a};h.prototype.reposition=function(){if(!m)return!1;var a=m,b=0,c=0,g=a.width||a.offsetWidth||0,e=a.height||
a.offsetHeight||0,f=9999,h=d(a,"zIndex");for(h&&"auto"!=h&&(f=parseInt(h,10));a;)var h=parseInt(d(a,"borderLeftWidth"),10),k=parseInt(d(a,"borderTopWidth"),10),b=b+(isNaN(a.offsetLeft)?0:a.offsetLeft),b=b+(isNaN(h)?0:h),c=c+(isNaN(a.offsetTop)?0:a.offsetTop),c=c+(isNaN(k)?0:k),a=a.offsetParent;this.htmlBridge.style.top=c+"px";this.htmlBridge.style.left=b+"px";this.htmlBridge.style.width=g+"px";this.htmlBridge.style.height=e+"px";this.htmlBridge.style.zIndex=f+1;this.setSize(g,e)};h.dispatch=function(a,
b){h.prototype._singleton.receiveEvent(a,b)};h.prototype.on=function(a,b){for(var c=a.toString().split(/\s/g),g=0;g<c.length;g++)a=c[g].toLowerCase().replace(/^on/,""),this.handlers[a]||(this.handlers[a]=b);this.handlers.noflash&&!h.detectFlashSupport()&&this.receiveEvent("onNoFlash",null)};h.prototype.addEventListener=h.prototype.on;h.prototype.off=function(a,b){for(var c=a.toString().split(/\s/g),g=0;g<c.length;g++){a=c[g].toLowerCase().replace(/^on/,"");for(var e in this.handlers)e===a&&this.handlers[e]===
b&&delete this.handlers[e]}};h.prototype.removeEventListener=h.prototype.off;h.prototype.receiveEvent=function(c,g){c=c.toString().toLowerCase().replace(/^on/,"");var e=m;switch(c){case "load":if(g&&10>parseFloat(g.flashVersion.replace(",",".").replace(/[^0-9\.]/gi,""))){this.receiveEvent("onWrongFlash",{flashVersion:g.flashVersion});return}this.htmlBridge.setAttribute("data-clipboard-ready",!0);break;case "mouseover":a(e,this.options.hoverClass);break;case "mouseout":b(e,this.options.hoverClass);
this.resetBridge();break;case "mousedown":a(e,this.options.activeClass);break;case "mouseup":b(e,this.options.activeClass);break;case "datarequested":var d=e.getAttribute("data-clipboard-target");(d=(d=!d?null:document.getElementById(d))?d.value||d.textContent||d.innerText:e.getAttribute("data-clipboard-text"))&&this.setText(d);break;case "complete":this.options.text=null}this.handlers[c]&&(d=this.handlers[c],"function"==typeof d?d.call(e,this,g):"string"==typeof d&&window[d].call(e,this,g))};h.prototype.glue=
function(a){a=g(a);for(var b=0;b<a.length;b++)if(-1==e(a[b],k)){k.push(a[b]);var c=a[b],d=j;c.addEventListener?c.addEventListener("mouseover",d,!1):c.attachEvent&&c.attachEvent("onmouseover",d)}};h.prototype.unglue=function(a){a=g(a);for(var b=0;b<a.length;b++){var c=a[b],d=j;c.removeEventListener?c.removeEventListener("mouseover",d,!1):c.detachEvent&&c.detachEvent("onmouseover",d);c=e(a[b],k);-1!=c&&k.splice(c,1)}};"undefined"!==typeof module?module.exports=h:"function"===typeof define&&define.amd?
define(function(){return h}):window.ZeroClipboard=h})();!function(d){"function"==typeof define&&define.amd?define("picker",["jquery"],d):this.Picker=d(jQuery)}(function(d){function j(c,h,m,k){function p(){return j._.node("div",j._.node("div",j._.node("div",j._.node("div",r.component.nodes(l.open),t.box),t.wrap),t.frame),t.holder)}function n(a){a.stopPropagation();"focus"==a.type&&r.$root.addClass(t.focused);r.open()}if(!c)return j;var q=!1,l={id:c.id||"P"+Math.abs(~~(Math.random()*new Date))},u=m?d.extend(!0,{},m.defaults,k):k||{},t=d.extend({},j.klasses(),
u.klass),v=d(c);k=function(){return this.start()};var r=k.prototype={constructor:k,$node:v,start:function(){var a;if(l&&l.start)a=r;else{l.methods={};l.start=!0;l.open=!1;l.type=c.type;c.autofocus=c==document.activeElement;c.type="text";c.readOnly=!u.editable;c.id=c.id||l.id;r.component=new m(r,u);r.$root=d(j._.node("div",p(),t.picker,'id="'+c.id+'_root"'));r.$root.on({focusin:function(a){r.$root.removeClass(t.focused);a.stopPropagation()},"mousedown click":function(a){var b=a.target;b!=r.$root.children()[0]&&
(a.stopPropagation(),"mousedown"!=a.type||d(b).is(":input")||"OPTION"==b.nodeName||(a.preventDefault(),c.focus()))}}).on("click","[data-pick], [data-nav], [data-clear]",function(){var a=d(this),b=a.data(),a=a.hasClass(t.navDisabled)||a.hasClass(t.disabled),e=document.activeElement,e=e&&(e.type||e.href)&&e;(a||e&&!d.contains(r.$root[0],e))&&c.focus();b.nav&&!a?r.set("highlight",r.component.item.highlight,{nav:b.nav}):j._.isInteger(b.pick)&&!a?r.set("select",b.pick).close(!0):b.clear&&r.clear().close(!0)});
b(r.$root[0],"hidden",!0);if(u.formatSubmit){var e;!0===u.hiddenName?(a=c.name+"_hidden",e=c.name,c.name=""):(e=["string"==typeof u.hiddenPrefix?u.hiddenPrefix:"","string"==typeof u.hiddenSuffix?u.hiddenSuffix:"_submit"],e=a=e[0]+c.name+e[1]);r._hidden=d('<input type=hidden name="'+e+'"id="'+a+'"'+(v.data("value")||c.value?' value="'+r.get("select",u.formatSubmit)+'"':"")+">")[0];v.on("change."+l.id,function(){r._hidden.value=c.value?r.get("select",u.formatSubmit):""}).after(r._hidden)}v.data(h,r).addClass(t.input).val(v.data("value")?
r.get("select",u.format):c.value).on("focus."+l.id+" click."+l.id,n);u.editable||v.on("keydown."+l.id,function(a){var b=a.keyCode,c=/^(8|46)$/.test(b);return 27==b?(r.close(),!1):void((32==b||c||!l.open&&r.component.key[b])&&(a.preventDefault(),a.stopPropagation(),c?r.clear().close():r.open()))});b(c,{haspopup:!0,expanded:!1,readonly:!1,owns:c.id+"_root"+(r._hidden?" "+r._hidden.id:"")});u.container?d(u.container).append(r.$root):v.after(r.$root);r.on({start:r.component.onStart,render:r.component.onRender,
stop:r.component.onStop,open:r.component.onOpen,close:r.component.onClose,set:r.component.onSet}).on({start:u.onStart,render:u.onRender,stop:u.onStop,open:u.onOpen,close:u.onClose,set:u.onSet});a=r.$root.children()[0];var f;a=(q=(a.currentStyle?f=a.currentStyle.position:window.getComputedStyle&&(f=getComputedStyle(a).position),"fixed"==f),c.autofocus&&r.open(),r.trigger("start").trigger("render"))}return a},render:function(a){return a?r.$root.html(p()):r.$root.find("."+t.box).html(r.component.nodes(l.open)),
r.trigger("render")},stop:function(){return l.start?(r.close(),r._hidden&&r._hidden.parentNode.removeChild(r._hidden),r.$root.remove(),v.removeClass(t.input).removeData(h),setTimeout(function(){v.off("."+l.id)},0),c.type=l.type,c.readOnly=!1,r.trigger("stop"),l.methods={},l.start=!1,r):r},open:function(h){return l.open?r:(v.addClass(t.active),b(c,"expanded",!0),setTimeout(function(){r.$root.addClass(t.opened);b(r.$root[0],"hidden",!1)},0),!1!==h&&(l.open=!0,q&&e.css("overflow","hidden").css("padding-right",
"+="+a()),v.trigger("focus"),f.on("click."+l.id+" focusin."+l.id,function(a){var b=a.target;b!=c&&b!=document&&3!=a.which&&r.close(b===r.$root.children()[0])}).on("keydown."+l.id,function(a){var b=a.keyCode,e=r.component.key[b],f=a.target;27==b?r.close(!0):f!=c||!e&&13!=b?d.contains(r.$root[0],f)&&13==b&&(a.preventDefault(),f.click()):(a.preventDefault(),e?j._.trigger(r.component.key.go,r,[j._.trigger(e)]):r.$root.find("."+t.highlighted).hasClass(t.disabled)||r.set("select",r.component.item.highlight).close())})),
r.trigger("open"))},close:function(d){return d&&(v.off("focus."+l.id).trigger("focus"),setTimeout(function(){v.on("focus."+l.id,n)},0)),v.removeClass(t.active),b(c,"expanded",!1),setTimeout(function(){r.$root.removeClass(t.opened+" "+t.focused);b(r.$root[0],"hidden",!0)},0),l.open?(l.open=!1,q&&e.css("overflow","").css("padding-right","-="+a()),f.off("."+l.id),r.trigger("close")):r},clear:function(){return r.set("clear")},set:function(a,b,c){var g,e=d.isPlainObject(a),f=e?a:{};if(c=e&&d.isPlainObject(b)?
b:c||{},a){e||(f[a]=b);for(g in f)a=f[g],g in r.component.item&&(void 0===a&&(a=null),r.component.set(g,a,c)),("select"==g||"clear"==g)&&v.val("clear"==g?"":r.get(g,u.format)).trigger("change");r.render()}return c.muted?r:r.trigger("set",f)},get:function(a,b){if(a=a||"value",null!=l[a])return l[a];if("value"==a)return c.value;if(a in r.component.item){if("string"==typeof b){var e=r.component.get(a);return e?j._.trigger(r.component.formats.toString,r.component,[b,e]):""}return r.component.get(a)}},
on:function(a,b){var c,g,e=(g=d.isPlainObject(a))?a:{};if(a)for(c in g||(e[a]=b),e)g=e[c],l.methods[c]=l.methods[c]||[],l.methods[c].push(g);return r},off:function(){var a,b,c=arguments;a=0;for(namesCount=c.length;namesCount>a;a+=1)b=c[a],b in l.methods&&delete l.methods[b];return r},trigger:function(a,b){var c=l.methods[a];return c&&c.map(function(a){j._.trigger(a,r,[b])}),r}};return new k}function a(){if(e.height()<=c.height())return 0;var a=d('<div style="visibility:hidden;width:100px" />').appendTo("body"),
b=a[0].offsetWidth;a.css("overflow","scroll");var f=d('<div style="width:100%" />').appendTo(a)[0].offsetWidth;return a.remove(),b-f}function b(a,b,c){if(d.isPlainObject(b))for(var e in b)a.setAttribute(("role"==e?"":"aria-")+e,b[e]);else a.setAttribute(("role"==b?"":"aria-")+b,c)}var c=d(window),f=d(document),e=d(document.documentElement);return j.klasses=function(a){return a=a||"picker",{picker:a,opened:a+"--opened",focused:a+"--focused",input:a+"__input",active:a+"__input--active",holder:a+"__holder",
frame:a+"__frame",wrap:a+"__wrap",box:a+"__box"}},j._={group:function(a){for(var b,c="",e=j._.trigger(a.min,a);e<=j._.trigger(a.max,a,[e]);e+=a.i)b=j._.trigger(a.item,a,[e]),c+=j._.node(a.node,b[0],b[1],b[2]);return c},node:function(a,b,c,e){return b?(b=d.isArray(b)?b.join(""):b,c=c?' class="'+c+'"':"",e=e?" "+e:"","<"+a+c+e+">"+b+"</"+a+">"):""},lead:function(a){return(10>a?"0":"")+a},trigger:function(a,b,c){return"function"==typeof a?a.apply(b,c||[]):a},digits:function(a){return/\d/.test(a[1])?
2:1},isDate:function(a){return-1<{}.toString.call(a).indexOf("Date")&&this.isInteger(a.getDate())},isInteger:function(a){return-1<{}.toString.call(a).indexOf("Number")&&0===a%1},ariaAttr:function(a,b){d.isPlainObject(a)||(a={attribute:b});b="";for(var c in a){var e=("role"==c?"":"aria-")+c;b+=null==a[c]?"":e+'="'+a[c]+'"'}return b}},j.extend=function(a,b){d.fn[a]=function(c,e){var f=this.data(a);return"picker"==c?f:f&&"string"==typeof c?j._.trigger(f[c],f,[e]):this.each(function(){d(this).data(a)||
new j(this,a,b,c)})};d.fn[a].defaults=b.defaults},j});!function(d){"function"==typeof define&&define.amd?define(["picker","jquery"],d):d(Picker,jQuery)}(function(d,j){function a(a,b){var c=this,d=a.$node[0].value,f=a.$node.data("value"),d=f||d,f=f?b.formatSubmit:b.format;c.settings=b;c.$node=a.$node;c.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"};c.item={};c.item.clear=null;c.item.disable=
(b.disable||[]).slice(0);c.item.enable=-(!0===c.item.disable[0]?c.item.disable.shift():-1);c.set("min",b.min).set("max",b.max).set("now");d?c.set("select",d,{format:f}):c.set("select",null).set("highlight",c.item.now);c.key={40:7,38:-7,39:function(){return"rtl"===getComputedStyle(a.$root[0]).direction?-1:1},37:function(){return"rtl"===getComputedStyle(a.$root[0]).direction?1:-1},go:function(a){var b=c.item.highlight,b=new Date(b.year,b.month,b.date+a);c.set("highlight",[b.getFullYear(),b.getMonth(),
b.getDate()],{interval:a});this.render()}};a.on("render",function(){a.$root.find("."+b.klass.selectMonth).on("change",function(){var c=this.value;c&&(a.set("highlight",[a.get("view").year,c,a.get("highlight").date]),a.$root.find("."+b.klass.selectMonth).trigger("focus"))});a.$root.find("."+b.klass.selectYear).on("change",function(){var c=this.value;c&&(a.set("highlight",[c,a.get("view").month,a.get("highlight").date]),a.$root.find("."+b.klass.selectYear).trigger("focus"))})}).on("open",function(){a.$root.find("button, select").attr("disabled",
!1)}).on("close",function(){a.$root.find("button, select").attr("disabled",!0)})}var b=d._;a.prototype.set=function(a,b,c){var d=this,f=d.item;return null===b?("clear"==a&&(a="select"),f[a]=b,d):(f["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(f){return b=d[f](a,b,c)}).pop(),"select"==a?d.set("highlight",f.select,c):"highlight"==a?d.set("view",f.highlight,c):a.match(/^(flip|min|max|disable|enable)$/)&&(f.select&&d.disabled(f.select)&&d.set("select",f.select,c),f.highlight&&
d.disabled(f.highlight)&&d.set("highlight",f.highlight,c)),d)};a.prototype.get=function(a){return this.item[a]};a.prototype.create=function(a,c,d){var f;return c=void 0===c?a:c,c==-1/0||1/0==c?f=c:j.isPlainObject(c)&&b.isInteger(c.pick)?c=c.obj:j.isArray(c)?(c=new Date(c[0],c[1],c[2]),c=b.isDate(c)?c:this.create().obj):c=b.isInteger(c)||b.isDate(c)?this.normalize(new Date(c),d):this.now(a,c,d),{year:f||c.getFullYear(),month:f||c.getMonth(),date:f||c.getDate(),day:f||c.getDay(),obj:f||c,pick:f||c.getTime()}};
a.prototype.createRange=function(a,c){var d=this,f=function(a){return!0===a||j.isArray(a)||b.isDate(a)?d.create(a):a};return b.isInteger(a)||(a=f(a)),b.isInteger(c)||(c=f(c)),b.isInteger(a)&&j.isPlainObject(c)?a=[c.year,c.month,c.date+a]:b.isInteger(c)&&j.isPlainObject(a)&&(c=[a.year,a.month,a.date+c]),{from:f(a),to:f(c)}};a.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick};a.prototype.overlapRanges=function(a,b){return a=this.createRange(a.from,
a.to),b=this.createRange(b.from,b.to),this.withinRange(a,b.from)||this.withinRange(a,b.to)||this.withinRange(b,a.from)||this.withinRange(b,a.to)};a.prototype.now=function(a,b,c){return b=new Date,c&&c.rel&&b.setDate(b.getDate()+c.rel),this.normalize(b,c)};a.prototype.navigate=function(a,b,c){var d,f,p;a=j.isArray(b);var n=j.isPlainObject(b),q=this.item.view;if(a||n){n?(d=b.year,f=b.month,p=b.date):(d=+b[0],f=+b[1],p=+b[2]);c&&c.nav&&q&&q.month!==f&&(d=q.year,f=q.month);b=new Date(d,f+(c&&c.nav?c.nav:
0),1);d=b.getFullYear();for(f=b.getMonth();(new Date(d,f,p)).getMonth()!==f;)p-=1;b=[d,f,p]}return b};a.prototype.normalize=function(a){return a.setHours(0,0,0,0),a};a.prototype.measure=function(a,c){return c?b.isInteger(c)&&(c=this.now(a,c,{rel:c})):c="min"==a?-1/0:1/0,c};a.prototype.viewset=function(a,b){return this.create([b.year,b.month,1])};a.prototype.validate=function(a,c,d){var f,k,p,n,q=this;a=c;var l=d&&d.interval?d.interval:1,u=-1===q.item.enable,t=q.item.min,v=q.item.max,r=u&&q.item.disable.filter(function(a){if(j.isArray(a)){var e=
q.create(a).pick;e<c.pick?f=!0:e>c.pick&&(k=!0)}return b.isInteger(a)}).length;if((!d||!d.nav)&&(!u&&q.disabled(c)||u&&q.disabled(c)&&(r||f||k)||!u&&(c.pick<=t.pick||c.pick>=v.pick)))for(u&&!r&&(!k&&0<l||!f&&0>l)&&(l*=-1);q.disabled(c)&&(1<Math.abs(l)&&(c.month<a.month||c.month>a.month)&&(c=a,l=0<l?1:-1),c.pick<=t.pick?(p=!0,l=1,c=q.create([t.year,t.month,t.date+(c.pick===t.pick?0:-1)])):c.pick>=v.pick&&(n=!0,l=-1,c=q.create([v.year,v.month,v.date+(c.pick===v.pick?0:1)])),!p||!n);)c=q.create([c.year,
c.month,c.date+l]);return c};a.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return b.isInteger(d)?a.day===(c.settings.firstDay?d:d-1)%7:j.isArray(d)||b.isDate(d)?a.pick===c.create(d).pick:j.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return j.isArray(a)&&"inverted"==a[3]||j.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick};a.prototype.parse=function(a,c,d){var f=
this,k={};return c&&"string"==typeof c?(d&&d.format||(d=d||{},d.format=f.settings.format),f.formats.toArray(d.format).map(function(a){var d=f.formats[a],e=d?b.trigger(d,f,[c,k]):a.replace(/^!/,"").length;d&&(k[a]=c.substr(0,e));c=c.substr(e)}),[k.yyyy||k.yy,+(k.mm||k.m)-1,k.dd||k.d]):c};var c=function(a,b,c){a=a.match(/\w+/)[0];return c.mm||c.m||(c.m=b.indexOf(a)+1),a.length};a.prototype.formats={d:function(a,c){return a?b.digits(a):c.date},dd:function(a,c){return a?2:b.lead(c.date)},ddd:function(a,
b){return a?a.match(/\w+/)[0].length:this.settings.weekdaysShort[b.day]},dddd:function(a,b){return a?a.match(/\w+/)[0].length:this.settings.weekdaysFull[b.day]},m:function(a,c){return a?b.digits(a):c.month+1},mm:function(a,c){return a?2:b.lead(c.month+1)},mmm:function(a,b){var d=this.settings.monthsShort;return a?c(a,d,b):d[b.month]},mmmm:function(a,b){var d=this.settings.monthsFull;return a?c(a,d,b):d[b.month]},yy:function(a,b){return a?2:(""+b.year).slice(2)},yyyy:function(a,b){return a?4:b.year},
toArray:function(a){return a.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(a,c){var d=this;return d.formats.toArray(a).map(function(a){return b.trigger(d.formats[a],d,[0,c])||a.replace(/^!/,"")}).join("")}};a.prototype.isDateExact=function(a,c){return b.isInteger(a)&&b.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(b.isDate(a)||j.isArray(a))&&(b.isDate(c)||j.isArray(c))?this.create(a).pick===this.create(c).pick:j.isPlainObject(a)&&j.isPlainObject(c)?this.isDateExact(a.from,
c.from)&&this.isDateExact(a.to,c.to):!1};a.prototype.isDateOverlap=function(a,c){var d=this.settings.firstDay?1:0;return b.isInteger(a)&&(b.isDate(c)||j.isArray(c))?(a=a%7+d,a===this.create(c).day+1):b.isInteger(c)&&(b.isDate(a)||j.isArray(a))?(c=c%7+d,c===this.create(a).day+1):j.isPlainObject(a)&&j.isPlainObject(c)?this.overlapRanges(a,c):!1};a.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1==b.enable?1:-1)};a.prototype.deactivate=function(a,c){var d=this,f=d.item.disable.slice(0);
return"flip"==c?d.flipEnable():!1===c?(d.flipEnable(1),f=[]):!0===c?(d.flipEnable(-1),f=[]):c.map(function(a){for(var c,e=0;e<f.length;e+=1)if(d.isDateExact(a,f[e])){c=!0;break}c||(b.isInteger(a)||b.isDate(a)||j.isArray(a)||j.isPlainObject(a)&&a.from&&a.to)&&f.push(a)}),f};a.prototype.activate=function(a,c){var d=this,f=d.item.disable,k=f.length;return"flip"==c?d.flipEnable():!0===c?(d.flipEnable(1),f=[]):!1===c?(d.flipEnable(-1),f=[]):c.map(function(a){var c,e,g,u;for(g=0;k>g;g+=1){if(e=f[g],d.isDateExact(e,
a)){c=f[g]=null;u=!0;break}if(d.isDateOverlap(e,a)){j.isPlainObject(a)?(a.inverted=!0,c=a):j.isArray(a)?(c=a,c[3]||c.push("inverted")):b.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(g=0;k>g;g+=1)if(d.isDateExact(f[g],a)){f[g]=null;break}if(u)for(g=0;k>g;g+=1)if(d.isDateOverlap(f[g],a)){f[g]=null;break}c&&f.push(c)}),f.filter(function(a){return null!=a})};a.prototype.nodes=function(a){var c=this,d=c.settings,f=c.item,k=f.now,p=f.select,n=f.highlight,q=f.view,
l=f.disable,j=f.min,t=f.max,v=(d.showWeekdaysFull?d.weekdaysFull:d.weekdaysShort).slice(0),r=d.weekdaysFull.slice(0),f=(d.firstDay&&(v.push(v.shift()),r.push(r.shift())),b.node("thead",b.node("tr",b.group({min:0,max:6,i:1,node:"th",item:function(a){return[v[a],d.klass.weekdays,'scope=col title="'+r[a]+'"']}})))),w=function(a){return b.node("div"," ",d.klass["nav"+(a?"Next":"Prev")]+(a&&q.year>=t.year&&q.month>=t.month||!a&&q.year<=j.year&&q.month<=j.month?" "+d.klass.navDisabled:""),"data-nav="+(a||
-1)+" "+b.ariaAttr({role:"button",controls:c.$node[0].id+"_table"})+' title="'+(a?d.labelMonthNext:d.labelMonthPrev)+'"')},A=function(){var f=d.showMonthsShort?d.monthsShort:d.monthsFull;return d.selectMonths?b.node("select",b.group({min:0,max:11,i:1,node:"option",item:function(a){return[f[a],0,"value="+a+(q.month==a?" selected":"")+(q.year==j.year&&a<j.month||q.year==t.year&&a>t.month?" disabled":"")]}}),d.klass.selectMonth,(a?"":"disabled")+" "+b.ariaAttr({controls:c.$node[0].id+"_table"})+' title="'+
d.labelMonthSelect+'"'):b.node("div",f[q.month],d.klass.month)},B=function(){var f=q.year,k=!0===d.selectYears?5:~~(d.selectYears/2);if(k){var p=j.year,n=t.year,m=f-k,k=f+k;if(p>m&&(k+=p-m,m=p),k>n)p=m-p,k-=n,m-=p>k?k:p,k=n;return b.node("select",b.group({min:m,max:k,i:1,node:"option",item:function(a){return[a,0,"value="+a+(f==a?" selected":"")]}}),d.klass.selectYear,(a?"":"disabled")+" "+b.ariaAttr({controls:c.$node[0].id+"_table"})+' title="'+d.labelYearSelect+'"')}return b.node("div",f,d.klass.year)};
return b.node("div",(d.selectYears?B()+A():A()+B())+w()+w(1),d.klass.header)+b.node("table",f+b.node("tbody",b.group({min:0,max:5,i:1,node:"tr",item:function(a){var e=d.firstDay&&0===c.create([q.year,q.month,1]).day?-7:0;return[b.group({min:7*a-q.day+e+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(a){a=c.create([q.year,q.month,a+(d.firstDay?1:0)]);var e=p&&p.pick==a.pick,f=n&&n.pick==a.pick,m=l&&c.disabled(a)||a.pick<j.pick||a.pick>t.pick;return[b.node("div",a.date,function(b){return b.push(q.month==
a.month?d.klass.infocus:d.klass.outfocus),k.pick==a.pick&&b.push(d.klass.now),e&&b.push(d.klass.selected),f&&b.push(d.klass.highlighted),m&&b.push(d.klass.disabled),b.join(" ")}([d.klass.day]),"data-pick="+a.pick+" "+b.ariaAttr({role:"gridcell",selected:e&&c.$node.val()===b.trigger(c.formats.toString,c,[d.format,a])?!0:null,activedescendant:f?!0:null,disabled:m?!0:null})),"",b.ariaAttr({role:"presentation"})]}})]}})),d.klass.table,'id="'+c.$node[0].id+'_table" '+b.ariaAttr({role:"grid",controls:c.$node[0].id,
readonly:!0}))+b.node("div",b.node("button",d.today,d.klass.buttonToday,"type=button data-pick="+k.pick+(a?"":" disabled")+" "+b.ariaAttr({controls:c.$node[0].id}))+b.node("button",d.clear,d.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+b.ariaAttr({controls:c.$node[0].id})),d.klass.footer)};var f=d.klasses().picker+"__";a.defaults={labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:"January February March April May June July August September October November December".split(" "),
monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdaysFull:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),today:"Today",clear:"Clear",format:"d mmmm, yyyy",klass:{table:f+"table",header:f+"header",navPrev:f+"nav--prev",navNext:f+"nav--next",navDisabled:f+"nav--disabled",month:f+"month",year:f+"year",selectMonth:f+"select--month",selectYear:f+"select--year",weekdays:f+"weekday",day:f+"day",disabled:f+
"day--disabled",selected:f+"day--selected",highlighted:f+"day--highlighted",now:f+"day--today",infocus:f+"day--infocus",outfocus:f+"day--outfocus",footer:f+"footer",buttonClear:f+"button--clear",buttonToday:f+"button--today"}};d.extend("pickadate",a)});JCSDL.Loader.addComponent(function(d,j){this.Parser=function(a){this.gui=a};this.Parser.prototype={v:"2.1",parseJCSDL:function(a){var b=a.split("\n"),c=b.shift();b.pop();if(!this.verifyJCSDL(c,b))throw new JCSDL.ValidationException("The given JCSDL did not verify!",a);a=b.shift().split(" ")[2];var c=c.split(" ")[3],d=[];for("//"!==b[0].substr(0,2)&&b.shift();1<b.length;){var e=b.shift(),g=b.shift();b.shift();b.shift();var e=e.split(" "),h=e[3],m=e[4]||d.length+1;if(!this.verifyJCSDLFilter(e[2],g))throw new JCSDL.ValidationException("The given JCSDL Filter code did not verify!",
g);e=this.filterFromJCSDL(h,g,m,a);d.push(e)}return{filters:d,logic:c}},filterFromJCSDL:function(a,b,c,f){f=f||this.v;f!==this.v&&(a=this.applyFilterJCSDLTransformers(a,f));a=a.split(",");f=a.shift().split(".");var e=f.shift(),g=this.getFieldInfo(e,f);if(!1===g)return!1;var h=a.shift(),m="",k={cs:!1};"exists"!==h&&(m=a.shift().split("-"),m=this.valueFromCSDL(g,b.substr(m[0],m[1]),h),d.each(a,function(a,b){switch(b){case "cs":k.cs=!0}}));return this.createFilter(e,f,h,m,k,c)},getJCSDLForFilters:function(a,
b){var c=this,f={},e=[],g="";d.each(a,function(a,b){var d=c.filterToCSDL(b);if(!d)return!0;f[b.id+""]=d});if("AND"!=b&&"OR"!=b){var g=this.tokenizeLogicString(b),h="";this.validateLogic(g,a);d.each(g,function(a,b){if("number"===typeof b)if(h.length&&e.push(d.trim(h)),h="",f[b+""]!==j)e.push(f[b+""]);else throw new JCSDL.LogicValidationException("A filter with ID '"+b+"' doesn't exist! You cannot use it in a logical expression",a);else h="&"==b||"|"==b?h+("|"==b?" OR ":" AND "):"!"===b?h+" NOT ":h+
b});h.length&&e.push(d.trim(h));g=e.join("\n")}else d.each(f,function(a,b){e.push(b)}),g=e.join("\n"+b+"\n");g="// JCSDL_VERSION "+this.v+"\n"+g;return g="// JCSDL_MASTER "+this.encodeJCSDL(g,b)+" "+b+"\n"+g+"\n// JCSDL_MASTER_END"},filterToCSDL:function(a){var b=this.getFieldInfo(a.target,a.fieldPath);if(!1===b)return!1;var c=this.valueToCSDL(a.value,b,a.operator);if(!1===c)return!1;var d=this.fieldToCSDL(a.fieldPath);if(!1===d)return!1;var e=this.getOperatorCode(a.operator);if(!1===e)return!1;var g=
a.cs?" cs":"",e=("augmentation"==a.target?"":a.target+".")+d.replace("-",".")+g+" "+e+" ",d=a.target+"."+d+","+a.operator;"exists"!==a.operator&&(g="string"==b.type||"geo"==b.type?e.length+1:e.length,b="string"==b.type||"geo"==b.type?c.length-2:c.length,e+=c,d+=","+g+"-"+b,a.cs&&(d+=",cs"));return[["// JCSDL_START",this.encodeJCSDLFilter(e),d,a.id].join(" "),e,"// JCSDL_END"].join("\n")},encodeJCSDL:function(a,b){return Crypto.MD5(b+"\n"+a)},verifyJCSDL:function(a,b){var c=b.join("\n"),d=a.split(" "),
e=d[2],c=this.encodeJCSDL(c,d[3]);return e==c},encodeJCSDLFilter:function(a){return Crypto.MD5(a)},verifyJCSDLFilter:function(a,b){return a==this.encodeJCSDLFilter(b)},fieldToCSDL:function(a){return a.join(".")},valueToCSDL:function(a,b,c){var f="";if("bool"==b.type)f=a;else if("int"==b.type||"float"==b.type){if("in"!==c&&isNaN(a))return this.error("This field value is suppose to be a Number, String given.",a,b),!1;"in"==c?(a=a.split(","),d.each(a,function(b,c){a[b]=parseInt(c)}),f="["+a.join(",")+
"]"):f=a}else b=0<=d.inArray(c,["regex_partial","regex_exact"])?!0:!1,f='"'+a.escapeCsdl(b)+'"';return f},valueFromCSDL:function(a,b,c){if("int"==a.type)return"in"==c&&(b=b.substr(1,b.length-2)),b;a=0<=d.inArray(c,["regex_partial","regex_exact"])?!0:!1;return b.unescapeCsdl(a)},tokenizeLogicString:function(a){a=(""+a).replace(/\s+/g,"");for(var b=[],c=!1,d=0;d<a.length;d++){var e=a.charAt(d);e.isNumeric()?(c?(b[b.length-1]+=""+e,b[b.length-1]=parseInt(b[b.length-1])):b.push(parseInt(e)),c=!0):(b.push(e),
c=!1)}return b},validateLogic:function(a,b){var c="string"===typeof a||"number"===typeof a?this.tokenizeLogicString(a):a;if(0<=d.inArray(c[0],["&","|"]))throw new JCSDL.LogicValidationException('Logical query cannot start with logical operator "'+c[0]+'"!',0);if(0<=d.inArray(c[c.length-1],["&","|","!"]))throw new JCSDL.LogicValidationException('Logical query cannot end with logical operator "'+c[c.length-1]+'"!',c.length-1);var f=null,e=[],g=0,h=[];b&&b.length&&d.each(b,function(a,b){h.push(parseInt(b.id))});
d.each(c,function(a,b){if("("==b&&")"==f)throw new JCSDL.LogicValidationException('You cannot use opening parenthesis "(" right after a closing parenthesis ")"!',a);if(")"==b&&"("==f)throw new JCSDL.LogicValidationException('You cannot use closing parenthesis ")" right after an opening parenthesis "("!',a);if(")"==b&&0<=d.inArray(f,["&","|","!"]))throw new JCSDL.LogicValidationException('You cannot use closing parenthesis ")" right after a logical operator!',a);if(0<=d.inArray(b,["&","|"])&&"("==
f)throw new JCSDL.LogicValidationException('You cannot use logical operator "'+b+'" ("'+("&"===b?"AND":"OR")+") right after opening brackets!",a);if("("==b&&"number"==typeof f)throw new JCSDL.LogicValidationException('You cannot open a parenthesis right after filter ID! You need to use a logical operator "&" ("AND") or "|" ("OR")!',a);if("number"==typeof b&&")"==f)throw new JCSDL.LogicValidationException('You cannot use filter ID right after closing a parenthesis! You need to use a logical operator "&" ("AND") or "|" ("OR")!',
a);if(0<=d.inArray(b,["&","|"])&&0<=d.inArray(f,["&","|"]))throw new JCSDL.LogicValidationException("You cannot use two logical operators next to each other!",a);if(0<=d.inArray(b,["&","|"])&&"!"===f)throw new JCSDL.LogicValidationException('You cannot use logical operator "!" ("NOT") in front of other logical operators!',a-1);if("!"===b&&"!"===f)throw new JCSDL.LogicValidationException('You cannot use two logical operators "!" ("NOT") right after each other!',a);if("number"==typeof b){if("number"==
typeof f)throw new JCSDL.LogicValidationException("Cannot use two filter ID's next to each other!",a);if(-1==d.inArray(b,h))throw new JCSDL.LogicValidationException('The filter ID "'+b+"\" doesn't exist! You can only use filters from the list of filters.",a);if(0<=d.inArray(b,e))throw new JCSDL.LogicValidationException('The filter with ID "'+b+'" has already been used in the logical expression! You can only use one filter once.',a);e.push(b)}if(0<=d.inArray(b,["(",")"])&&(g="("==b?g+1:g-1,0>g))throw new JCSDL.LogicValidationException("Parentheses do not create a logical expression, i.e. there are too many closing parenthesis that close a nested expression that was never opened!",
a);f=b});var m=[];d.each(h,function(a,b){-1==d.inArray(b,e)&&m.push(b)});if(m.length)throw new JCSDL.LogicValidationException("You haven't used some of the filters in your logical expression (with ID's: \""+m.join('", "')+'"). All filters need to be used!');if(0!==g)throw new JCSDL.LogicValidationException("You have't closed some parentheses!");return!0},error:function(a,b){this.gui.showError.apply(this.gui,arguments)},createFilter:function(a,b,c,d,e,g){e=e||{};return{id:g,target:a,fieldPath:b,operator:c,
value:d,cs:e.cs}},getOperatorCode:function(a){return this.gui.definition.operators[a].code},getTargetInfo:function(a){if(this.gui.definition.targets[a]!==j)return this.gui.definition.targets[a];this.error("Such target does not exist!",a);return!1},getFieldInfo:function(a,b){var c=this,f=this.gui.definition.targets[a];if(f===j)return this.error("Such target does not exist!",a),!1;d.each(b,function(d,g){if(f.fields!==j)if(f.fields[g]!==j)f=f.fields[g];else return c.error("Invalid path to a field (#1)!",
a,b,f),f=!1;else return c.error("Invalid path to a field (#2)!",a,b,f),f=!1});return f},transformers:[{from:"1.0",to:"2.0",filter:function(a){a=a.split(",");"augmentation.language-tag"===a[0]&&(a[0]="augmentation.language.tag");return a.join(",")}}],applyFilterJCSDLTransformers:function(a,b){var c=!1,f=a;d.each(this.transformers,function(d,g){if(c||g.from===b)c=!0,"function"===typeof g.filter&&(f=g.filter(a))});return f}};this.ValidationException=function(a,b){this.message=a;this.code=b};this.LogicValidationException=
function(a,b){this.message=a;this.index=b}});JCSDL.Loader.addComponent(function(d){this.GUITemplates={container:d('<div class="jcsdl-container" />'),editor:d('<div class="jcsdl-mainview"><div class="jcsdl-header"><div class="jcsdl-advanced-container jcsdl-bordered" style="display: none;"><div class="jcsdl-advanced-gui-container"><ul class="jcsdl-advanced-gui" /><a href="#" class="jcsdl-advanced-gui-arrow left off"><span class="jcsdl-elements-sprite" /></a><a href="#" class="jcsdl-advanced-gui-arrow right off"><span class="jcsdl-elements-sprite" /></a></div><div class="jcsdl-advanced-manual" style="display: none;"><input type="text" name="advanced" placeholder="1&(2|3)..." /></div></div><div class="jcsdl-row"><div class="jcsdl-filters-logic"><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-and active disabled" data-logic="AND" data-text-long="ALL of the following" data-text-short="ALL">ALL of the following</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-or disabled" data-logic="OR" data-text-long="ANY of the following" data-text-short="ANY">ANY of the following</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced disabled" data-logic="ADVANCED">ADVANCED<span class="jcsdl-logic-help" data-text-general="Use the advanced option to create logical expressions." data-text-gui="Drag and drop the tiles to create an advanced query." data-text-manual="Type a logical expression to create an advanced query.">?</span></a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced-option jcsdl-advanced-add-brackets">+ [ ]</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced-option jcsdl-advanced-add-not">+ NOT</a><a href="#" class="jcsdl-btn jcsdl-filters-logic-option jcsdl-advanced-option jcsdl-advanced-manual-edit" data-text-gui="Manual Edit" data-text-manual="Graphical Edit">Manual Edit</a></div><div class="jcsdl-mainview-actions"><a href="#" class="jcsdl-btn jcsdl-mainview-action jcsdl-editor-preview"><div class="jcsdl-picto jcsdl-elements-sprite"></div></a><a href="#" class="jcsdl-btn jcsdl-mainview-action jcsdl-add-filter"><div class="jcsdl-picto jcsdl-elements-sprite"></div>Create New Filter</a></div><div class="jcsdl-mainview-mode"><div class="jcsdl-label">View as:</div><div class="jcsdl-bordered jcsdl-mainview-mode-options"><a href="#" class="jcsdl-mainview-mode-option jcsdl-elements-sprite jcsdl-expanded active" data-mode="expanded"></a><a href="#" class="jcsdl-mainview-mode-option jcsdl-elements-sprite jcsdl-collapsed" data-mode="collapsed"></a></div></div></div></div><div class="jcsdl-filters-list expanded" /><div class="jcsdl-footer"><div class="jcsdl-mainview-actions"><a href="#" class="jcsdl-btn jcsdl-editor-cancel">Cancel</a><a href="#" class="jcsdl-btn jcsdl-editor-save">Save and Preview</a></div></div></div>'),
filter:d('<div class="jcsdl-filter"><div class="jcsdl-filter-description"><div class="jcsdl-filter-info jcsdl-bordered id" /><div class="jcsdl-filter-info target" /><div class="jcsdl-filter-info field" /><div class="jcsdl-filter-info operator" /><div class="jcsdl-filter-info jcsdl-bordered value" /></div><div class="jcsdl-filter-options"><a href="#" class="edit">Edit</a><span>/</span><a href="#" class="delete">Delete</a></div></div>'),filterTarget:d('<div class="jcsdl-filter-target jcsdl-icon target" />'),
filterField:d('<div class="jcsdl-filter-field jcsdl-icon field" />'),filterFieldInput:d('<div class="jcsdl-filter-info input"><div class="jcsdl-filter-field-input jcsdl-icon input" /></div>'),filterOperator:d('<div class="jcsdl-filter-operator jcsdl-icon operator" />'),filterValue:d('<div class="jcsdl-filter-value" />'),error:d('<div class="jcsdl-error jcsdl-elements-sprite"><strong>Error:</strong><span /></div>'),logicToken_operatorAnd:d('<div href="#" class="jcsdl-logic-token operator" data-token="&">AND</div>'),
logicToken_operatorOr:d('<div href="#" class="jcsdl-logic-token operator" data-token="|">OR</div>'),logicToken_operatorNot:d('<div href="#" class="jcsdl-logic-token operator" data-token="!">NOT<a href="#" class="jcsdl-delete-token"><span class="jcsdl-elements-sprite" /></a></div>'),logicToken_bracketOpen:d('<div href="#" class="jcsdl-logic-token bracket" data-token="(">[<a href="#" class="jcsdl-delete-token"><span class="jcsdl-elements-sprite" /></a></div>'),logicToken_bracketClose:d('<div href="#" class="jcsdl-logic-token bracket" data-token=")">]<a href="#" class="jcsdl-delete-token"><span class="jcsdl-elements-sprite" /></a></div>'),
logicToken_filter:d('<div href="#" class="jcsdl-logic-token filter" data-token="#">#</div>'),filterEditor:d('<div class="jcsdl-filter-editor"><div class="jcsdl-steps"></div><div class="jcsdl-footer"><a href="#" class="jcsdl-btn jcsdl-elements-sprite jcsdl-filter-save">Save and Preview</a><span style="display: none;">or </span> <a href="#" class="jcsdl-filter-cancel">cancel</a></div></div>'),filterEditor_search:d('<div class="jcsdl-search"><input type="text" placeholder="Search for a target..."><a href="#" class="jcsdl-search-arrow jcsdl-elements-sprite"></a><ul class="jcsdl-search-results" /></div>'),
filterEditor_searchItem:d('<li><div class="jcsdl-icon target" /><span class="jcsdl-search-item-name" /></li>'),step:d('<div class="jcsdl-step" />'),target:d('<div class="jcsdl-filter-target-wrap"><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite left"></a><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite right"></a><div class="jcsdl-carousel-wrap"><div class="jcsdl-filter-target jcsdl-carousel" /></div></div>'),targetOption:d('<a href="#" class="jcsdl-icon target jcsdl-carousel-item"></a>'),
field:d('<div class="jcsdl-filter-target-field-wrap"><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite left"></a><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite right"></a><div class="jcsdl-carousel-wrap"><div class="jcsdl-filter-target-field jcsdl-carousel" /></div></div>'),fieldOption:d('<a href="#" class="jcsdl-icon field jcsdl-carousel-item" />'),inputSelect:d('<div class="jcsdl-filter-target-field-input-wrap"><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite left"></a><a href="#" class="jcsdl-carousel-scroll jcsdl-elements-sprite right"></a><div class="jcsdl-carousel-wrap"><div class="jcsdl-filter-target-field-input jcsdl-carousel" /></div></div>'),
inputSelectOption:d('<a href="#" class="jcsdl-icon input jcsdl-carousel-item" />'),targetHelp:d('<a href="#" class="jcsdl-target-help">Learn More</a>'),valueInput:d('<div class="jcsdl-filter-value-input"><div class="jcsdl-filter-value-input-operators" /><div class="jcsdl-filter-value-input-field" /></div>'),operatorOption:d('<a href="#" class="jcsdl-icon operator" />'),textOperatorsSelect:d('<div class="jcsdl-operators-select"><div class="jcsdl-operator-label" /><div class="jcsdl-dropdown-icon jcsdl-elements-sprite" /></div>'),
textOperatorsDropdown:d('<div class="jcsdl-dropdown jcsdl-operators-dropdown" />'),textOperatorOption:d('<div class="jcsdl-dropdown-option"><div class="jcsdl-icon operator" /><a href="#" class="jcsdl-dropdown-details-trigger jcsdl-elements-sprite">?</a><div class="jcsdl-dropdown-option-desc"><div class="jcsdl-operator-label"><span /> <a href="#" class="jcsdl-operator-help">(?)</a></div><div class="jcsdl-operator-desc" /></div></div>'),caseSensitivity:d('<a class="jcsdl-operator-cs jcsdl-icon icon-cs operator" title="Case Sensitive" />'),
valueInput_text:d('<div class="jcsdl-input-text"><input type="text" placeholder="Type your desired value..." class="orig" /><div class="jcsdl-containsnear-distance"><span>Distance:</span><input type="text" placeholder="e.g. 0" value="2" class="dist" /></div></div>'),valueInput_date:d('<div class="jcsdl-input-date"><input type="text" placeholder="Click here to open date picker..." /></div>'),valueInput_number:d('<div class="jcsdl-input-number"><input type="text" placeholder="e.g. 3.14" /></div>'),
valueInput_select:d('<div class="jcsdl-input-select" />'),valueInput_select_option:d('<a href="#" class="jcsdl-btn jcsdl-input-select-option"><span /></a>'),valueInput_select_more:d('<span class="jcsdl-input-select-more">and <span class="count"></span> more...</span>'),valueInput_slider:d('<div class="jcsdl-input-slider"><div class="jcsdl-slider-controls"><a href="#" class="jcsdl-slider-minus jcsdl-elements-sprite" /><a href="#" class="jcsdl-slider-plus jcsdl-elements-sprite" /><input type="text" name="value" class="jcsdl-slider-input" placeholder="0" /></div><div class="jcsdl-slider-wrap"><div class="jcsdl-slider-icon min" /><div class="jcsdl-slider-icon max" /><div class="jcsdl-slider-container"><div class="jcsdl-slider-label min" /><div class="jcsdl-slider-label max" /><div class="jcsdl-slider jcsdl-elements-sprite" /><div class="jcsdl-slider-bottom"><div class="jcsdl-slider-bottom-left jcsdl-elements-sprite" /><div class="jcsdl-slider-bottom-right jcsdl-elements-sprite" /><div class="jcsdl-slider-bottom-line jcsdl-elements-sprite" /></div></div></div></div>'),
valueInput_geo_map:d('<div class="jcsdl-map"><input type="text" name="location" class="jcsdl-map-search" placeholder="Search for location..." /><div class="jcsdl-map-canvas" /><a href="#" class="jcsdl-clear-map">clear coordinates</a><p class="jcsdl-map-instructions" /><div class="jcsdl-map-coordinates" /><div class="jcsdl-map-area"><label>Area:</label><span>0 km<sup>2</sup></span></div></div>'),valueInput_geobox:d('<div class="jcsdl-input-geo jcsdl-geo-box" />'),valueInput_geobox_coordinates:d('<ul><li class="nw"><label>NW:</label><span /></li><li class="ne"><label>NE:</label><span /></li><li class="se"><label>SE:</label><span /></li><li class="sw"><label>SW:</label><span /></li></ul>'),
valueInput_georadius:d('<div class="jcsdl-input-geo jcsdl-geo-radius" />'),valueInput_georadius_coordinates:d('<ul><li class="center"><label>Center:</label><span /></li><li class="radius"><label>Radius:</label><span /></li></ul>'),valueInput_geopolygon:d('<div class="jcsdl-input-geo jcsdl-geo-polygon" />'),valueInput_geopolygon_coordinates:d("<ul />"),listEditor:'<div class="jcsdl-list jcsdl-row"><div class="jcsdl-list-bar jcsdl-row"><a href="#" class="jcsdl-btn jcsdl-edit jcsdl-active" data-list-mode="edit"><i class="jcsdl-picto" /></a><a href="#" class="jcsdl-btn jcsdl-move" data-list-mode="move"><i class="jcsdl-picto" /></a><a href="#" class="jcsdl-btn jcsdl-delete" data-list-mode="delete"><i class="jcsdl-picto" /></a><a href="#" class="jcsdl-btn jcsdl-import" data-import><i class="jcsdl-picto" />Import</a><a href="#" class="jcsdl-btn jcsdl-sort-az" data-sort><i class="jcsdl-picto" />Sort A-Z</a><a href="#" class="jcsdl-btn jcsdl-copy" data-copy><i class="jcsdl-picto" /><span>Copy to Clipboard</span></a><input type="text" name="search" placeholder="Search..." class="jcsdl-list-search"></div><div class="jcsdl-list-container jcsdl-row"><div class="jcsdl-list-cta jcsdl-row" data-list-cta>The first step in creating a list is to add or import data. To get going, look for the <strong>Import</strong> button above this message.</div><div class="jcsdl-list-info" data-list-info style="display: none;"><strong>Current List (<span data-counter>0</span> elements)</strong><br /><span data-mode-info="move" style="display: none;"><strong>Did you know</strong> you can re-order items in this list simply by dragging them into new position?</span><span data-mode-info="delete" style="display: none;"><strong>Did you know</strong> you can click on an item to remove it from the list?</span><span data-mode-info="edit"><strong>Did you know</strong> you can click on an item to edit it?</span></div><ol class="jcsdl-list-elements clearfix"><li class="jcsdl-list-add" data-add-item><input type="text" name="item" class="jcsdl-list-add-input" placeholder="Add to list..." /></li></ol></div></div>',
listElement:'<li class="jcsdl-list-item" data-handle data-item data-value="{value}"><div class="jcsdl-list-item-mode-bar" /><span class="jcsdl-list-item-label">{value}</span><input class="jcsdl-list-item-input" type="text" placeholder="Enter a value..." value="{value}"></li>',listEditor_import:'<div class="jcsdl-import-view jcsdl-row"><div class="jcsdl-row" data-step-one><h4>Paste the contents of your CSV below:</h4><textarea name="import" class="jcsdl-import-input" placeholder="Paste your data here..."></textarea></div><div class="jcsdl-row"><label><input type="checkbox" name="replace" value="1"> Replace the current list?</label></div><div class="jcsdl-row jcsdl-import-buttons"><a href="#" class="jcsdl-btn" data-import-csv>Import</a><a href="#" class="jcsdl-btn" data-import-cancel>Cancel</a></div></div>',
listEditor_import_error:'<div class="jcsdl-import-error" data-csv-error>{error}</div>',listEditor_import_file:'<div class="jcsdl-draganddrop" data-import-file><input type="file" name="csvfile" style="display: none;"><p>Drag and drop a CSV file here</p><a href="#" class="jcsdl-btn" data-select-file>Select File</a></div>',listEditor_import_table:'<div class="jcsdl-row" data-step-two><h4>Select column(s) to add</h4><p data-info>The values in the columns you select will be inserted into a list according to their order. If you\'d like to re-order these items in the next step you can.</p><div class="jcsdl-table-container"><table><thead><tr /></thead><tbody /><tfoot /></table></div><div class="jcsdl-row"><label><input type="checkbox" name="ignoreheaders" value="1" checked="checked"> First row is table header</label></div></div>',
listEditor_import_tableHeader:'<th><input type="checkbox" name="column" value="{i}"></th>',listEditor_import_tableFooter:'<tr><td colspan="{width}">{more} more rows found</td></tr>'}});JCSDL.Loader.addComponent(function(d,j){this.GUIInputs=function(a){this.gui=a;this.definition=a.definition;this.getTemplate=a.getTemplate};this.GUIInputs.prototype={exec:function(a,b,c){return this[a][b].apply(this,c)},text:{init:function(){var a=this.getTemplate("valueInput_text"),b=a.find("input.orig");b.jcsdlListEditor();b.jcsdlRegExTester();a.find("input.dist").jcsdlNumberMask();return a},setValue:function(a,b,c,d){"contains_near"==d&&(c=c.split(":"),b=parseInt(c.pop()),a.find("input.dist").val(b),
c=c.join(":").replace(/\\:/g,":"));a.find("input.orig").val(c)},getValue:function(a,b,c){b=a.find("input.orig").val();"contains_near"==c&&(b=b.replace(/:/g,"\\:")+":"+parseInt(a.find("input.dist").val()));return b},displayValue:function(a,b,c){return"contains_near"==c.operator?(b=b.split(":"),a=parseInt(b.pop()),b=b.join(":").truncate(50,"...",!0).escapeHtml(),b+" : "+a):b.truncate(50,"...",!0).escapeHtml()}},date:{init:function(){var a=this.getTemplate("valueInput_date");a.find("input[type=text]:first").pickadate();
return a},setValue:function(a,b,c){a.find("input[type=text]:first").val(c)},getValue:function(a){return a.find("input[type=text]:first").val()},displayValue:function(a,b){var c="float"==a.type;b=b.split(",");var f=b.slice(0,3);d.each(f,function(a,b){f[a]=c?parseFloat(b).format(2):b});var e=f.length<b.length?" and "+(b.length-f.length)+" more...":"";return f.join(", ")+e}},number:{init:function(a){var b=this.getTemplate("valueInput_number"),c="float"==a.type;a=0<=d.inArray("in",a.operators);var f=
b.find("input[type=text]");f.jcsdlNumberMask(c);a&&f.jcsdlTagInput({numbers:!0,floats:c});return b},setValue:function(a,b,c){a.find("input[type=text]:first").val(c)},getValue:function(a){return a.find("input[type=text]:first").val()},displayValue:function(a,b,c){if("in"!==c.operator)return b;var f="float"==a.type;b=b.split(",");var e=b.slice(0,3);d.each(e,function(a,b){e[a]=f?parseFloat(b).format(2):b});a=e.length<b.length?" and "+(b.length-e.length)+" more...":"";return e.join(", ")+a}},select:{init:function(a){var b=
this,c=this.getTemplate("valueInput_select"),f=this.exec("select","getOptionsSet",[a]);d.each(f,function(a,d){b.exec("select","createOptionView",[a,d]).appendTo(c)});c.find(".jcsdl-input-select-option").bind("click touchstart",function(b){b.preventDefault();b.target.blur();a.single&&c.find(".jcsdl-input-select-option").removeClass("selected");d(this).toggleClass("selected")});return c},setValue:function(a,b,c){b=c.split(",");d.each(b,function(b,c){a.find(".jcsdl-input-select-option.option-"+c).addClass("selected")})},
getValue:function(a){var b=[];a.find(".jcsdl-input-select-option.selected").each(function(a,f){b.push(d(f).data("value"))});return b.join(",")},displayValue:function(a,b){var c=this,f=b.split(","),e=this.getTemplate("valueInput_select");if(0==f.length)return e;var g=this.exec("select","getOptionsSet",[a]),h=f.slice(0,5);d.each(h,function(a,b){if(g[b]===j)return!0;c.exec("select","createOptionView",[b,g[b]]).appendTo(e)});if(f.length>h.length){var m=this.getTemplate("valueInput_select_more");m.find(".count").html(f.length-
h.length);m.appendTo(e)}e.find(".jcsdl-input-select-option").bind("click touchstart",function(a){a.preventDefault();a.target.blur()});return e},getOptionsSet:function(a){var b={};a.options!==j?b=a.options:a.optionsSet!==j&&this.definition.inputs.select.sets[a.optionsSet]!==j&&(b=this.definition.inputs.select.sets[a.optionsSet]);return b},createOptionView:function(a,b){var c=this.getTemplate("valueInput_select_option").data("value",a).addClass("option-"+a).attr("title",b);c.find("span").html(b);return c}},
slider:{init:function(a){var b=this,c=this.getTemplate("valueInput_slider"),f=this.exec("slider","getOptions",[a]);c.find(".jcsdl-slider").slider({animate:!0,min:f.min,max:f.max,step:f.step,value:f["default"],slide:function(d,e){c.find(".jcsdl-slider-input").val(b.exec("slider","parseValue",[a,e.value]))}});this.exec("slider","setValue",[c,a,f["default"]]);c.find(".jcsdl-slider-label.min").html(this.exec("slider","displayValue",[a,f.min]));c.find(".jcsdl-slider-label.max").html(this.exec("slider",
"displayValue",[a,f.max]));c.find(".jcsdl-slider-input").jcsdlNumberMask("float"==a.type).keyup(function(e){110==e.which||190==e.which||(e=d(this).val(),b.exec("slider","setValue",[c,a,parseFloat(e?e:0)]))});var e=null;c.find(".jcsdl-slider-minus, .jcsdl-slider-plus").bind("mousedown touchstart",function(){var g=d(this).is(".jcsdl-slider-minus");e=setInterval(function(){var d=f.step,e=parseFloat(c.find(".jcsdl-slider-input").val()),e=g?e-d:e+d;b.exec("slider","setValue",[c,a,e])},50)}).bind("mouseup mouseout touchend",
function(){clearInterval(e)}).click(function(a){a.preventDefault();a.target.blur()});return c},setValue:function(a,b,c){b=this.exec("slider","getOptions",[b]);c=c>b.max?b.max:c<b.min?b.min:c;a.find(".jcsdl-slider").slider("value",c);a.find(".jcsdl-slider-input").val(c)},getValue:function(a,b){return this.exec("slider","parseValue",[b,a.find(".jcsdl-slider-input").val()])},displayValue:function(a,b){var c=this.exec("slider","getOptions",[a]);return c.displayFormat.apply(c,[b.toString()])},parseValue:function(a,
b){return b},getOptions:function(a){return d.extend({},this.definition.inputs.slider,{min:a.min,max:a.max,step:a.step,"default":a["default"],displayFormat:a.displayFormat})}},_geo:{mapOptions:{},initSearch:function(a){var b=a.data("map"),c=a.find(".jcsdl-map-search"),f=new google.maps.places.Autocomplete(c[0],{});google.maps.event.addListener(f,"place_changed",function(){var a=f.getPlace();a.geometry===j?0<d(".pac-container .pac-item").length&&(c.trigger("focus"),c.simulate("keydown",{keyCode:40}),
c.simulate("keydown",{keyCode:13})):a.geometry.viewport?b.fitBounds(a.geometry.viewport):(b.setCenter(a.geometry.location),b.setZoom(17))})},isNorth:function(a,b){return a.lat()>=b.lat()},isEast:function(a,b){return a.lng()>=b.lng()}},geo_box:{init:function(a){var b=this.getTemplate("valueInput_geobox");b.append(this.getTemplate("valueInput_geo_map"));b.find(".jcsdl-map-coordinates").html(this.getTemplate("valueInput_geobox_coordinates"));b.find(".jcsdl-map-instructions").html(this.definition.inputs.geo_box.instructions[0]);
loadGoogleMapsApi(this.gui,this.exec,["geo_box","load",[a,b]]);return b},load:function(a,b){var c=this,f=new google.maps.Map(b.find(".jcsdl-map-canvas")[0],jcsdlMapsOptions);b.data("map",f);var e=new google.maps.Rectangle(d.extend({},this.gui.config.mapsOverlay,{}));b.data("rect",e);var g=[],h={position:new google.maps.LatLng(0,0),draggable:!0,icon:this.gui.config.mapsMarker},m=[new google.maps.Marker(h),new google.maps.Marker(h)];b.data("markers",m);this._geo.initSearch(b);google.maps.event.addListener(f,
"click",function(a){2<=g.length&&g.pop();g.push(a.latLng);var d=g.length-1;m[d].setPosition(a.latLng);b.data("bothMarkersVisible")||m[d].setAnimation(google.maps.Animation.DROP);m[d].setMap(f);2==g.length&&(c.exec("geo_box","drawRectangle",[f,e,g]),b.data("bothMarkersVisible",!0));b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_box.instructions[g.length]);b.find(".jcsdl-clear-map").fadeIn()});google.maps.event.addListener(m[0],"position_changed",function(){g[0]=this.getPosition();c.exec("geo_box",
"drawRectangle",[f,e,g]);2==g.length&&c.exec("geo_box","updateInfo",[b,e])});google.maps.event.addListener(m[1],"position_changed",function(){g[1]=this.getPosition();c.exec("geo_box","drawRectangle",[f,e,g]);c.exec("geo_box","updateInfo",[b,e])});b.find(".jcsdl-clear-map").bind("click touchstart",function(a){a.preventDefault();a.target.blur();g=[];e.setMap(null);m[0].setMap(null);m[1].setMap(null);b.data("bothMarkersVisible",!1);b.find(".jcsdl-map-area span").html("0 km<sup>2</sup>");b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_box.instructions[0]);
d(this).hide()})},setValue:function(a,b,c){var d=this,e=a.find(".jcsdl-input-geo");c=c.split(":");var g=c[0].split(","),h=c[1].split(",");setTimeout(function(){var b=e.data("map"),c=e.data("rect"),p=d.exec("geo_box","getAllTipsFromNWSE",[g,h]),n=new google.maps.LatLngBounds(p.sw,p.ne);d.exec("geo_box","drawRectangleFromBounds",[b,c,n]);n=e.data("markers");n[0].setMap(b);n[0].setPosition(p.ne);n[1].setMap(b);n[1].setPosition(p.sw);b.fitBounds(c.getBounds());d.exec("geo_box","updateInfo",[e,c]);a.find(".jcsdl-map-instructions").html(d.definition.inputs.geo_box.instructions[2]);
a.find(".jcsdl-clear-map").fadeIn()},this.gui.config.animate+200)},getValue:function(a){a=a.find(".jcsdl-input-geo").data("rect");if(!a.getMap())return"";a=this.exec("geo_box","getAllTipsFromBounds",[a.getBounds()]);return a.nw.lat()+","+a.nw.lng()+":"+a.se.lat()+","+a.se.lng()},displayValue:function(a,b){b=b.split(":");var c=b[0].split(","),d=b[1].split(",");return parseFloat(c[0]).format(2)+", "+parseFloat(c[1]).format(2)+" : "+parseFloat(d[0]).format(2)+", "+parseFloat(d[1]).format(2)},drawRectangle:function(a,
b,c){if(2!=c.length)return!1;c=this.exec("geo_box","getAllTipsFromUnspecified",[c[0],c[1]]);c=new google.maps.LatLngBounds(c.sw,c.ne);this.exec("geo_box","drawRectangleFromBounds",[a,b,c]);return!0},drawRectangleFromBounds:function(a,b,c){b.setBounds(c);b.setMap(a)},getAllTipsFromBounds:function(a){var b={};b.ne=a.getNorthEast();b.sw=a.getSouthWest();b.nw=new google.maps.LatLng(b.ne.lat(),b.sw.lng());b.se=new google.maps.LatLng(b.sw.lat(),b.ne.lng());return b},getAllTipsFromNWSE:function(a,b){var c=
{};c.nw=new google.maps.LatLng(parseFloat(a[0]),parseFloat(a[1]));c.se=new google.maps.LatLng(parseFloat(b[0]),parseFloat(b[1]));c.ne=new google.maps.LatLng(c.nw.lat(),c.se.lng());c.sw=new google.maps.LatLng(c.se.lat(),c.nw.lng());return c},getAllTipsFromUnspecified:function(a,b){var c={},d,e,g;this._geo.isNorth(a,b)?(c=a,d=b):(c=b,d=a);this._geo.isEast(a,b)?(g=a,e=b):(g=b,e=a);return c={nw:new google.maps.LatLng(c.lat(),e.lng()),ne:new google.maps.LatLng(c.lat(),g.lng()),se:new google.maps.LatLng(d.lat(),
g.lng()),sw:new google.maps.LatLng(d.lat(),e.lng())}},updateInfo:function(a,b){var c=this.exec("geo_box","getAllTipsFromBounds",[b.getBounds()]),f=google.maps.geometry.spherical.computeArea([c.nw,c.ne,c.se,c.sw]);a.find(".jcsdl-map-area span").html(Math.round(f/1E6).format()+" km<sup>2</sup>");d.each(c,function(b,c){a.find(".jcsdl-map-coordinates ."+b+" span").html(c.lat().format(2)+", "+c.lng().format(2))})}},geo_radius:{init:function(a){var b=this.getTemplate("valueInput_georadius");b.append(this.getTemplate("valueInput_geo_map"));
b.find(".jcsdl-map-coordinates").html(this.getTemplate("valueInput_georadius_coordinates"));b.find(".jcsdl-map-instructions").html(this.definition.inputs.geo_radius.instructions[0]);loadGoogleMapsApi(this.gui,this.exec,["geo_radius","load",[a,b]]);return b},load:function(a,b){var c=this,f=new google.maps.Map(b.find(".jcsdl-map-canvas")[0],jcsdlMapsOptions);b.data("map",f);var e=d.extend({},this.gui.config.mapsOverlay,{}),g=new google.maps.Circle(e);b.data("circle",g);var e={position:new google.maps.LatLng(0,
0),draggable:!0,icon:this.gui.config.mapsMarker},h=new google.maps.Marker(e);b.data("centerMarker",h);var m=new google.maps.Marker(e);b.data("radiusMarker",m);b.data("center",!1);this._geo.initSearch(b);google.maps.event.addListener(f,"click",function(a){if(b.data("center")){var d=google.maps.geometry.spherical.computeDistanceBetween(g.getCenter(),a.latLng);g.setRadius(d);g.setMap(f);m.setPosition(a.latLng);m.setMap(f);c.exec("geo_radius","updateInfo",[b,g]);b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_radius.instructions[2])}else g.setCenter(a.latLng),
h.setPosition(a.latLng),h.setMap(f),b.data("center",!0),b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_radius.instructions[1]);b.find(".jcsdl-clear-map").fadeIn()});google.maps.event.addListener(h,"position_changed",function(){var a=this.getPosition(),b=g.getCenter();g.setCenter(a);if(b!==j){var c=a.lat()-b.lat(),a=a.lng()-b.lng(),b=m.getPosition(),c=new google.maps.LatLng(b.lat()+c,b.lng()+a);m.setPosition(c)}});google.maps.event.addListener(m,"position_changed",function(){g.getCenter()!==
j&&(g.setRadius(google.maps.geometry.spherical.computeDistanceBetween(g.getCenter(),this.getPosition())),c.exec("geo_radius","updateInfo",[b,g]))});b.find(".jcsdl-clear-map").bind("click touchstart",function(a){a.preventDefault();a.target.blur();g.setCenter(null);g.setMap(null);h.setMap(null);m.setMap(null);b.data("center",!1);b.find(".jcsdl-map-area span").html("0 km<sup>2</sup>");b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_radius.instructions[0]);d(this).hide()})},setValue:function(a,
b,c){var d=this,e=a.find(".jcsdl-input-geo");c=c.split(":");var g=c[0].split(","),h=1E3*parseFloat(c[1]);setTimeout(function(){var b=e.data("map"),c=e.data("circle"),p=new google.maps.LatLng(g[0],g[1]),n=e.data("centerMarker");n.setPosition(p);n.setMap(b);var n=e.data("radiusMarker"),j=google.maps.geometry.spherical.computeOffset(p,h,90);n.setPosition(j);n.setMap(b);c.setCenter(p);c.setRadius(h);c.setMap(b);e.data("center",!0);b.fitBounds(c.getBounds());d.exec("geo_radius","updateInfo",[e,c]);a.find(".jcsdl-map-instructions").html(d.definition.inputs.geo_radius.instructions[2]);
a.find(".jcsdl-clear-map").fadeIn()},this.gui.config.animate+200)},getValue:function(a){a=a.find(".jcsdl-input-geo").data("circle");if(!a.getMap())return"";var b=a.getCenter();return b.lat()+","+b.lng()+":"+a.getRadius()/1E3},displayValue:function(a,b){b=b.split(":");var c=b[0].split(","),d=b[1];return"Center: "+parseFloat(c[0]).format(2)+", "+parseFloat(c[1]).format(2)+"; Radius: "+parseFloat(d).format(2)+" km"},updateInfo:function(a,b){var c=b.getRadius(),c=c*c*Math.PI;a.find(".jcsdl-map-area span").html(Math.round(c/
1E6).format()+" km<sup>2</sup>");c=b.getCenter();a.find(".jcsdl-map-coordinates .center span").html(c.lat().format(2)+", "+c.lng().format(2));a.find(".jcsdl-map-coordinates .radius span").html((b.getRadius()/1E3).format(2)+" km")}},geo_polygon:{init:function(a){var b=this.getTemplate("valueInput_geopolygon");b.append(this.getTemplate("valueInput_geo_map"));b.find(".jcsdl-map-coordinates").html(this.getTemplate("valueInput_geopolygon_coordinates"));b.find(".jcsdl-map-instructions").html(this.definition.inputs.geo_polygon.instructions[0]);
loadGoogleMapsApi(this.gui,this.exec,["geo_polygon","load",[a,b]]);return b},load:function(a,b){var c=this,f=new google.maps.Map(b.find(".jcsdl-map-canvas")[0],jcsdlMapsOptions);b.data("map",f);var e=d.extend({},this.gui.config.mapsOverlay,{paths:[[]],editable:!0}),g=new google.maps.Polygon(e),h=g.getPath();b.data("polygon",g);var m=new google.maps.MVCArray;b.data("markers",m);var k=1;this._geo.initSearch(b);google.maps.event.addListener(f,"click",function(a){h.push(a.latLng)});google.maps.event.addListener(h,
"insert_at",function(a){var d=new google.maps.Marker({map:f,position:h.getAt(a),draggable:!0,icon:c.gui.config.mapsMarker,zIndex:k++});m.insertAt(a,d);3<=h.getLength()&&g.setMap(f);a=3>=h.getLength()?h.getLength():3;b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_polygon.instructions[a]);c.exec("geo_polygon","updateInfo",[b,g]);b.find(".jcsdl-clear-map").fadeIn();google.maps.event.addListener(d,"position_changed",function(){var a=c.exec("geo_polygon","getMarkerIndex",[d,m]);-1!=a&&
(h.setAt(a,this.getPosition()),c.exec("geo_polygon","updateInfo",[b,g]))});google.maps.event.addListener(d,"dblclick",function(){var a=c.exec("geo_polygon","getMarkerIndex",[d,m]);-1!=a&&(h.removeAt(a),m.removeAt(a),this.setMap(null),c.exec("geo_polygon","updateInfo",[b,g]))})});google.maps.event.addListener(h,"set_at",function(a){var b=m.getAt(a);a=h.getAt(a);b.getPosition().equals(a)||b.setPosition(a)});b.find(".jcsdl-clear-map").bind("click touchstart",function(a){a.preventDefault();a.target.blur();
m.forEach(function(a){a.setMap(null)});m.clear();h.clear();c.exec("geo_polygon","updateInfo",[b,g]);b.find(".jcsdl-map-instructions").html(c.definition.inputs.geo_polygon.instructions[0]);d(this).hide()})},setValue:function(a,b,c){var f=this,e=a.find(".jcsdl-input-geo");c=c.split(":");setTimeout(function(){var b=e.data("polygon"),h=e.data("map");d.each(c,function(a,c){c=c.split(",");var d=new google.maps.LatLng(parseFloat(c[0]),parseFloat(c[1]));b.getPath().push(d)});h.fitBounds(b.getBounds());f.exec("geo_polygon",
"updateInfo",[e,b]);a.find(".jcsdl-map-instructions").html(f.definition.inputs.geo_polygon.instructions[3]);a.find(".jcsdl-clear-map").fadeIn()},this.gui.config.animate+200)},getValue:function(a){var b=[];a.find(".jcsdl-input-geo").data("polygon").getPath().forEach(function(a){b.push(a.lat()+","+a.lng())});return b.join(":")},displayValue:function(a,b){b=b.split(":");var c=[];d.each(b,function(a,b){b=b.split(",");c.push(parseFloat(b[0]).format(2)+", "+parseFloat(b[1]).format(2));if(1==a)return!1});
c=c.join(" : ");2<b.length&&(c+=" and "+(b.length-2)+" more...");return c},getMarkerIndex:function(a,b){var c=-1;b.forEach(function(b,d){b.getZIndex()==a.getZIndex()&&(c=d)});return c},updateInfo:function(a,b){var c=b.getPath(),f=a.find(".jcsdl-map-coordinates ul").html("");c.forEach(function(a){d("<li />").html("("+a.lat().format(4)+", "+a.lng().format(4)+")").appendTo(f)});3<=c.getLength()?(c=google.maps.geometry.spherical.computeArea(c),a.find(".jcsdl-map-area span").html(Math.round(c/1E6).format()+
" km<sup>2</sup>")):a.find(".jcsdl-map-area span").html("0 km<sup>2</sup>")}}}});JCSDL.Loader.addComponent(function(d){var j=function(a,b){var c=this;this.select=b.select;this.$carousel=a.find(".jcsdl-carousel");this.$carouselWrap=this.$carousel.closest(".jcsdl-carousel-wrap");this.$carouselItems=this.$carousel.find(".jcsdl-carousel-item");this.$scrollLeft=this.$carouselWrap.siblings(".jcsdl-carousel-scroll.left");this.$scrollRight=this.$carouselWrap.siblings(".jcsdl-carousel-scroll.right");this.itemsCount=this.$carouselItems.filter(":visible").length;var f=this.$carouselItems.eq(0),
e=f.is(":visible")?!1:!0;f.show();this.itemWidth=f.outerWidth(!0);this.itemMargin=parseInt(f.css("marginRight"));this.$carouselWrap.css({maxWidth:this.calculateWrapWidth(),height:f.outerHeight(!0)});this.$carousel.css({position:"relative",width:this.itemWidth*this.itemsCount,height:f.outerHeight(!0)});this.margin=this.calculateCenterMargin();e&&f.hide();f=this.$carouselItems.filter(".selected");this.selectedIndex=1==f.length?f.prevAll(":visible").length:Math.floor(this.itemsCount/2);0==this.itemsCount%
2&&(this.selectedIndex-=0.5);this.changePosition(0,!b.expand);this.$carouselWrap.siblings(".jcsdl-carousel-scroll").bind("click touchstart",function(a){a.preventDefault();a.target.blur();a=d(this);a.hasClass("inactive")||(a=a.is(".left")?-1:1,0.5==c.selectedIndex-Math.floor(c.selectedIndex)&&(c.selectedIndex=0>a?c.selectedIndex:c.selectedIndex-1),c.selectedIndex=Math.round(c.selectedIndex)+a,c.changePosition(b.speed))});this.$carouselItems.bind("mousedown.jcsdlcarousel touchstart.jcsdlcarousel",function(a){a.preventDefault();
a.target.blur();var e=d(this),f=!1,k="touchmove"==a.type?a.originalEvent.targetTouches[0].pageX:a.pageX;d("body").bind("mousemove.jcsdlcarousel touchmove.jcsdlcarousel",function(a){f=!0;a="touchmove"==a.type?a.originalEvent.targetTouches[0].pageX:a.pageX;var b=parseInt(c.$carousel.css("left"));c.$carousel.css("left",b-(k-a));k=a});d("body").bind("mouseup.jcsdlcarousel touchend.jcsdlcarousel",function(){f?c.snapToSelection():(c.selectedIndex=e.prevAll(":visible").length,c.changePosition(b.speed),f=
!1);d("body").unbind("mousemove.jcsdlcarousel touchmove.jcsdlcarousel");d("body").unbind("mouseup.jcsdlcarousel touchend.jcsdlcarousel")})});this.$carouselItems.bind("jcsdlclick",function(){d(this).show();c.itemsCount=c.$carouselItems.filter(":visible").length;c.$carousel.css("width",c.itemWidth*c.itemsCount);d(this).trigger("mousedown").trigger("mouseup")});this.$carouselItems.click(function(a){a.preventDefault();a.target.blur();d("html").is(".msie")&&(c.selectedIndex=d(this).prevAll(":visible").length,
c.changePosition(b.speed))});d(window).resize(function(){c.adjust()});this.$carouselItems.filter(":visible")};j.prototype={calculateWrapWidth:function(){return this.$carouselWrap.closest(".jcsdl-step").width()-this.$scrollLeft.outerWidth(!0)-this.$scrollRight.outerWidth(!0)},calculateCenterMargin:function(){return this.margin=(this.$carouselWrap.width()-this.itemWidth+this.itemMargin)/2},calculateCurrentPosition:function(){return-1*this.itemWidth*this.selectedIndex+this.margin},toggleScrollButtons:function(){this.$scrollLeft.removeClass("inactive");
this.$scrollRight.removeClass("inactive");0==this.selectedIndex&&this.$scrollLeft.addClass("inactive");this.selectedIndex+1>=this.itemsCount&&this.$scrollRight.addClass("inactive")},getSelectedItem:function(){return this.$carouselItems.filter(":visible").eq(this.selectedIndex)},snapToSelection:function(){var a=parseInt(this.$carousel.css("left"));this.selectedIndex=Math.round((a-this.margin)/(-1*this.itemWidth));this.selectedIndex=0>this.selectedIndex?0:this.selectedIndex;this.selectedIndex=this.selectedIndex+
1>this.itemsCount?this.itemsCount-1:this.selectedIndex;this.changePosition(100)},changePosition:function(a,b){var c=this;b=b||!1;this.$carousel.animate({left:this.calculateCurrentPosition()},a,function(){c.adjust()});this.toggleScrollButtons();!b&&("function"==typeof this.select&&0<this.itemsCount)&&this.select.apply(this.getSelectedItem())},adjust:function(){this.$carouselWrap.css({maxWidth:this.calculateWrapWidth()});this.calculateCenterMargin();this.$carousel.css({left:this.calculateCurrentPosition()})}};
d.fn.jcsdlCarousel=function(a){function b(b){var d=b.data("jcsdlCarousel");d||(d=new j(b,a),b.data("jcsdlCarousel",d));return d}if("string"==typeof a)return 0<=d.inArray(a,["adjust"])&&this.each(function(){var c=b(d(this));c[a].apply(c,[])}),this;a=d.extend({},{select:function(){},expand:!1,speed:200},a);this.each(function(){b(d(this))});return this}});
JCSDL.Loader.addComponent(function(d){d.fn.jcsdlNumberMask=function(j,a){this.each(function(){d(this).keydown(function(b){(190==b.which||110==b.which)&&(0<=d(this).val().indexOf(".")||!j)?b.preventDefault():b.shiftKey||b.altKey?b.preventDefault():46==b.which||(8==b.which||9==b.which||27==b.which||190==b.which||110==b.which||188==b.which&&a||65==b.which&&!0===b.ctrlKey||35<=b.which&&39>=b.which||13==b.which)||(48>b.which||57<b.which)&&(96>b.which||105<b.which)&&b.preventDefault()})});return this}});
JCSDL.Loader.addComponent(function(d,j){d.fn.jcsdlOrigVal=d.fn.val;d.fn.val=function(a){if(!this[0])return j;var c=d(this[0]);return(c.data("jcsdlTagInput")||c.data("jcsdlListEditor"))&&a!==j?(c.jcsdlOrigVal(a),c.trigger("change"),c):a!==j?c.jcsdlOrigVal(a):c.jcsdlOrigVal()};var a=function(a,c){var f=this;this.delimeter=c.delimeter;this.numbers=c.numbers;this.floats=c.floats;this.$original=a;this.$original.data("jcsdlTagInputEnabled",!0);this.$wrap=d(this.tpl);this.$inputWrap=this.$wrap.find(".jcsdl-tag-field");
this.$input=this.$inputWrap.find("input");this.inputPh=this.$original.attr("placeholder");this.$input.attr("placeholder",this.inputPh);this.$original.hide().data("jcsdlTagValue",[]);this.$wrap.insertAfter(this.$original);this.$inputSizeHelper=d("<div />").addClass("jcsdl-tag-field-helper").css({position:"absolute",left:-9999,bottom:-9999,minWidth:100,width:"auto",textAlign:"left"}).appendTo(this.$inputWrap);this.numbers&&this.$input.jcsdlNumberMask(this.floats,!0);this.update();this.$wrap.bind("click touchstart",
function(){f.$input.focus()});this.$original.bind("change.jcsdltaginput",function(){!f.updating&&d(this).data("jcsdlTagInputEnabled")&&f.update()});this.$input.blur(function(){var a=f.$input.val();0!=a.length&&f.addTag(a)});this.$input.bind("paste.jcsdltaginput",function(){setTimeout(function(){var a=f.$input.val();0!=a.length&&f.addTag(a)},10)});this.$input.bind("keypress.jcsdltaginput",function(a){d(this).val();13==a.which?(a.preventDefault(),f.addTag(d(this).val())):f.reposition()});this.$input.bind("keydown.jcsdltaginput",
function(a){8==a.which&&0==d(this).val().length&&(a.preventDefault(),f.removeTag(f.$wrap.find(".jcsdl-tag:last")))});this.$input.bind("keyup.jcsdltaginput",function(){var a=d(this).val();a.charCodeAt(a.length-1)==f.delimeter.charCodeAt(0)&&"\\"!=a.charAt(a.length-2)&&f.addTag(a.substr(0,a.length-1))})};a.prototype={tpl:'<div class="jcsdl-tag-input"><div class="jcsdl-tag-field"><input type="text" /></div></div>',tagTpl:'<span class="jcsdl-tag"><span /><a href="#" class="jcsdl-tag-remove jcsdl-elements-sprite" title="Remove"></a></span>',
updating:!1,delimeter:",",numbers:!1,numbersArrVal:[],floats:!1,addTag:function(a){this.$input.val("");if(!(a===j||0==a.length)){var c=this,f=d(this.tagTpl);f.find("span").html(a.truncate());f.insertBefore(this.$inputWrap);var e=this.$original.data("jcsdlTagValue");e.push(a);this.$original.data("jcsdlTagValue",e);this.$original.val(e.join(this.delimeter));this.$input.attr("placeholder","");f.find("a").bind("click touchstart",function(a){a.preventDefault();a.target.blur();c.removeTag(f)});this.reposition()}},
removeTag:function(a){if(0!=a.length){var c=this.$wrap.find(".jcsdl-tag").index(a);a.remove();a=this.$original.data("jcsdlTagValue");a.splice(c,1);this.$original.data("jcsdlTagValue",a);this.$original.val(a.join(this.delimeter));0==a.length&&this.$input.attr("placeholder",this.inputPh);this.reposition()}},update:function(a){a=a?RegExp(/[\s,]+/g):this.delimeter;var c=this.$original.val();if(0!=c.length){var f=this;this.$original.data("jcsdlTagValue",[]);this.$wrap.find(".jcsdl-tag").remove();this.updating=
!0;var e=c.split(a),g=[];d.each(e,function(a,b){if(b===j)return!0;"\\"==b.charAt(b.length-1)&&(b+=f.delimeter+e[a+1],e.splice(a+1,1));g.push(b)});e=g;d.each(e,function(a,b){f.addTag(b)});this.updating=!1;this.reposition()}},reposition:function(){var a=this.$input.val().escapeHtml();0==a.length&&(a=this.$input.attr("placeholder"));this.$inputSizeHelper.html(a);this.$input.css({width:this.$inputSizeHelper.width()+32+"px",maxWidth:this.$wrap.width()-30,"font-size":this.$input.css("font-size"),"font-family":this.$input.css("font-family"),
"font-weight":this.$input.css("font-weight"),"letter-spacing":this.$input.css("letter-spacing"),whiteSpace:"nowrap"})},enable:function(){this.numbers&&(this.$original.data("jcsdlTagInputEnabled")?this.numbersArrVal=this.$original.val().split(this.delimeter):this.numbersArrVal[0]=this.$original.val());this.$original.data("jcsdlTagInputEnabled",!0);this.numbers&&this.$original.val(this.numbersArrVal.join(this.delimeter));this.$original.hide();this.$wrap.show()},disable:function(){if(this.numbers){var a=
"";this.$original.data("jcsdlTagInputEnabled")?(this.numbersArrVal=this.$original.val().split(this.delimeter),a=this.numbersArrVal[0]):a=this.$original.val()}this.$original.data("jcsdlTagInputEnabled",!1);this.numbers&&this.$original.val(a);this.$original.show();this.$wrap.hide()}};d.fn.jcsdlTagInput=function(b){function c(c){var d=c.data("jcsdlTagInput");d||(d=new a(c,b),c.data("jcsdlTagInput",d));return d}if("string"==typeof b){if(0<=d.inArray(b,["enable","disable","reposition","update","setDelimeter"])){var f=
[];d.each(arguments,function(a,b){if(0==a)return!0;f.push(b)});this.each(function(){var a=c(d(this));a[b].apply(a,f)})}return this}b=d.extend({},{delimeter:",",numbers:!1,floats:!1},b);this.each(function(){c(d(this))});return this}});
JCSDL.Loader.addComponent(function(d,j){var a=function(a,c){var f=this;this.$el=a;this.exp=RegExp();this.$btn=d('<a href="#" class="jcsdl-regex-tester-button jcsdl-elements-sprite">Test</a>').insertAfter(this.$el);this.$wrap=d('<div class="jcsdl-regex-tester"><p>If you want to test whether your regular expression correctly matches the desired strings, click the "Test" button and input example content in the shown field.</p></div>').insertAfter(this.$el).hide();this.$fields=d();this.$fieldsWraps=d();
for(var e=1;e<=c.fields;e++){var g=this.$el.clone().removeClass("orig").show().attr("placeholder","Test your expression against this field..."),h=d('<div class="jcsdl-regex-tester-input-wrap" />').html(g).append('<div class="jcsdl-regex-result jcsdl-elements-sprite" />');h.prependTo(this.$wrap);this.$fields=this.$fields.add(g);this.$fieldsWraps=this.$fieldsWraps.add(h)}this.$btn.bind("click touchstart",function(a){a.preventDefault();a.target.blur();f.$fieldsWraps.fadeIn();d(this).addClass("active")});
this.$el.bind("keyup change",function(){f.val=f.$el.val();f.test()});this.$fields.bind("keyup",function(){f.test(d(this))});this.disable()};a.prototype={mode:"partial",val:"",test:function(a){var c=this;a=a!==j?a:this.$fields;var f=this.val.replace(/\//g,"/");this.exp=RegExp("partial"==this.mode?""+f+"":"^"+f+"$","i");a.each(function(a,b){if(0==d(b).val().length||0==c.val.length)return d(b).siblings(".jcsdl-regex-result").hide(),!0;var f=c.exp.test(d(b).val())?"ok":"err";d(b).siblings(".jcsdl-regex-result").removeClass("ok err").addClass(f).fadeIn()})},
enable:function(){this.$el.data("jcsdlRegExTesterEnabled",!0);this.$el.addClass("jcsdl-regex-active");this.$wrap.fadeIn();this.$btn.fadeIn()},disable:function(){this.$el.data("jcsdlRegExTesterEnabled",!1);this.$el.removeClass("jcsdl-regex-active");this.$wrap.hide();this.$fieldsWraps.hide();this.$btn.hide()},setPartial:function(){this.mode="partial"},setExact:function(){this.mode="exact"}};d.fn.jcsdlRegExTester=function(b){function c(c){var d=c.data("jcsdlRegExTester");d||(d=new a(c,b),c.data("jcsdlRegExTester",
d));return d}if("string"==typeof b)return 0<=d.inArray(b,["enable","disable","setPartial","setExact","test"])&&this.each(function(){var a=c(d(this));a[b].apply(a,[])}),this;b=d.extend({},{fields:1},b);this.each(function(){c(d(this))});return this}});
JCSDL.Loader.addComponent(function(d){var j=d(window),a=function(a){var c=this;this.config=d.extend({},this.config,a);this.$overlay=d('<div class="jcsdl-overlay" />').appendTo("body").hide();this.$popup=d('<div class="jcsdl-popup"><div class="jcsdl-popup-header jcsdl-elements-sprite"><h4 /><a href="#" class="jcsdl-popup-close jcsdl-elements-sprite">Close</a></div><div class="jcsdl-popup-content" /></div>').appendTo("body").hide();this.config.title&&this.setTitle(this.config.title);this.config.content&&
this.setContent(this.config.content);this.$popup.css({minWidth:this.config.minWidth,maxWidth:this.config.maxWidth});this.setWidth(this.config.width);this.config.autoshow&&this.show();this.$popup.find(".jcsdl-popup-close").click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();c.close()});d(window).resize(function(){c.$popup.is(":visible")&&c.reposition()})};a.prototype={$popup:d(),$overlay:d(),config:{width:700,minWidth:280,maxWidth:"70%",title:"",content:'<div class="jcsdl-popup-loading"></div>',
autoshow:!0,overlay:!0},getTitle:function(){return this.$popup.find(".jcsdl-popup-header h4").html()},setTitle:function(a){this.$popup.find(".jcsdl-popup-header h4").html(a);this.config.title=a},getContent:function(){return this.$popup.find(".jcsdl-popup-content")},setContent:function(a){"string"===typeof a&&(a=d.trim(a));var c="string"===typeof a&&"<"!==a.charAt(0)?d("<p>"+a+"</p>"):d(a),f=this.$popup.find(".jcsdl-popup-content");f.html("");c.each(function(a,b){f.append(d(b))});this.config.content=
a},setWidth:function(a){this.$popup.width(a)},reposition:function(){this.$popup.css("position","fixed");this.$popup.find(".jcsdl-popup-content").css("maxHeight",0.7*j.height());var a=Math.max(0,(j.width()-this.$popup.outerWidth())/2),c=Math.max(0,(j.height()-this.$popup.outerHeight())/2);this.$popup.css({left:a+"px",top:c+"px"})},show:function(){this.config.overlay&&this.$overlay.show();this.$popup.show();this.reposition()},hide:function(){this.$overlay.hide();this.$popup.hide()},close:function(){this.$overlay.remove();
this.$popup.remove()}};d.jcsdlPopup=function(b){return new a(b)}});JCSDL.Loader.addComponent(function(d,j){d.fn.animateIntoView=function(a,b,c){a=a===j?200:a;b=parseInt(b)||0;c="function"==typeof c?c:function(){};var f=d(this[0]);if(!f.length)return this;var e=d("body"),g=d("html"),f=f.offset().top,h=parseInt(e.scrollTop()),m=h+d(window).height();if(h<f&&f<m)return this;e.add(g).animate({scrollTop:f-b},a,c);return this}});
var jcsdlMapsLoaded=!1,jcsdlMapsCurrentGui=null,jcsdlMapsCurrentCallback=function(){},jcsdlMapsCurrentCallbackArgs=[],jcsdlMapsOptions={},loadGoogleMapsApi=function(d,j,a){jcsdlMapsCurrentGui=d;jcsdlMapsCurrentCallback=j;jcsdlMapsCurrentCallbackArgs=a;jcsdlMapsLoaded?jcsdlMapsInit():(d=0<jcsdlMapsCurrentGui.config.googleMapsApiKey.length?"key="+jcsdlMapsCurrentGui.config.googleMapsApiKey+"&":"",j="file:"==window.location.protocol?"http:":"",jQuery("body").append('<script type="text/javascript" src="'+
j+"//maps.googleapis.com/maps/api/js?"+d+'libraries=places,geometry&sensor=false&callback=jcsdlMapsInit" />'),jcsdlMapsLoaded=!0)},jcsdlMapsInit=function(){jcsdlMapsOptions={center:new google.maps.LatLng(40,0),zoom:1,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControl:!0,navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}};google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=
function(){for(var d=new google.maps.LatLngBounds,j=this.getPaths(),a,b=0;b<j.getLength();b++){a=j.getAt(b);for(var c=0;c<a.getLength();c++)d.extend(a.getAt(c))}return d});jcsdlMapsCurrentGui&&jcsdlMapsCurrentCallback&&setTimeout(function(){jcsdlMapsCurrentCallback.apply(jcsdlMapsCurrentGui.inputs,jcsdlMapsCurrentCallbackArgs)},jcsdlMapsCurrentGui.config.animate+10)};
JCSDL.Loader.addComponent(function(d,j){d.extend(String.prototype,{truncate:function(a,b,c){a=a||72;b=b||"...";if(this.length<=a)return this.valueOf();s=this.substr(0,a);c||(s=s.substr(0,s.lastIndexOf(" ")));return s+b},isNumeric:function(){return!isNaN(parseInt(this.valueOf()))},escapeHtml:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},unescapeHtml:function(){return this.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,
'"')},escapeCsdl:function(){return this.replace(/\\(?![,:]+)/g,"\\\\").replace(/"/g,'\\"')},unescapeCsdl:function(){return this.replace(/\\"/g,'"').replace(/\\\\/g,"\\")}});d.extend(Number.prototype,{format:function(a,b,c){var d=this.toString().replace(/[^0-9+\-Ee.]/g,""),d=!isFinite(+d)?0:+d;a=!isFinite(+a)?0:Math.abs(a);c=c===j?",":c;b=b===j?".":b;var e="",e=function(a,b){var c=Math.pow(10,b);return""+Math.round(a*c)/c},e=(a?e(d,a):""+Math.round(d)).split(".");3<e[0].length&&(e[0]=e[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,
c));if((e[1]||"").length<a)e[1]=e[1]||"",e[1]+=Array(a-e[1].length+1).join("0");return e.join(b)}})});JCSDL.Loader.addComponent(function(d,j){this.ListEditor=function(a){var b=this;this.$inputEl=a;this.$view=this.getTemplate("listEditor").insertAfter(a);this.$list=this.$view.find(".jcsdl-list-elements");this.$copyBtn=this.$view.find("a[data-copy]").attr("id","jcsdl-copy-to-clipboard-"+Math.floor(1E4*Math.random()));this.$importBtn=this.$view.find("a[data-import]");this.$modeBtns=this.$view.find("a[data-list-mode]");this.$searchInput=this.$view.find('input[name="search"]');this.$counter=this.$view.find("[data-counter]");
this.$list.html5sortable({cursor:"move",items:"li:not(.jcsdl-list-add)",placeholder:"sortable-placeholder"}).on("sortupdate",function(){b.updateValue()});setTimeout(function(){b.$list.html5sortable("disable")},100);this.$inputEl.on("change.jcsdllisteditor",function(){b.silentUpdate||b.update()});this.$list.on("keypress","[data-add-item] input",function(a){if(13===a.which){a=d(this);var f=this.value;d.string.trim(f).length&&(b.addItem(f,b.$list.find(".jcsdl-list-add")),a.val(""))}});this.$list.on("click",
"li:not([data-add-item])",function(){var a=d(this),f=a.find("span").width();b.$list.find("li.jcsdl-list-active").removeClass("jcsdl-list-active");b.mode===b.EDIT_MODE?a.addClass("jcsdl-list-active").find(".jcsdl-list-item-input").width(f).focus():b.mode===b.DELETE_MODE&&(a.remove(),b.updateCounter(),b.updateValue());return!1});this.$list.on("keypress","li:not([data-add-item]) input",function(a){13===a.which&&d(this).blur()});this.$list.on("blur","li:not([data-add-item]) input",function(){var a=d(this).closest("li");
d.string.trim(this.value).length?a.removeClass("jcsdl-list-active").data("value",this.value).find(".jcsdl-list-item-label").text(this.value):(a.remove(),b.updateCounter());b.updateValue()});this.$list.on("keydown","li:not([data-add-item]) input",function(a){if(-1!==d.inArray(a.which,[9,27])){var b=d(this),e=b.closest("li"),g;switch(a.which){case 9:a=a.shiftKey?e.prev("li"):e.next("li");a.length&&a.click();g=!1;break;case 27:b.blur()}return g}});this.$view.find("a[data-sort]").click(function(){var a=
b.$list.children().not("[data-add-item]").get();a.sort(function(a,b){return d(a).find("input").val().toUpperCase().localeCompare(d(b).find("input").val().toUpperCase())});d.each(a,function(a,c){b.$list.append(c)});b.updateValue();return!1});this.$importBtn.click(function(){b.showImportView();return!1});this.$searchInput.on("keyup",function(a){if(27===a.which)b.$searchInput.val("").blur(),b.$list.children().show();else{a=b.$searchInput.val();var d=RegExp("^"+a,"i");b.$list.children().not("[data-add-item]").quickEach(function(){d.test(this.data("value"))?
this.show():this.hide()})}});this.$modeBtns.click(function(){b.setMode(d(this).data("listMode"));return!1});this.disable()};this.ListEditor.prototype={silentUpdate:!1,$importView:null,importPopup:null,mode:"edit",EDIT_MODE:"edit",MOVE_MODE:"move",DELETE_MODE:"delete",addItem:function(a,b,c){b=b||null;c=c===j?!0:c;a=this.getTemplate("listElement",{value:d.string.escapeHtml(a)});b&&b.length?a.insertAfter(b):a.appendTo(this.$list);c&&(this.$list.html5sortable("refresh"),this.updateCounter(),this.updateValue());
return a},addItems:function(a,b){b&&this.$list.find("li:not([data-add-item])").remove();for(var c=0;c<a.length;c++)this.addItem(a[c],null,!1);this.$list.html5sortable("refresh");this.updateCounter();this.updateValue()},setValue:function(a){var b=this,c="::__ESC_TOKEN__::"+d.string.random()+"::",f=RegExp(c,"gi");a=a.replace(/\\,/gi,c).split(",");this.$list.find("li:not([data-add-item])").remove();d.each(a,function(a,c){c=d.string.trim(c.replace(f,","));if(!c.length)return!0;b.addItem(c,null,!1)});
this.$list.html5sortable("refresh");this.updateCounter();this.updateValue()},getValue:function(){var a=[];this.$list.find("li:not([data-add-item]) input").quickEach(function(){var b=this.val();if(!d.string.trim(b).length)return!0;a.push(b.replace(/,/gi,"\\,"))});return a.join(",")},updateValue:function(){this.silentUpdate=!0;this.$inputEl.val(this.getValue());this.silentUpdate=!1},updateCounter:function(){var a=this.$list.find("li:not([data-add-item])").length;this.$counter.html(a);a?(this.$view.find("[data-list-cta]").hide(),
this.$view.find("[data-list-info]").show()):(this.$view.find("[data-list-cta]").show(),this.$view.find("[data-list-info]").hide());return a},setMode:function(a){if(-1===d.inArray(a,[this.EDIT_MODE,this.DELETE_MODE,this.MOVE_MODE]))throw Error('Unrecognized mode "'+a+'".');this.$modeBtns.removeClass("jcsdl-active").filter('[data-list-mode="'+a+'"]').addClass("jcsdl-active");this.$list.removeClass("jcsdl-mode-edit jcsdl-mode-move jcsdl-mode-delete").addClass("jcsdl-mode-"+a);this.$view.find("[data-mode-info]").hide();
this.$view.find('[data-mode-info="'+a+'"]').show();this.$list.html5sortable(a===this.MOVE_MODE?"enable":"disable");this.mode=a},showImportView:function(){var a=this,b=this.$importView=this.getTemplate("listEditor_import"),c=b.find('input[name="replace"]');this.importPopup=d.jcsdlPopup({title:"Import CSV List",content:b});if(window.File&&window.FileReader&&window.FileList&&window.Blob){var f=this.getTemplate("listEditor_import_file").prependTo(b.find("[data-step-one]")).filter("[data-import-file]"),
e=f.find('input[type="file"]'),g=function(b){if(!(b===j||"text/csv"!==b.type)){var d=new FileReader;d.onload=function(b){a.parseCsv(b.target.result.replace(/\r\n|\r/g,"\n"),c.is(":checked"))};d.readAsText(b)}};f.find("a[data-select-file]").click(function(){e.click();return!1});f[0].addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy";f.addClass("over")},!1);f[0].addEventListener("dragenter",function(){f.addClass("over")},!1);f[0].addEventListener("dragleave",
function(){f.removeClass("over")},!1);f[0].addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();g(a.dataTransfer.files[0])},!1);e.change(function(a){g(a.target.files[0])})}b.on("click","a[data-import-cancel]",function(){a.hideImportView();return!1});b.find("a[data-import-csv]").on("click",function(){var d=b.find('textarea[name="import"]').val();a.parseCsv(d,c.is(":checked"));return!1})},hideImportView:function(){this.$importView&&this.$importView.length&&(this.$importView.remove(),
this.$importView=null);this.importPopup.close()},showCSVImportError:function(a){this.clearCSVImportError();this.$importView.find("[data-step-one]").append(this.getTemplate("listEditor_import_error",{error:a}))},clearCSVImportError:function(){this.$importView.find("[data-csv-error]").remove()},parseCsv:function(a,b){b=b||!1;var c=a.split("\n");if(1===c.length)try{this.addItems(d.csv.toArray(c[0]),b),this.hideImportView()}catch(f){this.showCSVImportError(f.message)}else{var e=[],g=1,h=0;try{d.each(c,
function(a,b){h=a;var c=d.csv.toArray(b);c.length>g&&(g=c.length);e.push(c)})}catch(j){this.showCSVImportError(j.message+" on line "+(h+1)+".");return}if(1===g){var k=[];d.each(e,function(a,b){k.push(b[0])});this.addItems(k,b);this.hideImportView()}else this.configureDataImport(e,g)}},configureDataImport:function(a,b){var c=this;this.$importView.find("[data-step-one]").remove();for(var f=this.getTemplate("listEditor_import_table").prependTo(this.$importView),e=f.find("table thead tr:first"),g=f.find("table tfoot"),
h=f.find("table tbody"),m=f.find('input[name="ignoreheaders"]'),f=0;f<b;f++)this.getTemplate("listEditor_import_tableHeader",{i:f}).appendTo(e);5<a.length&&this.getTemplate("listEditor_import_tableFooter",{width:b,more:a.length-5}).appendTo(g);d.each(a,function(a,c){if(5<a)return!1;for(var e=d("<tr>"),f=0;f<b;f++)e.append("<td>"+(c[f]!==j?c[f]:"")+"</td>");e.appendTo(h);a||e.addClass("ignored")});this.importPopup.reposition();m.change(function(){h.find("tr:first")[this.checked?"addClass":"removeClass"]("ignored")});
this.$importView.find("a[data-import-csv]").off("click").on("click",function(){var b=[];e.find('input[name="column"]:checked').each(function(){b.push(parseInt(this.value,10))});if(!b.length)return c.$importView.find("thead").addClass("csdl-error"),!1;m.is(":checked")&&a.shift();var f=[];d.each(a,function(a,c){d.each(b,function(a,b){c[b]!==j&&f.push(c[b])})});c.addItems(f,c.$importView.find('input[name="replace"]').is(":checked"));c.hideImportView();return!1})},getTemplate:function(a,b,c){b=b||{};
c=c||!1;if(JCSDL.GUITemplates[a]===j)throw Error("No JCSDL.GUITemplate named '"+a+"' found!");a=JCSDL.GUITemplates[a];"string"!==typeof a&&(a=a.outerHtml());b=d.string.parseVariables(a,b);return c?b:d(b)},enable:function(){var a=this;this.$inputEl.data("jcsdlListEditorEnabled",!0).data("jcsdlTagInputEnabled",!0);this.$inputEl.hide();this.$view.show();setTimeout(function(){var b,c=new ZeroClipboard(a.$copyBtn[0],{moviePath:JCSDL.zeroClipboard});a.$copyBtn.click(function(){return!1});c.on("complete",
function(){clearTimeout(b);c.setText(null);a.$copyBtn.find("span").html("Copied");b=setTimeout(function(){a.$copyBtn.find("span").html("Copy to Clipboard")},3E3)});c.on("dataRequested",function(){c.setText(a.getValue())})},100)},disable:function(){this.$inputEl.data("jcsdlListEditorEnabled",!1).data("jcsdlTagInputEnabled",!1);this.$inputEl.show();this.$view.hide()},update:function(){this.setValue(this.$inputEl.val())}};d.fn.jcsdlListEditor=function(a){function b(b){var c=b.data("jcsdlListEditor");
c||(c=new JCSDL.ListEditor(b,a),b.data("jcsdlListEditor",c));return c}if("string"===typeof a){if(0<=d.inArray(a,["enable","disable","update"])){var c=[];d.each(arguments,function(a,b){if(!a)return!0;c.push(b)});this.each(function(){var f=b(d(this));f[a].apply(f,c)})}return this}a=d.extend({},{},a);this.each(function(){b(d(this))});return this}});JCSDL.Loader.addComponent(function(d,j){this.GUIFilterEditor=function(a,b,c){b=b||d();c=c||{};var f=this;this.gui=a;this.config=a.config;this.definition=a.definition;this.parser=a.parser;this.inputs=a.inputs;this.getTemplate=a.getTemplate;this.getIconForField=a.getIconForField;this.filter=c;this.steps=[];this.target=null;this.path=[];this.$view=this.getTemplate("filterEditor");this.$steps=this.$view.find(".jcsdl-steps");this.$search=this.getTemplate("filterEditor_search");this.$searchInput=this.$search.find("input");
this.$searchResults=this.$search.find(".jcsdl-search-results");this.config.searchContainer?d(this.config.searchContainer).html(this.$search):this.$view.prepend(this.$search);this.$view.appendTo(b).show();this.addFilterStep("target",this.createTargetSelectView());this.$view.find(".jcsdl-filter-save").hide();this.$view.find(".jcsdl-footer span").hide();this.populateSearch();this.$view.find(".jcsdl-filter-save").bind("click touchstart",function(a){a.preventDefault();a.target.blur();f.didSubmitFilter()});
this.$view.find(".jcsdl-filter-cancel").bind("click touchstart",function(a){a.preventDefault();a.target.blur();f.gui.hideFilterEditor();f.trigger("filterCancel")});this.$searchInput.focus(function(){f.$search.addClass("jcsdl-active");f.$searchResults.show()});this.$searchInput.blur(function(){f.$searchResults.fadeOut(200);f.$search.removeClass("jcsdl-active")});this.$searchInput.keypress(function(a){if(13===a.which)return a=f.$searchResults.find("li.jcsdl-selected"),a.length&&f.selectTarget(a.data("target")),
!1});this.$searchInput.bind("keyup",function(a){if(27===a.which)f.$searchInput.val("").blur(),f.$searchResults.children().show();else if(38===a.which||40===a.which)a.preventDefault();else{a=d.trim(f.$searchInput.val());var b=RegExp("(^|\\s)("+a+"|"+a.replace(/\s/g,".")+")","i"),c=RegExp("(^|\\s)("+a.replace(/\s/g,"|")+")","gi");f.$searchResults.children().quickEach(function(){b.test(this.data("name"))||b.test(this.data("target"))?this.show().find("span").html(this.data("fullname").replace(c,"$1<strong>$2</strong>")):
this.hide()})}});this.$searchInput.bind("keydown",function(a){if(-1!==d.inArray(a.which,[38,40])){a.preventDefault();var b=f.$searchResults.find("li.jcsdl-selected").removeClass("jcsdl-selected"),c=b.length&&b.nextAll("li:visible:first").length?b.nextAll("li:visible:first"):f.$searchResults.find("li:visible:first"),j=b.length&&b.prevAll("li:visible:first").length?b.prevAll("li:visible:first"):f.$searchResults.find("li:visible:last");38===a.which?b=j.addClass("jcsdl-selected"):40===a.which&&(b=c.addClass("jcsdl-selected"));
b.scrollIntoView(f.$searchResults)}});this.$search.find(".jcsdl-search-arrow").click(function(){f.$searchInput.focus();return!1});if(this.config.searchAutofocus)d(document).on("keydown.jcsdlsearch",function(a){48>a.which||90<a.which||d("input:focus, textarea:focus").length||f.$searchInput.focus()});this.loadFilter(c)};this.GUIFilterEditor.prototype={filter:{},jsonpCache:{operators:{},targets:{}},adjust:function(){this.$steps.find(".jcsdl-step").jcsdlCarousel("adjust")},destroy:function(){this.$search.remove();
this.$view.remove();d(document).off("keypress.jcsdlsearch")},loadFilter:function(a){this.filter=a;if(a===j||!a||a.target===j)return!1;this.selectTarget(a.target+"."+a.fieldPath.join("."));var b=this.parser.getFieldInfo(a.target,a.fieldPath);"string"!==typeof b.input&&this.$view.find(".jcsdl-filter-target-field-input .input-"+a.operator).trigger("jcsdlclick");"text"===b.input?d(".jcsdl-dropdown .jcsdl-dropdown-option.operator-"+a.operator).click():this.$view.find(".jcsdl-filter-value-input-operators .operator-"+
a.operator).click();var c=this.$view.find(".jcsdl-filter-value-input-field");this.setValueForField(c,b,a.value,a.operator);a.cs&&this.$view.find(".jcsdl-operator-cs").click()},selectTarget:function(a){var b=this;a=a.split(".");var c=a.shift();this.$view.find(".jcsdl-filter-target .target-"+c).trigger("jcsdlclick");d.each(a,function(a,c){b.$view.find(".jcsdl-filter-target-field:last").find(".field-"+c).trigger("jcsdlclick")})},addFilterStep:function(a,b,c){c=c===j?!0:c;var f=this,e=this.getTemplate("step"),
g=this.steps.length;e.html(b).data("number",g).addClass("jcsdl-filter-step-number-"+g).data("name",a).addClass("jcsdl-filter-step-"+a).appendTo(this.$steps);"target"===a&&e.jcsdlCarousel({select:function(){var a=d(this);e.addClass("selected").find(".jcsdl-carousel-item.selected").removeClass("selected");a.addClass("selected");f.didSelectTarget(a.data("name"))}});"field"===a&&e.jcsdlCarousel({select:function(){var a=d(this);f.$steps.find(".jcsdl-filter-step-target").addClass("field-selected");var c=
e.data("number")-1;f.$steps.find(".jcsdl-filter-step-field.jcsdl-filter-step-number-"+c).addClass("field-selected");e.addClass("selected").find(".jcsdl-carousel-item.selected").removeClass("selected");a.addClass("selected");f.didSelectField(a.data("name"),b,e)}});"input"===a&&e.jcsdlCarousel({select:function(){var a=d(this),c=e.data("number")-1;f.$steps.find(".jcsdl-filter-step-field.jcsdl-filter-step-number-"+c).addClass("field-selected");e.addClass("selected").find(".jcsdl-carousel-item.selected").removeClass("selected");
a.addClass("selected");f.didSelectInput(a.data("name"),b,e)}});"value"===a&&(this.$view.find(".jcsdl-filter-save").fadeIn(this.config.animate),this.$view.find(".jcsdl-footer span").show());c?e.hide().slideDown(this.config.animate):"field"===a?e.find(".jcsdl-filter-target-field").hide().fadeIn(this.config.animate):e.hide().fadeIn(this.config.animate);setTimeout(function(){f.adjust()},this.config.animate);this.steps.push(e)},removeFilterStepsAfterPosition:function(a){this.$steps.find(".jcsdl-step").eq(a).removeClass("field-selected");
a=this.steps.splice(a+1,this.steps.length-a);var b="";this.$view.find(".jcsdl-filter-save").hide();this.$view.find(".jcsdl-footer span").hide();d.each(a,function(a,f){var e=d(f);a||(b=e.data("name"));e.remove()});return b},didSelectTarget:function(a){if(this.definition.targets[a]===j)return!1;this.target=a;this.path=[];var b=this.removeFilterStepsAfterPosition(0),c=this.createFieldSelectionView(this.definition.targets[a].fields);this.addFilterStep("field",c,"field"!==b);this.trigger("targetSelect",
[a])},didSelectField:function(a,b,c){var d=b.data("position");this.path.splice(d,this.path.length-d);c.removeClass("selected-final").find(".jcsdl-target-help").remove();d=this.getFieldInfoAtCurrentPath(a);if(!1!==d){var e=this.removeFilterStepsAfterPosition(b.closest(".jcsdl-step").data("number"));this.path.push(a);d.fields!==j?(b=this.createFieldSelectionView(d.fields),this.addFilterStep("field",b,"field"!==e)):"string"!==typeof d.input?(c="input"!==e,a=this.createInputSelectionView(d.input),this.addFilterStep("input",
a,c)):(a=this.createValueInputView(d),this.addFilterStep("value",a,"value"!==e),this.addTargetHelpToStep(c),this.trigger("targetSelect",[this.getCurrentPath()]))}},didSelectInput:function(a,b,c){b=this.removeFilterStepsAfterPosition(b.closest(".jcsdl-step").data("number"));c.removeClass("selected-final").find(".jcsdl-target-help").remove();a=this.createValueInputView(this.getFieldInfoAtCurrentPath(),a);this.addFilterStep("value",a,"value"!==b);this.addTargetHelpToStep(c)},addTargetHelpToStep:function(a){var b=
this;this.getTemplate("targetHelp").appendTo(a);a.find(".jcsdl-target-help").click(function(a){a.preventDefault();a.target.blur();a=b.getFieldInfoAtCurrentPath();var f=b.target,e=b.parser.getTargetInfo(f),g=b.path.join("-"),h=e.name,m=[];d.each(b.path,function(a,c){m.push(c);h+=" &raquo; "+b.parser.getFieldInfo(f,m).name});var k=g;"augmentation"!==f&&(k=f+"."+k);a=b.config.targetHelpUrl.apply(b,[k.replace(/-/g,"."),a]);var p=d.jcsdlPopup({title:h});b.jsonpCache.targets[k]===j?d.ajax({url:a,type:"GET",
async:!1,jsonpCallback:"jcsdlJSONP",contentType:"application/json",dataType:"jsonp",success:function(a){!a||!a.html||!d.trim(a.html)?(p.setContent("<p>No documentation available.</p>"),p.reposition()):(p.setContent(a.html),p.reposition(),b.jsonpCache.targets[k]=a.html)},error:function(){p.setContent("<p>No documentation available.</p>");p.reposition()}}):(p.setContent(b.jsonpCache.targets[k]),p.reposition())})},didSubmitFilter:function(){var a=this.getFilterInfo();a&&this.gui.didSubmitFilter(a)},
showError:function(a){this.$view.find(".jcsdl-error").remove();var b=this.getTemplate("error");b.find("span").html(a);b.prependTo(this.$view.find(".jcsdl-footer")).hide().fadeIn();window.console!==j&&window.console.error(a,arguments)},trigger:function(a,b){this.gui.trigger(a,b)},createTargetSelectView:function(){var a=this,b=this.getTemplate("target"),c=b.find(".jcsdl-filter-target");d.each(this.definition.targets,function(b,d){a.createOptionForTarget(b,d).appendTo(c)});return b},createOptionForTarget:function(a,
b){var c=this.getTemplate("targetOption").data("name",a).data("target",b).addClass("target-"+a);b.icon==j&&(b.icon="no-icon fa fa-question");c.html('<span class="font-icon '+b.icon+'"></span>'+b.name);this.isTargetVisible(a)||(c.addClass("jcsdl-option-hidden"),(this.filter.target===j||this.filter.target!==a)&&c.hide());return c},createFieldSelectionView:function(a){var b=this,c=this.path.length,f=this.target+(0<this.path.length?"."+this.path.join("."):""),e=this.getTemplate("field"),g=!1,h=d.merge([this.target],
this.path),j="";e.data("position",c).addClass("field-select-"+c);d.each(h,function(a,c){j=j+(0<a?".":"")+c;if(!b.isTargetVisible(j))return g=!0});var k=e.find(".jcsdl-filter-target-field");d.each(a,function(a,c){b.createOptionForField(a,c,f,g).appendTo(k)});return e},createOptionForField:function(a,b,c,f){b.icon==j&&(b.icon="no-icon fa fa-question");var e=this;b=this.getTemplate("fieldOption").data("name",a).data("field",b).html('<span class="font-icon '+b.icon+'"></span>'+b.name).addClass("field-"+
a);if(!f){var g=c+"."+a;if(this.isTargetVisible(g)){var g=g.split("-"),h="";d.each(g,function(a,b){h+=(0<a?".":"")+b;if(!e.isTargetVisible(h))return f=!0})}else f=!0}f&&b.addClass("jcsdl-option-hidden");f&&this.filter&&this.filter.target!==j&&this.filter.fieldPath!==j&&this.filter.target+"."+this.filter.fieldPath.join(".").replace(/-/g,".")===c+"."+a&&(f=!1);f&&b.hide();return b},createInputSelectionView:function(a){var b=this,c=this.getTemplate("inputSelect"),f=c.find(".jcsdl-filter-target-field-input");
d.each(a,function(a,c){b.createOptionForInput(c).appendTo(f)});return c},createOptionForInput:function(a){return this.getTemplate("inputSelectOption").data("name",a).addClass("icon-"+a+" input-"+a).html(a)},createValueInputView:function(a,b){b=b||a.input;var c=this.getTemplate("valueInput");if(this.inputs[b]===j)return c;var d=this.inputs.exec(b,"init",[a]),d=c.find(".jcsdl-filter-value-input-field").data("inputType",b).html(d),e=c.find(".jcsdl-filter-value-input-operators");"text"===b?this.createTextOperatorsSelectView(e,
a,b,d):this.createOperatorsSelectView(e,a,b,d);return c},createOperatorsSelectView:function(a,b,c,f){var e=this,g=f.find("input:first"),h=this.definition.inputs[c]!==j?this.definition.inputs[c]:{},m=h.operators!==j?h.operators:[];d.each(b.operators,function(b,c){if(0<m.length&&-1===d.inArray(c,m))return!0;var f=e.createOperatorOptionView(c);d("html").is(".msie")&&f.html("&nbsp;");a.append(f)});a.children().bind("click touchstart",function(b){b.preventDefault();b.target.blur();var j=d(this);b=j.data("name");
a.children().removeClass("selected");j.addClass("selected");"exists"===b?f.fadeOut(e.config.animate):f.is(":visible")||f.fadeIn(e.config.animate);"number"===c&&(j=0<=d.inArray(b,h.arrayOperators)?"enable":"disable",g.jcsdlTagInput(j));e.trigger("operatorSelect",[b])});1===a.children().length?(a.children().eq(0).click(),a.children().hide()):(b=a.find(".operator-"+(b.operator!==j?b.operator:h.operator)),0<b.length?b.click():a.find(".operator:not(.operator-exists):first").click());return a},createTextOperatorsSelectView:function(a,
b,c,f){var e=this;d(".jcsdl-dropdown").remove();a.addClass("text");var g=f.find("input.orig"),h=this.getTemplate("textOperatorsSelect"),m=this.getTemplate("textOperatorsDropdown"),k=this.definition.inputs[c]!==j?this.definition.inputs[c]:{},p=k.operators!==j?k.operators:[];d.each(b.operators,function(a,b){if(0<p.length&&-1===d.inArray(b,p))return!0;var c=e.createTextOperatorOptionView(b);m.append(c)});a.html(h).insertAfter(f);m.hide().insertAfter(a);if(b.cs){var n=this.getTemplate("caseSensitivity");
n.bind("click touchstart",function(a){a.preventDefault();a.target.blur();d(this).toggleClass("selected");e.trigger("caseSensitivityChange",[d(this).is(".selected")])}).tipsy({gravity:"s",offset:9});n.prependTo(a);h.addClass("has-cs")}h.click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();h.hasClass("active")?(m.slideUp(e.config.animate),h.removeClass("active")):(m.css({width:h.outerWidth()-2}).slideDown(e.config.animate),h.addClass("active"),d("body").bind("click.jcsdldropdown",
function(a){a=d(a.target).closest(".jcsdl-dropdown");if(null===a||!a.is(".jcsdl-dropdown"))h.removeClass("active"),m.slideUp(e.config.animate),d("body").unbind("click.jcsdldropdown")}))});m.find(".jcsdl-dropdown-details-trigger, .jcsdl-operator-help").click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();a=d(this).closest(".jcsdl-dropdown-option");var b=a.data("name"),c=d.jcsdlPopup({title:a.data("title")});e.jsonpCache.operators[b]===j?d.ajax({url:a.data("jsonp"),type:"GET",async:!1,
jsonpCallback:"jcsdlJSONP",contentType:"application/json",dataType:"jsonp",success:function(a){!a||!a.html||!d.trim(a.html)?(c.setContent("<p>No documentation available.</p>"),c.reposition()):(c.setContent(a.html),c.reposition(),e.jsonpCache.operators[b]=a.html)}}):(c.setContent(e.jsonpCache.operators[b]),c.reposition())});m.find(".jcsdl-dropdown-option").click(function(a){a.preventDefault();a.target.blur();h.removeClass("active");m.hide();a=d(this).data("name");var c=e.definition.operators[a];h.data("operator",
a).find(".jcsdl-operator-label").html(c.label);"exists"===a?(f.fadeOut(e.config.animate),b.cs&&n.fadeOut(e.config.animate)):f.is(":visible")||(f.fadeIn(e.config.animate),b.cs&&n.fadeIn(e.config.animate));"contains_near"===a?(f.find(".jcsdl-containsnear-distance").fadeIn(),f.find(".jcsdl-list-add-input").bind("keydown.nospace",function(a){32===a.which&&a.preventDefault()}),g.data("split",!0)):(f.find(".jcsdl-containsnear-distance").hide(),f.find(".jcsdl-list-add-input").unbind("keydown.nospace"),g.data("split")&&
g.data("split",!1));c=0<=d.inArray(a,k.arrayOperators)?"enable":"disable";g.jcsdlListEditor(c);"enable"===c&&g.jcsdlListEditor("update");c=0<=d.inArray(a,["regex_partial","regex_exact"])?"enable":"disable";g.jcsdlRegExTester(c);"enable"===c&&(g.jcsdlRegExTester("set"+("regex_partial"===a?"Partial":"Exact")),g.jcsdlRegExTester("test"));e.trigger("operatorSelect",[a])});d(window).resize(function(){h.hasClass("active")&&m.css({width:h.outerWidth()-2})});1===m.find(".jcsdl-dropdown-option").length?m.find(".jcsdl-dropdown-option:first").click():
(c=m.find(".jcsdl-dropdown-option.operator-"+(b.operator!==j?b.operator:k.operator)),0<c.length?c.click():m.find(".jcsdl-dropdown-option:not(.operator-exists):first").click());return a},createOperatorOptionView:function(a){var b=this.definition.operators[a];return b===j?d():this.getTemplate("operatorOption").data("name",a).addClass("icon-"+a+" operator-"+a).attr("title",b.description).html(b.label).tipsy({gravity:"s",offset:9})},createTextOperatorOptionView:function(a){var b=this.definition.operators[a];
if(b===j)return d();var c=this.getTemplate("textOperatorOption").data("name",a).data("title",b.label).addClass("operator-"+a);c.find(".jcsdl-icon").addClass("icon-"+a+" operator-"+a+" selected");c.find(".jcsdl-operator-label span").html(b.label);c.find(".jcsdl-operator-desc").html(b.description);b.jsonp?c.data("jsonp",b.jsonp):(c.find(".jcsdl-dropdown-details-trigger").remove(),c.find(".jcsdl-operator-help").remove());return c},setValueForField:function(a,b,c,f){var e=this,g=a.data("inputType");if(this.inputs[g]===
j)return!1;if(0<=d.inArray(g,["geo_box","geo_radius","geo_polygon"])){var h=jcsdlMapsCurrentGui,m=jcsdlMapsCurrentCallback,k=jcsdlMapsCurrentCallbackArgs;jcsdlMapsCurrentCallback=function(){h&&m&&setTimeout(function(){m.apply(h.inputs,k);e.inputs.exec(g,"setValue",[a,b,c,f])},h.config.animate+10)}}else this.inputs.exec(g,"setValue",[a,b,c,f]);return!0},getValueFromField:function(a,b,c){var d=a.data("inputType");return this.inputs[d]===j?"":this.inputs.exec(d,"getValue",[a,b,c])},populateSearch:function(){var a=
this,b=function(c,f,e,g){e=e.length?e+"."+c:c;g=g.length?g+"|"+f.name:f.name;a.isTargetVisible(e)&&(f.fields!==j?d.each(f.fields,function(a,c){b(a,c,e,g)}):(c=a.getTemplate("filterEditor_searchItem"),c.data("name",g.replace(/\|/g," ")).data("fullname",g.replace(/\|/g," &raquo; ")).data("target",e).find("span").html(c.data("fullname")),c.find(".jcsdl-icon").addClass("target-"+e.split(".")[0]),c.click(function(){a.selectTarget(e);return!1}),c.appendTo(a.$searchResults)))};d.each(this.definition.targets,
function(a,d){b(a,d,"","")})},getView:function(){return this.$view},getFilterInfo:function(){var a=this.getFieldInfoAtCurrentPath(),b="text"===a.input?this.$view.find(".jcsdl-filter-value-input-operators .jcsdl-operators-select").data("operator"):this.$view.find(".jcsdl-filter-value-input-operators .operator.selected").data("name");if(b===j)this.showError("You need to select an operator!");else{var c="";if("exists"!==b&&(c=this.$view.find(".jcsdl-filter-value-input-field"),c=this.getValueFromField(c,
a,b),!c.length)){this.showError("You need to specify a value!");return}return{target:this.target,path:this.path,operator:b,value:c,additional:{cs:"exists"!==b&&a.cs&&0<this.$view.find(".jcsdl-operator-cs.selected").length?!0:!1}}}},getFieldInfoAtCurrentPath:function(a){var b=this.path.slice(0);"string"===typeof a&&b.push(a);return this.parser.getFieldInfo(this.target,b)},getCurrentPath:function(){return this.target+(0<this.path.length?".":"")+this.path.join(".").replace(/-/g,".")},isTargetVisible:function(a){if(!a)return!1;
var b=this.config.showTargets;if(b.length){if(0<=d.inArray(a,b))return!0;for(var c=a.split(".");c.length;){if(0<=d.inArray(c.join("."),b))return!0;c.pop()}a+=".";for(c=0;c<b.length;c++)if(0===b[c].indexOf(a))return!0;return!1}return-1===d.inArray(a,this.config.hideTargets)}}});JCSDL.Loader.addComponent(function(d,j){this.GUILogic=function(a,b){var c=this;this.gui=a;this.config=a.config;this.parser=a.parser;this.getTemplate=a.getTemplate;this.$logicOptions=a.$mainView.find(".jcsdl-filters-logic .jcsdl-filters-logic-option:not(.jcsdl-advanced-option)");this.$advancedOptions=a.$mainView.find(".jcsdl-filters-logic .jcsdl-filters-logic-option.jcsdl-advanced-option");this.$insertBracketsButton=this.$advancedOptions.filter(".jcsdl-advanced-add-brackets");this.$insertNotOperatorButton=
this.$advancedOptions.filter(".jcsdl-advanced-add-not");this.$editor=a.$mainView.find(".jcsdl-advanced-container");this.$guiContainer=this.initGui(this.$editor.find(".jcsdl-advanced-gui-container"));this.$gui=this.$guiContainer.find(".jcsdl-advanced-gui");this.$manual=this.$editor.find(".jcsdl-advanced-manual");this.$manualInput=this.initManualInput(this.$manual.find("input"));this.$logicOptions.click(function(a){a.preventDefault();a.target.blur();a=d(this);if(a.is(".disabled")||a.is(".active"))return!1;
var b=c.logic;c.logic=a.data("logic");c.didSetLogic(b,!1)});this.$logicOptions.filter(".jcsdl-advanced").find(".jcsdl-logic-help").tipsy({gravity:"s",trigger:"manual",title:function(){return c.$editor.is(":visible")?d(this).data(c.$manual.is(":visible")?"textManual":"textGui"):d(this).data("textGeneral")}}).click(function(a){a.preventDefault();a.target.blur();a.stopPropagation();var b=d(this);b.tipsy("show");d("body").one("click",function(){b.tipsy("hide")})});this.$advancedOptions.filter(".jcsdl-advanced-manual-edit").click(function(a){a.preventDefault();
a.target.blur();a=d(this);if(a.is(".on")){try{c.validate(c.getManualString())}catch(b){c.showError(b);return}a.removeClass("on");a.html(a.data("textGui"));c.$manualInput.blur();c.$manual.hide();c.$guiContainer.fadeIn(c.config.animate);c.$insertBracketsButton.removeClass("disabled");c.$insertNotOperatorButton.removeClass("disabled");c.setGuiString();c.trigger("graphicalLogic")}else{try{c.validate(c.getGuiString())}catch(f){c.showError(f);return}a.addClass("on");a.html(a.data("textManual"));c.setManualString();
c.$guiContainer.hide();c.$manual.fadeIn(c.config.animate);c.$manualInput.focus();c.$insertBracketsButton.addClass("disabled");c.$insertNotOperatorButton.addClass("disabled");c.trigger("manualLogic")}});try{this.setLogic(b,!0)}catch(f){this.showError(f,!0)}};this.GUILogic.prototype={ADVANCED:"ADVANCED",AND:"AND",OR:"OR",tokenize:function(a){a=a||this.logicString;return this.parser.tokenizeLogicString(a)},validate:function(a,b){a=a||this.logicString;b=b||this.gui.filters;return this.parser.validateLogic(a,
b)},showEditor:function(){this.$editor.show();this.adjustGui();this.$editor.hide().slideDown(this.config.animate);this.gui.$mainView.addClass("jcsdl-advanced-on")},hideEditor:function(){this.$editor.slideUp(this.config.animate);this.gui.$mainView.removeClass("jcsdl-advanced-on")},toggleButtons:function(a){(a=a===j?!0:a)||this.setLogic(this.AND);this.$logicOptions[a?"removeClass":"addClass"]("disabled")},showError:function(a,b){b=b||!1;this.clearErrors();var c=a instanceof JCSDL.LogicValidationException?
a.message:a,d=this.getTemplate("error");d.find("span").html(c);d.insertAfter(this.$editor).show();b||this.trigger("logicError",[a]);b||(this.trigger("logicError",[a]),console!==j&&console.error(a,arguments));a instanceof JCSDL.LogicValidationException&&this.$gui.is(":visible")&&0<=a.index&&(c=this.$gui.children().not(".jcsdl-token-ph").eq(a.index).find(".jcsdl-logic-token").addClass("jcsdl-logic-error"),this.scrollGuiToToken(c));d.animateIntoView(this.config.animate)},trigger:function(a,b){this.gui.trigger(a,
b)},clearErrors:function(){this.gui.clearErrors();this.$gui.find(".jcsdl-logic-error").removeClass("jcsdl-logic-error")},initGui:function(a){var b=this,c=a.find(".jcsdl-advanced-gui"),f=null;this.$guiLeft=a.find(".jcsdl-advanced-gui-arrow.left");this.$guiRight=a.find(".jcsdl-advanced-gui-arrow.right");c.sortable({cursor:"move",placeholder:"jcsdl-token-ph",containment:a,appendTo:a,helper:"clone",tolerance:"intersect",start:function(a,b){b.item.find(".jcsdl-logic-token").is(".bracket")&&c.find(".jcsdl-token-ph").addClass("bracket")},
stop:function(a,c){var d=c.item.find(".jcsdl-logic-token");d.is(".filter")&&b.gui.highlightFilter(d.data("token"),!1)},sort:function(a,c){clearInterval(f);b.$guiRight.is(":visible")&&c.offset.left+c.helper.width()/2>=b.$guiRight.offset().left&&(f=setInterval(function(){b.scrollGui("right",50)},50));b.$guiLeft.is(":visible")&&c.offset.left<=b.$guiLeft.offset().left+c.helper.width()/2&&(f=setInterval(function(){b.scrollGui("left",50)},50));var d=c.helper.find(".jcsdl-logic-token");d.is(".filter")&&
b.gui.highlightFilter(d.html())},update:function(){clearInterval(f);setTimeout(function(){b.updateFromGui();var a=b.getGuiString();b.trigger("graphicalLogicTokenMove",[a]);b.trigger("graphicalLogicChange",[a]);b.trigger("advancedLogicChange",[a])},100)}});(c.data("sortable")||{}).floating=!0;(c.data("uiSortable")||{}).floating=!0;this.$insertBracketsButton.click(function(a){a.preventDefault();a.target.blur();if(d(this).is(".disabled"))return!1;b.addGuiToken(")",!0,!0);b.updateFromGui();a=b.getGuiString();
b.trigger("parenthesisAdd",[a]);b.trigger("graphicalLogicChange",[a]);b.trigger("advancedLogicChange",[a])});this.$insertNotOperatorButton.click(function(a){a.preventDefault();a.target.blur();if(d(this).is(".disabled"))return!1;b.addGuiToken("!",!0,!0);b.updateFromGui();a=b.getGuiString();b.trigger("notOperatorAdd",[a]);b.trigger("graphicalLogicChange",[a]);b.trigger("advancedLogicChange",[a])});this.$guiRight.add(this.$guiLeft).bind("mousedown touchstart",function(){var a=d(this).is(".right")?"right":
"left";f=setInterval(function(){b.scrollGui(a,50)},50)}).bind("mouseup mouseleave touchend",function(){clearInterval(f)}).click(function(a){a.preventDefault();a.target.blur()});d(window).resize(function(){b.adjustGui()});return a},updateFromGui:function(){var a=this.getGuiTokens();try{this.validate(a)&&(this.clearErrors(),this.logicString=a.join(""))}catch(b){this.showError(b,!0)}},setGuiString:function(a){a=a||this.logicString;var b=this;a="string"===typeof a||"number"===typeof a?this.tokenize(a):
a;this.clearGui();d.each(a,function(a,d){b.addGuiToken(d,!1)})},getGuiString:function(a){a=a||this.$gui;var b="";a.find(".jcsdl-logic-token").each(function(){b+=""+d(this).data("token")});return b},getGuiTokens:function(a){a=a||this.$gui;var b=[];a.find(".jcsdl-logic-token").each(function(){b.push(d(this).data("token"))});return b},clearGui:function(){this.$gui.width(0).children().remove()},tokensMap:{"(":"bracketOpen",")":"bracketClose","&":"operatorAnd","|":"operatorOr","!":"operatorNot",filter:"filter"},
addGuiToken:function(a,b,c){b=b===j?!0:b;c=c===j?!1:c;var f=this,e="number"==typeof a?"filter":a;if(this.tokensMap[e]===j)throw'Invalid character "'+a+'" in the logic!';var g=this.getTemplate("logicToken_"+this.tokensMap[e]).data("token",a),h=d();"filter"==e&&g.html(a);e=d('<li class="jcsdl-logic-token-wrap" />').html(g)["!"===a&&c?"prependTo":"appendTo"](this.$gui);this.$gui.width(this.$gui.width()+e.outerWidth(!0));if(")"==a&&c){h=this.getTemplate("logicToken_bracketOpen").data("token","(");a=this.getGuiTokens().reverse();
var m=a.length,k=-1,p=null;d.each(a,function(a,b){")"==b?k++:"("==b&&k--;if(0==k&&0<=d.inArray(b,["&","|"])){if(null!==p&&b!==p)return m=a,!1;p=b}});a=this.$gui.children().eq(a.length-m);a=d('<li class="jcsdl-logic-token-wrap" />').html(h).insertBefore(a);this.$gui.width(this.$gui.width()+a.outerWidth(!0))}this.updateFromGui();this.adjustGui();b&&this.scrollGuiToToken(g);g.click(function(a){a.preventDefault();a.target.blur();"&"==g.data("token")?(g.data("token","|").html("OR"),f.trigger("logicOperatorSwitch",
["OR"]),a=f.getGuiString(),f.trigger("graphicalLogicChange",[a]),f.trigger("advancedLogicChange",[a])):"|"==g.data("token")&&(g.data("token","&").html("AND"),f.trigger("logicOperatorSwitch",["AND"]),a=f.getGuiString(),f.trigger("graphicalLogicChange",[a]),f.trigger("advancedLogicChange",[a]));f.updateFromGui()});g.add(h).find(".jcsdl-delete-token").click(function(a){a.preventDefault();a.target.blur();a.stopPropagation(!0);f.deleteGuiToken(g);a=f.getGuiString();var b="!"===g.data("token")?"notOperatorDelete":
"parenthesisDelete";f.trigger(b,[a]);f.trigger("graphicalLogicChange",[a]);f.trigger("advancedLogicChange",[a])});g.filter(".filter").hover(function(){f.gui.highlightFilter(d(this).data("token"))},function(){f.gui.highlightFilter(d(this).data("token"),!1)})},deleteGuiFilterToken:function(a){a=parseInt(a);var b=d(),c=d();this.$gui.children().each(function(){var c=d(this);if(parseInt(c.find(".jcsdl-logic-token").data("token"))===a)return b=c,!1});if(!b.length)return!1;for(;"("==b.prev().find(".jcsdl-logic-token").data("token")&&
")"==b.next().find(".jcsdl-logic-token").data("token");)b.prev().remove(),b.next().remove();b.prev().find(".jcsdl-logic-token.operator").length?c=b.prev():b.next().find(".jcsdl-logic-token.operator").length&&(c=b.next());b.remove();c.remove();this.updateFromGui();c=this.getGuiString();this.trigger("graphicalLogicChange",[c]);this.trigger("advancedLogicChange",[c])},deleteGuiToken:function(a){var b=a.is(".jcsdl-logic-token")?a.closest("li.jcsdl-logic-token-wrap"):a;if(!b.is("li.jcsdl-logic-token-wrap"))return!1;
a=b.find(".jcsdl-logic-token");if(a.is(".operator")&&"!"!==a.data("token"))return!1;if(a.is(".filter")){var c=a.data("token"),f=!1;d.each(this.gui.filters,function(a,b){if(parseInt(b.id)==parseInt(c))return f=!0,!1});if(f)return!1}else if(a.is(".bracket")){var e=this.getGuiTokens(),g=this.$gui.children().index(b),h=null,j=0,k=0,p=")",n="(",q=")";")"==a.data("token")&&(e=e.reverse(),g=e.length-1-g,p="(",n=")",q="(");d.each(e,function(a,b){if(a==g)return k=j,!0;if(null!==k&&j==k&&a>g&&b==p)return h=
"("==p?e.length-1-a:a,!1;b==n?j++:b==q&&j--});null!==h&&(a=this.$gui.children().filter(".jcsdl-logic-token-wrap").eq(h),this.$gui.width(this.$gui.width()-a.outerWidth(!0)),a.remove())}this.$gui.width(this.$gui.width()-b.outerWidth(!0));b.remove();this.updateFromGui();this.adjustGui()},_adjustGuiTimeout:null,adjustGui:function(){var a=this,b=0;this.$gui.children().each(function(){b+=parseInt(d(this).outerWidth(!0))});this.$gui.width(b).css("minWidth",parseInt(0.9*this.$gui.parent().width(),10));clearTimeout(this._adjustGuiTimeout);
this._adjustGuiTimeout=setTimeout(function(){var b=a.$gui.width(),d=a.$guiContainer.width();b>d?a.$guiRight.removeClass("off"):(a.$guiLeft.add(a.$guiRight).addClass("off"),a.scrollGuiToStart())},50)},scrollGui:function(a,b){b=b==j?50:b;var c=-1*Math.max(0,this.$gui.width()-this.$guiContainer.width()),d=0,e=this,d="number"===typeof a?a:parseInt(this.$gui.css("left"))+("right"==a?-30:30),d=Math.max(Math.min(0,d),c);this.$gui.stop(!0,!0).animate({left:d},b,function(){e.$guiLeft[0==d?"addClass":"removeClass"]("off");
e.$guiRight[d==c?"addClass":"removeClass"]("off")})},scrollGuiToStart:function(){this.scrollGui(0)},scrollGuiToEnd:function(){this.scrollGuiToToken(this.$gui.children().last())},scrollGuiToToken:function(a){a=a.is(".jcsdl-logic-token")?a.closest("li.jcsdl-logic-token-wrap"):a;if(!a.is("li.jcsdl-logic-token-wrap"))return!1;a=-1*a.position().left;parseInt(this.$gui.css("left"));this.scrollGui(a+140)},initManualInput:function(a){var b=this,c=null;a.keyup(function(){clearTimeout(c);c=setTimeout(function(){var c=
a.val();b.logicString!==c&&(b.trigger("manualLogicChange",[c]),b.trigger("advancedLogicChange",[c]));try{b.validate(c)&&(b.clearErrors(),b.logicString=c)}catch(d){b.showError(d,!0)}},500)});a.keydown(function(a){var b=a.which,c=a.shiftKey;8==b||(37<=b&&40>=b||46==b||48<=b&&57>=b&&!c||96<=b&&105>=b||57==b&&c||48==b&&c||32==b||55==b&&c||220==b&&c||49==b&&c)||a.preventDefault()});a.keypress(function(a){13==a.which&&a.preventDefault()});return a},setManualString:function(a){a=a||this.logicString;a="string"===
typeof a||"number"===typeof a?this.tokenize(a):a;this.$manualInput.val(a.join(" "))},getManualString:function(){return this.$manualInput.val()},setLogic:function(a,b){b=b||!1;var c=this.logic;this.logic=-1<d.inArray(a,[this.AND,this.OR])?a:this.ADVANCED;var f="";if(this.logic==this.ADVANCED)f=a;else{var e=[];d.each(this.gui.filters,function(a,b){e.push(b.id)});f=e.join(this.logic==this.OR?"|":"&")}this.setLogicString(f);this.didSetLogic(c,b)},getLogic:function(){return this.logic},setLogicString:function(a){this.logicString=
""+a;this.setGuiString(a);this.setManualString(a)},appendFilterToLogicString:function(a,b){b=b||this.logic;b=b==this.OR?"|":"&";var c=this.logicString.length?this.logicString+b+a:a;this.trigger("manualLogicChange",[c]);this.trigger("graphicalLogicChange",[c]);this.trigger("advancedLogicChange",[c]);this.setLogicString(c)},getLogicString:function(){return this.logic==this.ADVANCED?this.logicString:this.logic},didSetLogic:function(a,b){a=a||"";b=b||!1;this.$logicOptions.removeClass("active").filter('[data-logic="'+
this.logic+'"]').addClass("active");this.logic==this.ADVANCED?(this.showEditor(),this.$logicOptions.not(".jcsdl-advanced").each(function(){var a=d(this);a.html(a.data("textShort"))}),this.$advancedOptions.fadeIn(this.config.animate)):(this.clearErrors(),this.hideEditor(),this.$logicOptions.not(".jcsdl-advanced").each(function(){var a=d(this);a.html(a.data("textLong"))}),this.$advancedOptions.hide());!b&&this.logic!==a&&this.trigger("logicChange",[this.logic])}}});JCSDL.Loader.addComponent(function(d,j){this.GUI=function(a,b){var c=d(a);if(0==c.length)return!1;this.$el=c.eq(0);this.$container=null;this.config=d.extend(!0,{animate:200,cancelButton:!0,saveButton:null,searchContainer:null,searchAutofocus:!1,googleMapsApiKey:"",mapsOverlay:{strokeWeight:0,fillColor:"#7585dd",fillOpacity:0.5},mapsMarker:null,zeroClipboard:null,hideTargets:[],showTargets:[],definition:{},change:function(){},save:function(){},saveError:function(){},cancel:function(){this.hide()},
invalidJCSDL:function(){},viewModeChange:function(){},filterNew:function(){},filterEdit:function(){},filterDelete:function(){},filterSave:function(){},filterCancel:function(){},targetSelect:function(){},operatorSelect:function(){},caseSensitivityChange:function(){},logicChange:function(){},logicError:function(){},advancedLogicChange:function(){},manualLogic:function(){},manualLogicChange:function(){},graphicalLogic:function(){},graphicalLogicChange:function(){},graphicalLogicTokenMove:function(){},
parenthesisAdd:function(){},parenthesisDelete:function(){},logicOperatorSwitch:function(){},targetHelpUrl:function(a,b){if(b.helpUrl)return b.helpUrl;a=a.replace(/\./g,"-");return this.definition.targetHelpJsonpSource.replace(/\{target\}/g,a)}},b);this.definition=d.extend(!0,JCSDLDefinition,this.config.definition);this.parser=new JCSDL.Parser(this);this.logic=null;this.inputs=new JCSDL.GUIInputs(this);this.filters=[];this.$filtersList=this.$mainView=this.currentFilterIndex=null;this.init()};this.GUI.prototype=
{changeEvents:["filterNew","filterDelete","filterSave","logicChange","advancedLogicChange"],init:function(){var a=this;this.filters=[];this.currentFilterIndex=null;this.$mainView=this.getTemplate("editor");this.$filtersList=this.$mainView.find(".jcsdl-filters-list");this.$container=this.getTemplate("container");this.$container.html(this.$mainView);this.$el.html(this.$container);this.$saveButton=this.$mainView.find(".jcsdl-editor-save");this.$previewButton=this.$mainView.find(".jcsdl-editor-preview");
this.$cancelButton=this.$mainView.find(".jcsdl-editor-cancel");if(!1===this.config.saveButton)this.$saveButton.remove();else if(this.config.saveButton&&("object"==typeof this.config.saveButton||"string"==typeof this.config.saveButton))this.$saveButton.remove(),this.$saveButton=d(this.config.saveButton);if(this.config.cancelButton&&("object"==typeof this.config.cancelButton||"string"==typeof this.config.cancelButton))this.$cancelButton.remove(),this.$cancelButton=d(this.config.cancelButton);this.config.cancelButton||
this.$cancelButton.hide();var b=/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];b[1]!==j&&"msie"===b[1]&&(this.$container.addClass("msie"),d("html").addClass("msie"));this.logic=new JCSDL.GUILogic(this,JCSDL.GUILogic.prototype.AND);var b=this.$mainView.find(".jcsdl-elements-sprite:first").css("background-image").replace(/url\((\'|\")?/,"").replace(/(\'|\")?\)$/,""),c=document.createElement("a");c.href=b;b=c.pathname.split("/");b.pop();b.pop();this.assetsUrl=b.join("/")+"/";this.config.mapsMarker||
(this.config.mapsMarker=this.assetsUrl+"img/maps-marker.png");this.config.zeroClipboard||(this.config.zeroClipboard=this.assetsUrl+"swf/ZeroClipboard.swf");JCSDL.zeroClipboard=this.config.zeroClipboard;this.$mainView.find(".jcsdl-mainview-mode .jcsdl-mainview-mode-option").bind("click touchstart",function(b){b.preventDefault();b.target.blur();b=d(this);var c=b.attr("data-mode");a.$filtersList.removeClass("expanded collapsed");a.$filtersList.addClass(c);a.$mainView.find(".jcsdl-mainview-mode .jcsdl-mainview-mode-option").removeClass("active");
b.addClass("active");a.trigger("viewModeChange",[c])});this.$mainView.find(".jcsdl-add-filter").bind("click touchstart",function(b){b.preventDefault();b.target.blur();a.showFilterEditor()});this.$saveButton.unbind(".jcsdl").bind("click.jcsdl touchstart.jcsdl",function(b){b.preventDefault();b.target.blur();try{var c=a.returnJCSDL();a.trigger("save",[c])}catch(d){a.showError(d),a.trigger("saveError",[d instanceof JCSDL.LogicValidationException?d.message:d])}});this.$previewButton.unbind(".jcsdl").bind("click.jcsdl touchstart.jcsdl",
function(b){b.preventDefault();b.target.blur();try{var c=a.returnJCSDL().split("\n"),g=[];d.each(c,function(a,b){"//"!==b.substr(0,2)&&g.push(b)});var h=g.join("\n"),j="jcsdl-copy-to-clipboard-"+Math.floor(1E4*Math.random());d.jcsdlPopup({title:"CSDL Preview",content:["<p>"+a.highlightCSDL(h)+"</p>",'<a href="#" id="'+j+'" class="jcsdl-btn jcsdl-copy-to-clipboard"><i class="jcsdl-picto jcsdl-elements-sprite"></i></a>'].join("")});var k=d("#"+j).attr("data-clipboard-text",h),p=new ZeroClipboard(k[0],
{moviePath:a.config.zeroClipboard});k.click(function(){return!1});p.on("complete",function(){clearTimeout(void 0);k.addClass("copied");setTimeout(function(){k.removeClass("copied")},3E3)})}catch(n){a.showError(n)}return!1});this.$cancelButton.unbind(".jcsdl").bind("click.jcsdl touchstart.jcsdl",function(b){b.preventDefault();b.target.blur();a.trigger("cancel")})},reset:function(){this.init()},loadJCSDL:function(a){this.init();var b=this;try{var c=this.parser.parseJCSDL(a);this.filters=c.filters;2<=
this.filters.length&&this.logic.toggleButtons();this.logic.setLogic(c.logic,!0)}catch(f){return a=f instanceof JCSDL.ValidationException?f.code:a,this.showError(f,a),this.trigger("invalidJCSDL",[a]),!1}d.each(this.filters,function(a,c){b.createFilterRow(c).appendTo(b.$filtersList)});this.filters.length&&this.$mainView.find(".jcsdl-footer").show();this.config.cancelButton&&this.$cancelButton.show()},returnJCSDL:function(){return this.parser.getJCSDLForFilters(this.filters,this.logic.getLogicString())},
adjust:function(){this.editor&&this.editor.adjust()},hide:function(){this.$container.hide()},show:function(){this.$container.show()},trigger:function(a,b){b=b||[];this.$el.trigger(a.toLowerCase(),b);if("function"==typeof this.config[a])return this.config[a].apply(this,b);-1<d.inArray(a,this.changeEvents)&&this.trigger("change");return null},showFilterEditor:function(a,b){this.$mainView.hide();this.editor=new JCSDL.GUIFilterEditor(this,this.$container,a);if(a!==j&&a)this.currentFilterIndex=b,this.trigger("filterEdit",
[a]);else{this.trigger("filterNew");var c=this.filters[this.filters.length-1];c!==j&&this.editor.getView().find(".jcsdl-filter-target .target-"+c.target+":visible").trigger("jcsdlclick")}},hideFilterEditor:function(a){a="function"==typeof a?a:d.noop;var b=this;this.currentFilterIndex=null;this.editor.getView().fadeOut(this.config.animate,function(){b.editor.destroy();b.$mainView.show();b.editor=null;a.apply(b,[])})},didSubmitFilter:function(a){var b=this,c=d.noop,f=null!==this.currentFilterIndex?
this.filters[this.currentFilterIndex].id:this.createFilterId(),e=this.parser.createFilter(a.target,a.path,a.operator,a.value,a.additional,f);a=this.createFilterRow(e);null!==this.currentFilterIndex?(this.$filtersList.find(".jcsdl-filter.filter-"+e.id).replaceWith(a),this.filters[this.currentFilterIndex]=e):(a.appendTo(this.$filtersList),this.filters.push(e),c=function(){b.logic.appendFilterToLogicString(e.id)});this.filters.length&&this.$mainView.find(".jcsdl-footer").fadeIn(this.config.animate);
2<=this.filters.length&&this.logic.toggleButtons();this.hideFilterEditor(c);this.trigger("filterSave",[e])},deleteFilter:function(a){var b=this.filters[a];this.$filtersList.find(".jcsdl-filter.filter-"+b.id).remove();this.filters.splice(a,1);this.logic.deleteGuiFilterToken(b.id);this.trigger("filterDelete",[b]);this.filters.length||this.$mainView.find(".jcsdl-footer").fadeOut(this.config.animate);2>this.filters.length&&this.logic.toggleButtons(!1)},showError:function(a,b){if(a instanceof TypeError)throw a;
this.clearErrors();if(a instanceof JCSDL.LogicValidationException)return this.logic.showError(a);var c=a instanceof JCSDL.ValidationException?a.message:a,d=this.getTemplate("error");d.find("span").html(c);d.insertBefore(this.$mainView.find(".jcsdl-footer"));d.hide().fadeIn();console!==j&&console.error(c,arguments);d.animateIntoView(this.config.animate)},clearErrors:function(){this.$mainView.find(".jcsdl-error").remove()},createFilterRow:function(a){var b=this,c=this.getTemplate("filter");c.addClass("filter-"+
a.id).data("filterId",a.id).find(".jcsdl-filter-info.id").html(a.id);var f=this.parser.getTargetInfo(a.target);f.icon==j&&(f.icon="no-icon fa fa-question");f=this.getTemplate("filterTarget").addClass("target-"+a.target).html('<span class="font-icon '+f.icon+'"></span>'+f.name);c.find(".target").html(f);var e=[];d.each(a.fieldPath,function(d,f){e.push(f);var g=b.parser.getFieldInfo(a.target,e);g.icon==j&&(g.icon="no-icon fa fa-question");g=b.getTemplate("filterField").html('<span class="font-icon '+
g.icon+'"></span>'+g.name);c.find(".jcsdl-filter-info.field").append(g)});var f=this.parser.getFieldInfo(a.target,e),g=this.getTemplate("filterOperator").addClass("operator-"+a.operator+" icon-"+a.operator+" selected").attr("title",this.definition.operators[a.operator].description).html(this.definition.operators[a.operator].code.escapeHtml()).tipsy({gravity:"s",offset:9});c.find(".operator").html(g);if(a.cs){var h=this.getTemplate("filterOperator").addClass("operator-cs icon-cs selected").attr("title",
"Case Sensitive").html("case sensitive").tipsy({gravity:"s",offset:9});c.find(".jcsdl-filter-info.operator").append(h);h.tipsy("show")}if("exists"!==a.operator){var m=null,h=(m=0<=d.inArray(a.operator,["geo_box","geo_polygon","geo_radius"]))?a.operator:f.input;m&&(this.getTemplate("filterFieldInput").insertAfter(c.find(".jcsdl-filter-info.field")).find(".jcsdl-filter-field-input").addClass("selected icon-"+a.operator),g.remove());m=this.inputs[h]&&"function"==typeof this.inputs[h].displayValue?this.inputs.exec(h,
"displayValue",[f,a.value,a]):this.getTemplate("filterValue").html(a.value.truncate(50).escapeHtml());c.find(".value").addClass("input-"+h).html(m);c.find(".operator").addClass("input-"+h)}else c.find(".value").remove();c.data("filter",a);c.find(".edit").bind("click touchstart",function(d){d.preventDefault();d.target.blur();b.showFilterEditor(a,b.getFilterIndexByElement(c))});c.find(".delete").bind("click touchstart",function(a){a.preventDefault();a.target.blur();b.deleteFilter(b.getFilterIndexByElement(c))});
return c},createFilterId:function(){var a=[],b=1;for(d.each(this.filters,function(b,d){a.push(parseInt(d.id))});0<=d.inArray(b,a);)b++;return b},highlightFilter:function(a,b){b=b===j?!0:!1;this.$filtersList.find(".filter-"+a)[b?"addClass":"removeClass"]("on")},highlightCSDL:function(a){a=a.split("\n");var b=[];d.each(a,function(a,f){f=d.trim(f);f=f.replace(/"[^"]+"/gi,function(a){return'<span class="jcsdl-code-string">'+a+"</span>"});var e=f.split(" ");if(-1!==d.inArray(e[0].charAt(0),["(",")"])||
-1!==d.inArray(e[0],["AND","OR","NOT"]))return f=f.replace(/AND|OR/gi,function(a){return'<span class="jcsdl-code-logical-operator">'+a+"</span>"}),f=f.replace(/NOT/gi,function(a){return'<span class="jcsdl-code-logical-operator-not">'+a+"</span>"}),f=f.replace(/\(|\)/gi,function(a){return'<span class="jcsdl-code-parenthesis">'+a+"</span>"}),b.push(f),!0;e[0]='<span class="jcsdl-code-target">'+e[0]+"</span>";e[1]='<span class="jcsdl-code-operator">'+e[1]+"</span>";e=e.join(" ");e=e.replace(/[0-9]*\.?[0-9]+/gi,
function(a){return'<span class="jcsdl-code-number">'+a+"</span>"});b.push(e)});return'<code class="jcsdl-code">'+b.join("<br>")+"</code>"},getTemplate:function(a){return JCSDL.GUITemplates[a]!==j?JCSDL.GUITemplates[a].clone():d()},getIconForField:function(a,b){return b.icon!==j?b.icon:a},getFilterIndexByElement:function(a){return this.$filtersList.find(".jcsdl-filter").index(a)}};d.fn.jcsdlGui=function(a){function b(b){var c=b.data("jcsdlGui");c||(c=new JCSDL.GUI(b,a),b.data("jcsdlGui",c));return c}
if("string"==typeof a){if(0<=d.inArray(a,["loadJCSDL","adjust"])){var c=[];d.each(arguments,function(a,b){if(0==a)return!0;c.push(b)});this.each(function(){var f=b(d(this));f[a].apply(f,c)})}return this}this.each(function(){b(d(this))});return this};JCSDLGui=function(a,b){return new JCSDL.GUI(a,b)}});(function(d,j,a){j.jQuery?d.Loader.load():(j=a.getElementsByTagName("head"),a=a.createElement("script"),a.src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js",a.type="text/javascript",j[0].appendChild(a),d.Loader.timeout(!0))})(JCSDL,window,document);
